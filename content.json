{"pages":[{"title":"about","text":"å­¦ç”Ÿç”Ÿæ¶¯æ¯•ä¸šä¸æµ™æ±Ÿå†œæ—å¤§å­¦å·¥ä¸šè®¾è®¡ä¸“ä¸š å·¥ä½œå®ä¹ çš„æ—¶å€™æ˜¯åœ¨ä¸€ä¸ªå®¶å…·å…¬å¸ï¼Œåé¢è§‰å¾—ä¸é€‚åˆåšè®¾è®¡ã€‚é‚è¾èŒåœ¨å®¶è‡ªå­¦å‰ç«¯å››ä¸ªæœˆã€‚ 2017-02-14 ~ 2018-03-30 é‡‘åå¿«æœæ­å·åˆ†å…¬å¸ ä»»èŒå‰ç«¯ç»„é•¿ï¼Œè·å¾—ä¼˜ç§€å‘˜å·¥ 2018-04-02 ~ è‡³ä»Š è·å¾— 2018 å¹´ä¼˜ç§€å‘˜å·¥ã€æœ€ä½³æ•¬ä¸šå¥–ã€2019 å¹´æˆé•¿ä¹‹æ˜Ÿ ç”Ÿæ´»ç”Ÿæ´»å¾ˆå•è°ƒï¼Œæ¯”è¾ƒèŠ‚çº¦ã€‚","link":"/blog/about/index.html"}],"posts":[{"title":"åŸç”Ÿjså®ç°æ‹¾è‰²å™¨æ’ä»¶","text":"å‰è¨€æ’ä»¶åŠŸèƒ½åªæ»¡è¶³æˆ‘å¸ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœå¸Œæœ›æœ‰æ›´å¤šåŠŸèƒ½çš„ï¼Œå¯åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘å°½é‡æ‰©å±•ï¼å¦‚æœä½ æœ‰éœ€è¦æˆ–è€…å–œæ¬¢çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ github æ¥ä¸ª star ? ä»“åº“åœ°å€ åœ¨çº¿é¢„è§ˆ é¢„è§ˆ å‡†å¤‡é¦–å…ˆåœ¨é¡µé¢ä¸­å¼•å…¥ js æ–‡ä»¶ åœ¨é¡µé¢ä¸­å†™ä¸Šå¦‚ä¸‹ä»£ç : 123456789Colorpicker.create({ bindClass:'picker', // è¿™é‡Œçš„pickerå¯éšæ„å¡« ä¸éœ€è¦è·Ÿæˆ‘ä¸€æ · change: function(elem,hex){ // elem: ç»‘å®šçš„å…ƒç´  // hexï¼šå½“å‰é€‰ä¸­é¢œè‰²çš„hexå€¼ elem.style.backgroundColor = hex; }}) bindClass:å‚æ•°å¡«å…¥ä½ è¦ç»‘å®šæ‹¾è‰²å™¨çš„å…ƒç´ ï¼Œé¡µé¢ä¸­ class ä¸º picker æœ‰å‡ ä¸ªï¼Œæ‹¾è‰²å™¨å°†ä¼šç”Ÿæˆå‡ ä¸ªã€‚æ‹¾è‰²å™¨å°†ä¼šåˆ†åˆ«ç»‘å®šæ¯ä¸ªå…ƒç´ ã€‚ç‚¹å‡»æ¯ä¸ªå…ƒç´ æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨æ‰“å¼€è¯¥å…ƒç´ ç»‘å®šçš„æ‹¾è‰²å™¨ã€‚ change:åœ¨é€‰æ‹©çš„è‰²å½©æ”¹å˜çš„æ—¶å€™ä¼šè§¦å‘è¯¥å›è°ƒæ–¹æ³•ã€‚ä¼šå›ä¼ ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªelemå°±æ˜¯è¯¥æ‹¾è‰²å™¨ç”Ÿæˆæ—¶ç»‘å®šçš„picker;ç¬¬äºŒä¸ªå‚æ•°ï¼Œhex ä»£è¡¨æ˜¯å›ä¼ çš„é¢œè‰²å€¼ã€‚èµ·åˆæ˜¯æ’ä»¶ç›´æ¥æ”¹å˜ç»‘å®šå…ƒç´ çš„é¢œè‰²ï¼Œä½†æ˜¯æƒ³åˆ°æœ‰äº›æ‹¾è‰²å™¨æ’ä»¶æ˜¯ç»‘å®š input è¡¨å•ï¼Œæ”¹å˜è¡¨å•é¢œè‰²å€¼ï¼Œæœ‰äº›æ˜¯æ”¹å˜ç»‘å®šå…ƒç´ çš„é¢œè‰²ã€‚æ‰€ä»¥ä¸ºäº†è®©ä½¿ç”¨è€…è‡ªç”±åº¦æ›´é«˜ç‚¹ï¼Œæš‚æä¾›ä¸¤ä¸ªå›è°ƒå‚æ•°è®©ä½ è‡ªå®šä¹‰ã€‚å¦‚ä¸Šé¢ æˆ‘æ˜¯ç›´æ¥æ”¹å˜å…ƒç´ é¢œè‰²ã€‚ å¦‚æœéœ€è¦æ›´å¤šå›è°ƒæ–¹æ³•ï¼Œæˆ‘ä¼šå°½é‡æ‰©å±• ç»“å°¾å¦‚æœ‰ä»€ä¹ˆåŠŸèƒ½éœ€è¦å¢åŠ çš„ï¼Œå¯åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘å°½é‡æ»¡è¶³ã€‚å¦‚æœ‰ä»€ä¹ˆç–å¿½æˆ–é”™è¯¯ï¼Œå¸Œæœ›æ‚¨æŒ‡å‡ºã€‚æˆ‘ä¼šå°½æ—©ä¿®æ”¹ï¼Œä»¥å…è¯¯å¯¼ä»–äººã€‚","link":"/blog/2018/03/11/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E6%8B%BE%E8%89%B2%E5%99%A8%E6%8F%92%E4%BB%B6/"},{"title":"åŸç”Ÿjså®ç°æ—¥æœŸé€‰æ‹©å™¨æ’ä»¶","text":"å‰è¨€è·ç¦»è‡ªå·±ä¸Šæ¬¡å†™æ’ä»¶å·®ä¸å¤šåŠå¹´äº†ã€‚å…¬å¸æŠ€æœ¯æ ˆéƒ½æ˜¯ç”¨æ¡†æ¶ï¼Œè°ƒè§£ä¸‹å£å‘³å°±å†™äº†æ­¤åŸç”Ÿæ’ä»¶ã€‚å‰æ®µæ—¶é—´åœ¨çœ‹ vue æºç å—äº†ç‚¹å¯å‘ï¼Œæœ¬æ’ä»¶æœ‰ç‚¹æ¥è¿‘æ•°æ®é©±åŠ¨è§†å›¾æ›´æ–°çš„å“åº”å¼æ¸²æŸ“ã€‚å¦‚æœå¸Œæœ›æœ‰æ›´å¤šåŠŸèƒ½çš„ï¼Œå¯åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘å°½é‡æ‰©å±•ï¼å¦‚æœä½ æœ‰éœ€è¦æˆ–è€…å–œæ¬¢çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ github æ¥ä¸ª star ğŸ˜† ä»“åº“åœ°å€ åœ¨çº¿é¢„è§ˆ é¢„è§ˆ å‡†å¤‡é¦–å…ˆåœ¨é¡µé¢ä¸­å¼•å…¥ cssã€js æ–‡ä»¶(æ–‡ä»¶åœ¨æˆ‘çš„ githubï¼Œå¦‚ä½•å¼•å…¥å¯çœ‹ github ç¤ºä¾‹ html) åœ¨é¡µé¢ä¸­å†™ä¸Šå¦‚ä¸‹ä»£ç : 12345678910Calendar.create({ classN: 'calendar-item', // è¿™é‡Œçš„calendar-itemå¯éšæ„å¡« ä¸éœ€è¦è·Ÿæˆ‘ä¸€æ · callBack: function(bindElem, dateObj) { // bindElem: è¯¥æ§ä»¶ç»‘å®šçš„å…ƒç´  // dateObj: é€‰ä¸­çš„å¹´ã€æœˆã€æ—¥ å¦‚ï¼š {year: 2018, month: 8, date: 12} // ç”¨æˆ·å¯é€šè¿‡bindElemå’ŒdateObjæäº‹æƒ…å•¦ ğŸ˜† bindElem.innerHTML = dateObj.year + '-' + dateObj.month + '-' + dateObj.date; }}) String: classN:å‚æ•°å¡«å…¥ä½ è¦ç»‘å®šæ—¥æœŸæ§ä»¶çš„å…ƒç´ ã€‚æœ¬æ’ä»¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šæ ¹æ®ç”¨æˆ·æä¾›çš„classNç±»åç”Ÿæˆç›¸åº”ä¸ªæ•° Function: callBack:bindElem: è¯¥æ§ä»¶ç»‘å®šçš„å…ƒç´ ,dateObj: é€‰ä¸­çš„å¹´ã€æœˆã€æ—¥ å¦‚ï¼š {year: 2018, month: 8, date: 12}ã€‚é€šè¿‡è¿”å›å‚æ•°ï¼Œè®©ç”¨æˆ·åœ¨å›è°ƒå‡½æ•°ä¸­é€šè¿‡å›è°ƒå‚æ•°åšæ“ä½œï¼Œç»™ç”¨æˆ·æ›´é«˜çš„è‡ªç”±åº¦ã€‚å¦‚æœéœ€è¦æ›´å¤šå›è°ƒæ–¹æ³•ï¼Œæˆ‘ä¼šå°½é‡æ‰©å±• ç»“å°¾å¦‚æœ‰ä»€ä¹ˆåŠŸèƒ½éœ€è¦å¢åŠ çš„ï¼Œå¯åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘å°½é‡æ»¡è¶³ã€‚å¦‚æœ‰ä»€ä¹ˆç–å¿½æˆ–é”™è¯¯ï¼Œå¸Œæœ›æ‚¨æŒ‡å‡ºã€‚æˆ‘ä¼šå°½æ—©ä¿®æ”¹ï¼Œä»¥å…è¯¯å¯¼ä»–äººã€‚","link":"/blog/2018/08/12/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E6%97%A5%E6%9C%9F%E9%80%89%E6%8B%A9%E5%99%A8%E6%8F%92%E4%BB%B6/"},{"title":"åŸç”Ÿjså®ç°æ‹–æ‹½ç¼©æ”¾é¢„è§ˆå›¾ç‰‡æ’ä»¶","text":"å‰è¨€æ’ä»¶åŠŸèƒ½æš‚åªæ»¡è¶³æˆ‘å¸ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœå¸Œæœ›æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œå¯åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘å°½é‡æ‰©å±•ï¼å¦‚æœä½ æœ‰éœ€è¦æˆ–è€…å–œæ¬¢çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ github æ¥ä¸ª star ? ä»“åº“åœ°å€ &gt; åœ¨çº¿é¢„è§ˆ å‡†å¤‡ å¼•å…¥ preview.js æ–‡ä»¶ æŒ‡å®šä¸€ä¸ªå®¹å™¨çš„ idï¼Œæ’ä»¶åªé¢„è§ˆè¯¥å®¹å™¨å†…çš„å›¾ç‰‡ï¼Œä¸¾ä¸ªæ —å­?ï¼š 1234567&lt;div id=\"wrap\"&gt; &lt;div&gt; &lt;img src=\"./data/girl1.jpg\" alt=\"\" /&gt; &lt;/div&gt; &lt;img src=\"./data/girl2.jpg\" alt=\"\" /&gt; &lt;img src=\"./data/girl3.jpg\" alt=\"\" /&gt;&lt;/div&gt; å…¶ä¸­ id ä¸º wrap çš„ div å°±æ˜¯ 2 ä¸­æ‰€æŒ‡çš„å®¹å™¨ã€‚æ’ä»¶åªé¢„è§ˆè¯¥å®¹å™¨ä¸‹çš„æ‰€æœ‰å›¾ç‰‡ã€‚ 123var preview = new Preview({ imgWrap: 'wrap' // æŒ‡å®šè¯¥å®¹å™¨é‡Œçš„å›¾ç‰‡ç‚¹å‡»é¢„è§ˆ}) imgWrap é”®çš„å€¼å°±æ˜¯å®¹å™¨çš„ id å¦‚æœè§‰å¾—æ ·å¼ä¸æ»¡æ„ä»€ä¹ˆçš„ï¼Œå¯ä»¥ç›´æ¥ css è¦†ç›–å°±å¯ä»¥äº†ã€‚ é¢„è§ˆ æ€»ç»“å¦‚æœ‰ç–å¿½æˆ–é”™è¯¯ï¼Œå¸Œæœ›æ‚¨åŠæ—¶æŒ‡å‡ºï¼Œæˆ‘ä¼šå°½æ—©ä¿®æ”¹?ã€‚æœ‰ä»€ä¹ˆéœ€è¦äº¤æµçš„å¯åœ¨è¯„è®ºåŒºä¸æˆ‘äº¤æµ","link":"/blog/2018/02/13/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E6%8B%96%E6%8B%BD%E7%BC%A9%E6%94%BE%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87%E6%8F%92%E4%BB%B6/"},{"title":"nodejså®ç°formdataä¸Šä¼ æ–‡ä»¶","text":"1.å…³äº formdata XMLHttpRequest Level 2 æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ¥å£â€”â€”FormDataã€‚åˆ©ç”¨ FormData å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ JavaScript ç”¨ä¸€äº›é”®å€¼å¯¹æ¥æ¨¡æ‹Ÿä¸€ç³»åˆ—è¡¨å•æ§ä»¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ XMLHttpRequest çš„ send() æ–¹æ³•æ¥å¼‚æ­¥çš„æäº¤è¡¨å•ã€‚ä¸æ™®é€šçš„ Ajax ç›¸æ¯”ï¼Œä½¿ç”¨ FormData çš„æœ€å¤§ä¼˜ç‚¹å°±æ˜¯æˆ‘ä»¬å¯ä»¥å¼‚æ­¥ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶ã€‚FormData çš„ api æ–¹æ³•ä¸€åˆ›å»ºä¸€ä¸ªç©º FormData å¯¹è±¡ï¼švar formData = new FormData()ä½¿ç”¨ FormData.append æ·»åŠ ä¸€ä¸ªé”®/å€¼å¯¹ï¼šformData.append('username', 'Chris'); æ–¹æ³•äºŒï¼šåˆ©ç”¨ form è¡¨å•ä¼ é€’ç»™ formdata123456789101112131415&lt;form id=\"myForm\" name=\"myForm\"&gt; &lt;div&gt; &lt;label for=\"username\"&gt;Enter name:&lt;/label&gt; &lt;input type=\"text\" id=\"username\" name=\"username\" /&gt; &lt;/div&gt; &lt;div&gt; &lt;label for=\"useracc\"&gt;Enter account number:&lt;/label&gt; &lt;input type=\"text\" id=\"useracc\" name=\"useracc\" /&gt; &lt;/div&gt; &lt;div&gt; &lt;label for=\"userfile\"&gt;Upload file:&lt;/label&gt; &lt;input type=\"file\" id=\"userfile\" name=\"userfile\" /&gt; &lt;/div&gt; &lt;input type=\"submit\" value=\"Submit!\" /&gt;&lt;/form&gt; 12var myForm = document.getElementById('myForm');formData = new FormData(myForm); 2.formdata ä¸Šä¼ æ–‡ä»¶ç›®å½•ç»“æ„1234567.â”œâ”€â”€ index.jsâ”œâ”€â”€ node_modulesâ”œâ”€â”€ package.jsonâ””â”€â”€ public â”œâ”€â”€ index.html â””â”€â”€ uploads å®¢æˆ·ç«¯ä»£ç 1234567891011121314151617181920212223242526&lt;!-- index.html --&gt;&lt;input id=\"file\" type=\"file\" /&gt;&lt;button id=\"btn\"&gt;ç‚¹å‡»ä¸Šä¼ &lt;/button&gt;&lt;img id=\"img\" src=\"\" alt=\"\" /&gt;&lt;script&gt; var btn = document.getElementById('btn'), file = document.getElementById('file'), img = document.getElementById('img'); btn.onclick = function() { // è·å–æ–‡ä»¶ var upload_file = file.files[0], formdata = new FormData(), xhr = new XMLHttpRequest(); formdata.append('date', new Date().toLocaleString()); // å°†æ–‡ä»¶æ·»åŠ åˆ°formdataå¯¹è±¡ä¸­ï¼Œï¼ˆæ³¨ï¼šä¸‹é¢çš„fileå­—æ®µååœ¨nodeä¸­æœ‰ç”¨ï¼‰ formdata.append('file', upload_file); xhr.open('POST', '/upload', true); xhr.onreadystatechange = function() { if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) { img.src = xhr.responseText; } }; xhr.send(formdata); };&lt;/script&gt; æœåŠ¡ç«¯ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839// index.jsvar express = require('express');var app = express();/* 1. ä¿å­˜åœ¨æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ä¸ºäºŒè¿›åˆ¶ï¼Œæ‰€ä»¥æƒ³åœ¨æœ¬åœ°ç‚¹å¼€èƒ½é¢„è§ˆçš„ï¼Œå–æ¶ˆä¸‹é¢fsæ¨¡å—å¼•ç”¨çš„æ³¨é‡Š 2. å¹¶åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ npm install fs --save*/// var fs = require(\"fs\");var multer = require('multer');// è¿™é‡Œdestå¯¹åº”çš„å€¼æ˜¯ä½ è¦å°†ä¸Šä¼ çš„æ–‡ä»¶å­˜çš„æ–‡ä»¶å¤¹var upload = multer({ dest: './public/uploads' });app.use(express.static('./public'));app.post('/upload', upload.single('file'), (req, res) =&gt; { // req.file æ˜¯ 'file' æ–‡ä»¶çš„ä¿¡æ¯ ï¼ˆå‰ç«¯ä¼ é€’çš„æ–‡ä»¶ç±»å‹åœ¨req.fileä¸­è·å–ï¼‰ // req.body å°†å…·æœ‰æ–‡æœ¬åŸŸæ•°æ®ï¼Œå¦‚æœå­˜åœ¨çš„è¯ ã€‚ï¼ˆä¸Šé¢å‰ç«¯ä»£ç ä¸­ä¼ é€’çš„dateå­—æ®µåœ¨req.bodyä¸­è·å–ï¼‰ console.log(req.body); //{ date: '2018/1/20 ä¸‹åˆ5:25:56' } // ---------- å› ä¸ºä¿å­˜çš„æ–‡ä»¶ä¸ºäºŒè¿›åˆ¶ï¼Œå–æ¶ˆä¸‹é¢ä»£ç å—æ³¨é‡Šå¯è®©ä¿å­˜çš„å›¾ç‰‡æ–‡ä»¶åœ¨æœ¬åœ°æ–‡ä»¶å¤¹ä¸­é¢„è§ˆ ------ /* var file_type; if (req.file.mimetype.split('/')[0] == 'image') file_type = '.' + req.file.mimetype.split('/')[1]; if (file_type) { fs.rename(req.file.path, req.file.path + file_type, function (err, doc) { if (err) { console.error(err); return; } console.log('55'); res.send('./uploads/' + req.file.filename + file_type) }) return; } */ // --------------------- res.send('./uploads/' + req.file.filename);});app.listen(9999); æ¥ä¸‹æ¥è§£é‡Šä¸‹ä¸Šè¿°ä»£ç  ä¸Šé¢çš„ä¾‹å­æ˜¯ä¸Šä¼ å›¾ç‰‡ï¼ŒæœåŠ¡ç«¯ä¼ å›å›¾ç‰‡è·¯å¾„è¿›è¡Œå±•ç¤ºã€‚ä¸Šä¼ å…¶ä»–æ–‡ä»¶åŒç†ï¼ index.js ä¸­ä¾èµ– expressã€multer å¯ä»¥é€šè¿‡npm install express multer --saveè¿›è¡Œå®‰è£…ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ expressã€‚æ¥ä¸‹å»é‡ç‚¹è®²è¿°ä¸‹ multerï¼š 1.å®‰è£…ï¼šnpm install --save multer 2.ä½¿ç”¨ï¼šmulter(opts) Multer æ¥å—ä¸€ä¸ª options å¯¹è±¡ï¼Œå…¶ä¸­æœ€åŸºæœ¬çš„æ˜¯ dest å±æ€§ï¼Œè¿™å°†å‘Šè¯‰ Multer å°†ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ¨å“ªã€‚å¦‚æœä½ çœç•¥ options å¯¹è±¡ï¼Œè¿™äº›æ–‡ä»¶å°†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ°¸è¿œä¸ä¼šå†™å…¥ç£ç›˜ã€‚é€šå¸¸ï¼Œåªéœ€è¦è®¾ç½® dest å±æ€§ åƒè¿™æ ·ï¼švar upload = multer({ dest: 'uploads/' }) // destå¯¹åº”çš„å€¼å°±æ˜¯ä½ æƒ³æ–‡ä»¶å­˜å‚¨çš„æ–‡ä»¶å¤¹single(fieldname)æ¥å—ä¸€ä¸ªä»¥ fieldname å‘½åçš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ä¿å­˜åœ¨ req.fileã€‚ï¼ˆè¿™é‡Œçš„ fieldname æŒ‡çš„æ˜¯ formdata.append(â€œfileâ€,æ–‡ä»¶ï¼‰ä¸­çš„â€™fileâ€™å­—æ®µã€‚å…¶ä»–æ–¹æ³•è¯¦è§multer æ–‡æ¡£ã€‚ Multer ä¼šæ·»åŠ ä¸€ä¸ª body å¯¹è±¡ ä»¥åŠ file æˆ– files å¯¹è±¡ åˆ° express çš„ request å¯¹è±¡ä¸­ã€‚body å¯¹è±¡åŒ…å«è¡¨å•çš„æ–‡æœ¬åŸŸä¿¡æ¯ï¼Œfile æˆ– files å¯¹è±¡åŒ…å«å¯¹è±¡è¡¨å•ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯ã€‚ 123456app.post('/upload', upload.single('file'), (req, res) =&gt; { // req.file æ˜¯ 'file' æ–‡ä»¶çš„ä¿¡æ¯ ï¼ˆå‰ç«¯ä¼ é€’çš„æ–‡ä»¶ç±»å‹åœ¨req.fileä¸­è·å–ï¼‰ // req.body å°†å…·æœ‰æ–‡æœ¬åŸŸæ•°æ®ï¼Œå¦‚æœå­˜åœ¨çš„è¯ ã€‚ï¼ˆä¸Šé¢å‰ç«¯ä»£ç ä¸­ä¼ é€’çš„dateå­—æ®µåœ¨req.bodyä¸­è·å–ï¼‰ console.log(req.body); // { date: '2018/1/20 ä¸‹åˆ5:25:56' } res.send('./uploads/' + req.file.filename);}); æ³¨æ„äº‹é¡¹ä¸€ã€formdata åœ¨æ§åˆ¶å°æ‰“å°ä¸ºç©º å¯é€šè¿‡ä¸‹é¢æ–¹æ³•è·å–ï¼š 1234567var formData = new FormData();formData.append('username', 'Chris');formData.append('username', 'Bob');// get()å‡½æ•°åªä¼šè¿”å›usernameé™„åŠ çš„ç¬¬ä¸€ä¸ªå€¼formData.get('username'); // Returns \"Chris\"// getAll()å‡½æ•°å°†è¿”å›usernameä¸€ä¸ªæ•°ç»„ä¸­çš„ä¸¤ä¸ªå€¼ï¼šformData.getAll('username'); // Returns [\"Chris\", \"Bob\"] æ›´å¤š formdata æ–¹æ³• äºŒã€å¦‚æœ formdata æ·»åŠ æ–‡ä»¶æˆåŠŸäº†çš„è¯ï¼Œè¿˜æ˜¯ä¸Šä¼ å¤±è´¥ï¼Œå¯ä»¥çœ‹çœ‹å¤´éƒ¨æ˜¯å¦ä¸ºmultipart/form-data æ–‡ç« éƒ½æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¦‚æœå‘ç°é”™è¯¯ï¼Œæ¬¢è¿ç•™è¨€æŒ‡å‡º","link":"/blog/2018/01/20/node.js%E5%AE%9E%E7%8E%B0formdata%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/"},{"title":"åŸç”Ÿjså®ç°çœå¸‚åŒºä¸‰çº§è”åŠ¨æ’ä»¶","text":"å‰è¨€æ’ä»¶åŠŸèƒ½åªæ»¡è¶³æˆ‘å¸ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœå¸Œæœ›æœ‰æ›´å¤šåŠŸèƒ½çš„ï¼Œå¯åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘å°½é‡æ‰©å±•ï¼å¦‚æœä½ æœ‰éœ€è¦æˆ–è€…å–œæ¬¢çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ github æ¥ä¸ª star ? ä»“åº“åœ°å€ åœ¨çº¿é¢„è§ˆ å‡†å¤‡12// é¡µé¢ä¸Šå…ˆå¼•å…¥cssä¸jsæ–‡ä»¶&lt;div id=\"wrap\"&gt;&lt;/div&gt; é¡µé¢ä¸­çš„å®¹å™¨æ ‡ç­¾ä¸é™åˆ¶ï¼Œåªéœ€ç»™ä¸ª id å°±è¡Œ 12345678910var address = new Address({ wrapId: 'wrap', showArr: ['provinces','citys','areas'], beforeCreat:function(){ console.log(\"beforeCreat\") }, afterCreat:function(){ console.log('afterCreat'); }}) wrapId:&quot;wrap&quot; // æ­¤å¤„çš„wrapå°±æ˜¯ä¸Šé¢å®¹å™¨çš„id showArr: ['provinces','citys','areas'] // æ­¤å¤„åˆ†åˆ«ä»£è¡¨çœã€å¸‚ã€åŒºå®¹å™¨çš„id ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœä¼ é€’çš„æ•°ç»„['provinces','citys','areas']é•¿åº¦ä¸º 3ï¼Œé‚£ä¹ˆå°†ä¼šå‡ºç°çœå¸‚åŒºï¼Œæ•°ç»„ä¸­ä¸‰ä¸ªå­—ç¬¦ä¸²åˆ†åˆ«æ˜¯çœã€å¸‚ã€åŒºå®¹å™¨çš„ id å¦‚ä¼ é€’çš„æ•°ç»„['provinces','citys']é•¿åº¦ä¸º 2ï¼Œé‚£ä¹ˆå°†ä¼šå‡ºç°çœå¸‚ï¼Œæ•°ç»„ä¸­çš„ä¸¤ä¸ªå­—ç¬¦ä¸²åˆ†åˆ«æ˜¯çœã€å¸‚å®¹å™¨çš„ id å¦‚æ•°ç»„é•¿åº¦ä¸º 1 çš„æ—¶å€™å°±ä¸è¯´äº† beforeCreat æ’ä»¶å¼€å§‹åˆ›å»ºå‰æ‰§è¡Œçš„å›è°ƒå‡½æ•° afterCreat æ’ä»¶åˆ›å»ºå®Œæˆåæ‰§è¡Œçš„å›è°ƒå‡½æ•° é¢„è§ˆ æ€»ç»“å¦‚æœ‰ä»€ä¹ˆåŠŸèƒ½éœ€è¦å¢åŠ çš„ï¼Œå¯åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘å°½é‡æ»¡è¶³ã€‚å¦‚æœ‰ä»€ä¹ˆç–å¿½æˆ–é”™è¯¯ï¼Œå¸Œæœ›æ‚¨æŒ‡å‡ºã€‚æˆ‘ä¼šå°½æ—©ä¿®æ”¹ï¼Œä»¥å…è¯¯å¯¼ä»–äººã€‚","link":"/blog/2018/02/12/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E7%9C%81%E5%B8%82%E5%8C%BA%E4%B8%89%E7%BA%A7%E8%81%94%E5%8A%A8%E6%8F%92%E4%BB%B6/"},{"title":"æ€ç»´å¯¼å›¾â€”ä½ ä¸çŸ¥é“çš„JavaScriptä¸­å·","text":"xmind åœ°å€ é¢„è§ˆ","link":"/blog/2018/08/14/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E2%80%94%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript%E4%B8%AD%E5%8D%B7/"},{"title":"å˜é‡å‘½åè§„èŒƒ","text":"å‰è¨€å¥½çš„å‘½åè§„èŒƒå¯ä»¥è®©ä½ ä¸ç”¨å¤©å¤©ä¸ºå–åå­—è€Œè‹¦æ¼ã€æ‰¾ bug æ—¶ï¼Œæ›´å¿«çš„å®šä½åˆ° bug åœ¨å“ªä¸ªä½ç½® ç»„ä»¶çš„å‘½åå’Œå®ƒçš„åŠŸèƒ½ç›¸é…å¥— ä¸ä¸å…¶ä»–ä¸šåŠ¡ç»„ä»¶é‡å,è®©äººä¸€çœ¼å°±åŒºåˆ† ä¸ä¸€å®šè¦å¥½å¬é…·ç‚«,ä½†æ˜¯å®ç”¨.è®©å¼€å‘è€…äº§ç”Ÿæ¡ä»¶åå°„,çœ‹åˆ°å‘½åå°±ä¼šæƒ³åˆ°è¿™ä¸ªç»„ä»¶çš„å®ç”¨åœºæ™¯ æ˜“å†™æ˜“è®°,çŸ­å°å´ç²¾ç‚¼,ä¸ç¹ç BEM.nav æŸä¸€å—å±•ç¤º/åŠŸèƒ½åŒºåŸŸ (div).navitem è¿™å—å±•ç¤º/åŠŸèƒ½åŒºåŸŸï¼ˆdivï¼‰é‡Œé¢çš„æŸä¸ªå…ƒç´ ï¼Œæ¯”å¦‚: navitem.navitemâ€“hide/ .navitemâ€“open æŸä¸ªå…ƒç´ æˆ–è€…æŸä¸ªå—çš„çŠ¶æ€ ä¸è¦åŠ æ•æ„Ÿè¯æ±‡æˆ‘æ›¾ç»ç»™ä¸€ä¸ªå…ƒç´ å–äº†ä¸ª class ä¸º advertisementï¼Œåæ¥æµ‹è¯•äººå‘˜å‘ç°é¡µé¢ä¸Šè¿™å—å…ƒç´ ä¸è§äº†ã€‚åæ¥å‘ç° 360 æµè§ˆå™¨å¼€å¯å»å¹¿å‘Šæ¨¡å¼ï¼Œç›´æ¥æŠŠè¿™ä¸ª div ç»™åˆ äº†ã€‚ å‡½æ•°çš„å‘½åè§„èŒƒ æ‹¼å†™å‡†ç¡® æ¯”å¦‚æˆ‘çš„ confirm ä¸ confrim æŠŠå‡½æ•°æœªæ‰§è¡Œå½’å’äºä»£ç é€»è¾‘é—®é¢˜ ä½¿ç”¨æ­£å¸¸çš„æ—¶æ€ ç‰¹åˆ«æ˜¯ä»£ç ä¸­çŠ¶æ€çš„å˜é‡æˆ–è€…å‡½æ•°çš„å‘½åï¼Œæ¯”å¦‚ onXxxxStarted è¡¨ç¤º xxx å·²ç»å¯åŠ¨äº†ï¼ŒisConnecting è¡¨ç¤ºæ­£åœ¨è¿æ¥ã€‚æ­£ç¡®çš„æ—¶æ€å¯ä»¥ç»™ä½¿ç”¨è€…ä¼ é€’å‡†ç¡®çš„ä¿¡æ¯ã€‚ å‡½æ•°å’Œå±æ€§çš„å‘½åæ˜¯æœ‰åŒºåˆ«çš„ - å¦‚æœæ˜¯å‡½æ•°ï¼Œå»ºè®®ä½¿ç”¨åŠ¨å®¾ç»“æ„åŠ¨å®¾ç»“æ„å°±æ˜¯ doSomethingï¼Œè¿™æ ·çš„å‡½æ•°å‘½åå«ä¹‰æ˜ç¡®æ¯”å¦‚ï¼š openFile, setName, addNumberâ€¦ - å¦‚æœæ˜¯å±æ€§å‘½åï¼Œå»ºè®®ä½¿ç”¨å®šè¯­+åè¯æ¯”å¦‚ fileName, maxLength, textSize ä¸è¦å•è¯+æ‹¼éŸ³æ··åˆä½¿ç”¨æ¯”å¦‚ï¼šuseJiFenï¼ŒhuKouNumber.. ç¼ºä¹ç¾æ„Ÿä¸è¯´ï¼Œå¯è¯»æ€§å¤§å¹…åº¦é™ä½ã€‚ è°¨æ…ä½¿ç”¨ç¼©å†™é™¤éæ˜¯çº¦å®šä¿—æˆå·²ç»è¢«å¹¿æ³›ä½¿ç”¨çš„ç¼©å†™ï¼Œå¦åˆ™è€è€å®å®ç”¨å®Œæ•´æ‹¼å†™ã€‚å…¸å‹çš„åé¢ä¾‹å­: count-&gt;cnt, manager-&gt;mgr password-&gt;pwd button-&gt;btn æ— è®ºæˆ‘ä»¬ä½¿ç”¨ eclipse æˆ–è€… intellij, éƒ½æœ‰å¾ˆå¥½çš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œåå­—é•¿ä¸€ç‚¹æ²¡å…³ç³»çš„ï¼Œå¯è¯»æ€§æ›´é‡è¦ã€‚ å‘½åçš„è¯­ä¹‰è¯ï¼ˆåŠ¨è¯ã€åè¯çš„åŒºåˆ†ï¼‰###Vue ç»„ä»¶å‘½å Ant.design çš„ React ç»„ä»¶æ˜¯ä¸‹é¢è¿™æ ·çš„æ—¶å€™ï¼Œæˆ‘æ„Ÿè§‰åˆ°ä¸€ç§è‡ªç”±çš„å‘³é“ã€‚é¦–å…ˆï¼Œç»„ä»¶åå¯ä»¥ä½¿ç”¨åŸç”Ÿ HTML æ ‡ç­¾åï¼Œæ„å‘³ç€å†ä¹Ÿä¸ç”¨è¾ƒåŠ²è„‘æ±å»è§„é¿åŸç”Ÿ HTML æ ‡ç­¾äº†ã€‚å¦å¤–ï¼Œè¿™äº›ç»„ä»¶éƒ½ä½¿ç”¨äº†é¦–å­—æ¯å¤§å†™æ ‡ç­¾åï¼Œä½¿å®ƒä»¬å¾ˆå®¹æ˜“åœ°ä¸åŸç”Ÿå°å†™çš„ HTML æ ‡ç­¾åŒºåˆ†ã€‚ 12345678910111213ReactDOM.render( &lt;div&gt; &lt;Button type='primary'&gt;Primary&lt;/Button&gt; &lt;Input placeholder='Basic usage' /&gt; &lt;Select defaultValue='.com' style={{ width: 70 }}&gt; &lt;Option value='.com'&gt;.com&lt;/Option&gt; &lt;Option value='.jp'&gt;.jp&lt;/Option&gt; &lt;Option value='.cn'&gt;.cn&lt;/Option&gt; &lt;Option value='.org'&gt;.org&lt;/Option&gt; &lt;/Select&gt; &lt;/div&gt;, mountNode); åŸºç¡€ç»„ä»¶å‘½ååº”ç”¨ç‰¹å®šæ ·å¼å’Œçº¦å®šçš„åŸºç¡€ç»„ä»¶ (ä¹Ÿå°±æ˜¯å±•ç¤ºç±»çš„ã€æ— é€»è¾‘çš„æˆ–æ— çŠ¶æ€çš„ç»„ä»¶) åº”è¯¥å…¨éƒ¨ä»¥ä¸€ä¸ªç‰¹å®šçš„å‰ç¼€å¼€å¤´ï¼Œæ¯”å¦‚ Baseã€App æˆ– Vã€‚ 12345678910**åä¾‹** components/ |- button.vue |- loading.vue |- slide.vue**æ­£ä¾‹** components/ |- BaseButton.vue |- BaseLoading.vue |- BaseSlide.vue å•ä¸ªæ´»è·ƒå®ä¾‹çš„ç»„ä»¶å•ä¸ªæ´»è·ƒå®ä¾‹çš„ç»„ä»¶åº”è¯¥ä»¥ The å‰ç¼€å‘½å,ä»¥ç¤ºå…¶å”¯ä¸€æ€§è¿™ä¸æ„å‘³ç€ç»„ä»¶åªå¯ç”¨äºä¸€ä¸ªå•é¡µé¢ï¼Œè€Œæ˜¯æ¯ä¸ªé¡µé¢åªä½¿ç”¨ä¸€æ¬¡ã€‚è¿™äº›ç»„ä»¶æ°¸è¿œä¸æ¥å—ä»»ä½• propï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸ºä½ çš„åº”ç”¨å®šåˆ¶çš„ï¼Œè€Œä¸æ˜¯å®ƒä»¬åœ¨ä½ çš„åº”ç”¨ä¸­çš„ä¸Šä¸‹æ–‡ã€‚å¦‚æœä½ å‘ç°æœ‰å¿…è¦æ·»åŠ  propï¼Œé‚£å°±è¡¨æ˜è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¯å¤ç”¨çš„ç»„ä»¶ï¼Œåªæ˜¯ç›®å‰åœ¨æ¯ä¸ªé¡µé¢é‡Œåªä½¿ç”¨ä¸€æ¬¡ã€‚ 12345678**åä¾‹** components/ |- SaleManage.vue |- ImportExcel.vue**æ­£ä¾‹** components/ |- TheSaleManage.vue |- TheImportExcel.vue ç´§å¯†è€¦åˆçš„ç»„ä»¶åå’Œçˆ¶ç»„ä»¶ç´§å¯†è€¦åˆçš„å­ç»„ä»¶åº”è¯¥ä»¥çˆ¶ç»„ä»¶çš„å‘½åä¸ºå‰ç¼€.å¦‚æœä¸€ä¸ªç»„ä»¶åªåœ¨å…¶çˆ¶ç»„ä»¶æŸä¸ªåœºæ™¯ä¸‹æœ‰æ„ä¹‰,è¿™å±‚å…³ç³»åº”è¯¥ä½“ç°åœ¨ç»„ä»¶åä¸Š,å› ä¸ºç¼–è¾‘å™¨é€šå¸¸æŒ‰ç…§é¦–å­—æ¯é¡ºåºç»„ç»‡æ–‡ä»¶. 12345678910**åä¾‹** components/ |- SearchBox.vue |- SearchItem.vue |- SearchButton.vue**æ­£ä¾‹** components/ |- SearchBox.vue |- SearchBoxItem.vue |- SearchBoxButton.vue ç»„ä»¶å‘½ä¸­çš„å•è¯é¡ºåºç»„ä»¶ååº”è¯¥ä»¥é«˜çº§åˆ«çš„ (é€šå¸¸æ˜¯ä¸€èˆ¬åŒ–æè¿°çš„) å•è¯å¼€å¤´ï¼Œä»¥æè¿°æ€§çš„ä¿®é¥°è¯ç»“å°¾ã€‚ 12345678910111213141516**åä¾‹** components/ |- ClearSearchButton.vue |- ExcludeFromSearchInput.vue |- LaunchOnStartupCheckbox.vue |- RunSearchButton.vue |- SearchInput.vue |- TermsCheckbox.vue**æ­£ä¾‹** components/ |- SearchButtonClear.vue |- SearchButtonRun.vue |- SearchInputQuery.vue |- SearchInputExcludeGlob.vue |- SettingsCheckboxTerms.vue |- SettingsCheckboxLaunchOnStartup.vue å®Œæ•´å•è¯çš„ç»„ä»¶åç¼–è¾‘å™¨ä¸­çš„è‡ªåŠ¨è¡¥å…¨å·²ç»ç›¸å½“å‹å¥½,è®©ä¹¦å†™é•¿çš„ç»„ä»¶åçš„ä»£ä»·å·²ç»å¯ä»¥å¾®ä¹å…¶å¾®,åŒæ ·çš„æ•ˆç‡æ›´æ˜“äºç†è§£,ä½•ä¹è€Œä¸ä¸º? 12345678**åä¾‹** components/ |- soManage.vue |- woManage.vue**æ­£ä¾‹** components/ |- SaleOrderManage.vue |- WorkOrderManage.vue prop çš„å¤§å°å†™åœ¨å£°æ˜æ—¶å§‹ç»ˆé‡‡ç”¨(camelCase),åœ¨æ¨¡æ¿å’Œ JSX ä¸­åº”è¯¥å§‹ç»ˆä½¿ç”¨( kebab-case)ã€‚å•çº¯çš„éµå¾ªæ¯ä¸ªè¯­è¨€çš„çº¦å®šã€‚åœ¨ JavaScript ä¸­æ›´è‡ªç„¶çš„æ˜¯ camelCaseã€‚è€Œåœ¨ HTML ä¸­åˆ™æ˜¯ kebab-caseã€‚ 12345678910**åä¾‹**props: { 'greeting-text': String}&lt;WelcomeMessage greetingText=\"hi\"/&gt;**æ­£ä¾‹**props: { greetingText: String}&lt;WelcomeMessage greeting-text=\"hi\"/&gt; vue ä¸­å˜é‡å‘½åè§„èŒƒå˜é‡å‘½åä½¿ç”¨ä¸»è¦é›†ä¸­åœ¨ data å’Œ methods ä¸­ data ä¸­æ›´å¤šçš„æ˜¯åè¯ä¸çŠ¶æ€å¸ƒå°”ç±»å‹åè¯ï¼šåè¯å¤ªå¤šï¼Œå¤§è‡´åˆ†ä¸ºå¤æ•°ã€åç¼€åŠ  Arrã€åŠ  Obj ä¹‹ç±»ä½œä¸ºçº¦å®šè§„åˆ™çŠ¶æ€å¸ƒå°”å‹ï¼š 1.è¡¨ç¤ºæ˜¯ä¸æ˜¯ï¼Œç”¨ is+ ï¼šå¦‚ isEmpty è¡¨ç¤ºæœ‰æ²¡æœ‰ï¼Œç”¨ has+â€¦ ï¼š å¦‚ hasClass è¡¨ç¤ºèƒ½ä¸èƒ½ï¼Œç”¨ can+â€¦ ï¼šå¦‚ canSubmit å•è¯æœ¬èº«çš„å½¢å¼ï¼ˆè¿‡å»å¼ã€è¿›è¡Œæ—¶ã€å°†æ¥æ—¶ï¼‰ï¼šhad å¼€å¤´ã€ingã€ed ç»“å°¾ç­‰ methods ä¸­ handle+ä»¥ä¸‹ï¼šdd/removeï¼Œæ·»åŠ /ç§»é™¤add/deleteï¼Œæ·»åŠ /åˆ é™¤insert/deleteï¼Œæ’å…¥/åˆ é™¤start/stopï¼Œå¼€å§‹/åœæ­¢begin/endï¼Œå¼€å§‹/ç»“æŸsend/receiveï¼Œå‘é€/æ¥æ”¶get/setï¼Œå–å‡º/è®¾ç½®get/releaseï¼Œè·å–/é‡Šæ”¾put/getï¼Œæ”¾å…¥/å–å‡ºup/downï¼Œå‘ä¸Š/å‘ä¸‹show/hideï¼Œæ˜¾ç¤º/éšè—open/closeï¼Œæ‰“å¼€/å…³é—­increment/decrementï¼Œå¢åŠ /å‡å°‘lock/unlockï¼Œé”/è§£é”next/previousï¼Œä¸‹ä¸€ä¸ª/å‰ä¸€ä¸ªcreate/destroyï¼Œåˆ›å»º/é”€æ¯min/maxï¼Œæœ€å°/æœ€å¤§visible/invisibleï¼Œå¯è§/ä¸å¯è§pop/pushï¼Œå‡ºæ ˆ/å…¥æ ˆstore/queryï¼Œå­˜å‚¨/æŸ¥è¯¢ ç»“åˆä¸šåŠ¡ï¼šè¡¨å•æäº¤ï¼šsubmitã€sendè¡¨å•å¢åˆ æ”¹æŸ¥ï¼šaddã€deleteã€updateã€searchã€resetä¸Šä¼ é™„ä»¶ï¼šuploadå…³é—­æ‰“å¼€å¼¹çª—ï¼šopen/closeæ£€æŸ¥ï¼šcheck å‚è€ƒé“¾æ¥CSS å‘½åæ–¹å¼=ã€‹BEMå¦‚ä½•å®šä¹‰ä¸€ä¸ªå¥½çš„å˜é‡åç†è§£ CSS å‘½åè§„èŒƒâ€“BEMèŠèŠ Vue ç»„ä»¶å‘½åé‚£äº›äº‹è°ˆè°ˆå‡½æ•°çš„å‘½åè§„èŒƒvue ç»„ä»¶å‘½åæŒ‡å—,ä¸ä¸ºå–åè€Œçº ç»“","link":"/blog/2018/04/26/%E5%8F%98%E9%87%8F%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83/"},{"title":"åŸç”Ÿjså®ç°ç§»åŠ¨ç«¯é€‰æ‹©å™¨æ’ä»¶","text":"å‰è¨€æ’ä»¶åŠŸèƒ½åªæ»¡è¶³æˆ‘å¸ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœå¸Œæœ›æœ‰æ›´å¤šåŠŸèƒ½çš„ï¼Œå¯åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘å°½é‡æ‰©å±•ï¼å¦‚æœä½ æœ‰éœ€è¦æˆ–è€…å–œæ¬¢çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ github æ¥ä¸ª star ? ä»“åº“åœ°å€ åœ¨çº¿é¢„è§ˆ(è®°å¾—å°†æµè§ˆå™¨åˆ‡æ¢åˆ°æ‰‹æœºæ¨¡å¼) é¢„è§ˆ å‡†å¤‡é¦–å…ˆåœ¨é¡µé¢ä¸­å¼•å…¥ css,js æ–‡ä»¶ æ¯æ¬¡éœ€è¦å¼¹å‡ºè¯¥ç»„ä»¶æ—¶é€šè¿‡ new ä¸€ä¸ªå®ä¾‹æ¥ç”Ÿæˆï¼Œä»£ç å¦‚ä¸‹: 123456789101112131415var data = { 1:{ 2:[3,4] }}var pickerView = new PickerView({ bindElem: elem, // ç»‘å®šçš„å…ƒç´ ,ç”¨äºåŒºåˆ«å¤šä¸ªç»„ä»¶å­˜åœ¨æ—¶å›æ˜¾åŒºåˆ«ï¼Œå¦‚æœå•ä¸ªå¯ä»¥éšæ„å¡«æŸä¸ªå…ƒç´  data: data, // è¯´æ˜ï¼šè¯¥å‚æ•°å¿…é¡»ç¬¦åˆjsonæ ¼å¼ ä¸”æœ€é‡Œå±‚æ˜¯ä¸ªæ•°ç»„ï¼Œå¦‚ä¸Šé¢çš„dataå˜é‡æ‰€å±•ç¤ºçš„[3,4]ã€‚ title: 'æ ‡é¢˜2', // é¡¶éƒ¨æ ‡é¢˜æ–‡æœ¬ é»˜è®¤ä¸ºâ€œæ ‡é¢˜â€ leftText: 'å–æ¶ˆ', // å¤´éƒ¨å·¦ä¾§æŒ‰é’®æ–‡æœ¬ é»˜è®¤ä¸ºâ€˜å–æ¶ˆâ€™ rightText: 'ç¡®å®š', // å¤´éƒ¨å³ä¾§æŒ‰é’®æ–‡æœ¬ é»˜è®¤ä¸ºâ€œç¡®å®šâ€ rightFn: function( selectArr ){ // ç‚¹å‡»å¤´éƒ¨å³ä¾§æŒ‰é’®çš„å›è°ƒå‡½æ•°ï¼Œå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å¯¹åº”æ»šè½®ä¸­æ¯é¡¹å¯¹åº”çš„å€¼ }}); å­—æ®µä»‹ç»å¦‚ä¸Šæ³¨é‡Šï¼Œæ»šè½®çš„æ•°é‡å–å†³äºä½  json åµŒå¥—çš„å±‚æ•°ã€‚å¦‚ä¸‹ï¼š 1var data = [1, 2, 3]; 1234var data = { \"å°æ˜å®¶\":[\"å°æ˜çˆ¸çˆ¸\",\"å°æ˜å¦ˆå¦ˆ\",\"å°æ˜çˆ·çˆ·\",\"å°æ˜å¥¶å¥¶\",\"å°æ˜çˆ¸çˆ¸\",\"å°æ˜å¦ˆå¦ˆ\",\"å°æ˜çˆ·çˆ·\",\"å°æ˜å¥¶å¥¶\"], \"å°çº¢å®¶\":[\"å°çº¢çˆ¸çˆ¸\",\"å°çº¢å¦ˆå¦ˆ\"]} æ¡ˆä¾‹123&lt;!-- html --&gt;&lt;button style=\"font-size:50px;\" id=\"btn\"&gt;æŒ‰é’®&lt;/button&gt;&lt;div class=\"showText\"&gt;&lt;/div&gt; button æ ‡ç­¾æ˜¯ç”¨æ¥æ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™æ‰“å¼€ç»„ä»¶ div æ ‡ç­¾ç”¨æ¥å±•ç¤ºé€‰æ‹©çš„å†…å®¹ 1234567891011121314151617181920212223242526272829//js// var data = åœ°çº§å¸‚jsonæ•°æ®ï¼Œè¿‡å¤§ å°±ä¸å±•ç¤ºäº†var data = { \"å°æ˜å®¶\":{ \"å°æ˜çˆ¸çˆ¸\":[1,2,6,7,7,8,8,9,0,6,98,76,5], \"å°æ˜å¦ˆå¦ˆ\":[3,4] }, \"å°çº¢å®¶\":{ \"å°çº¢çˆ¸çˆ¸\":[5,6], \"å°çº¢å¦ˆå¦ˆ\":[7,8] }}var btn = document.getElementById(\"btn\");btn.onclick = function(){ var pickerView = new PickerView({ bindElem: btn, data: data, title: 'å®¶åº­', leftText: 'å–æ¶ˆ', rightText: 'ç¡®å®š', rightFn: function( selectArr ){ console.log(selectArr,'selectarr'); // å°†å®¶åº­æˆå‘˜å±•ç¤ºåˆ°showTextç±»åçš„divä¸­ document.querySelector(\".showText\").innerText = selectArr.join(\"-\"); } });} è¯´æ˜ï¼š æ¯æ¬¡æ˜¾ç¤ºç»„ä»¶çš„æ—¶å€™éƒ½éœ€è¦ new ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚ä¸Š button æ ‡ç­¾æ¯æ¬¡è¢«ç‚¹å‡»çš„æ—¶å€™éƒ½ new ä¸€ä¸ªã€‚æ•ˆæœå¦‚ä¸‹ï¼š ç»“å°¾å¦‚æœ‰ä»€ä¹ˆåŠŸèƒ½éœ€è¦å¢åŠ çš„ï¼Œå¯åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘å°½é‡æ»¡è¶³ã€‚å¦‚æœ‰ä»€ä¹ˆç–å¿½æˆ–é”™è¯¯ï¼Œå¸Œæœ›æ‚¨æŒ‡å‡ºã€‚æˆ‘ä¼šå°½æ—©ä¿®æ”¹ï¼Œä»¥å…è¯¯å¯¼ä»–äººã€‚","link":"/blog/2018/02/25/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%89%E6%8B%A9%E5%99%A8%E6%8F%92%E4%BB%B6/"},{"title":"æ€ç»´å¯¼å›¾â€”æè¿°vueæ‰§è¡Œæœºåˆ¶","text":"xmind åœ°å€ å‚è€ƒï¼ˆæ’åºæŒ‰ç…§çœ‹è¿‡çš„æ—¶é—´é¡ºåºï¼‰å‰–æ Vue.js å†…éƒ¨è¿è¡Œæœºåˆ¶Vue.js æŠ€æœ¯æ­ç§˜Vue æºç é˜…è¯» - æ–‡ä»¶ç»“æ„ä¸è¿è¡Œæœºåˆ¶ã€å¤§å‹å¹²è´§ã€‘æ‰‹æ‹‰æ‰‹å¸¦ä½ è¿‡ä¸€é vue éƒ¨åˆ†æºç å½“é¢è¯•å®˜é—®ä½  Vue å“åº”å¼åŸç†ï¼Œä½ å¯ä»¥è¿™ä¹ˆå›ç­”ä»–Vue æºç å‰–æâ€”â€”renderã€patchã€updataã€vnode(è¿™ç¯‡æŒºä¸é”™çš„)","link":"/blog/2018/08/02/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E2%80%94%E6%8F%8F%E8%BF%B0vue%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/"},{"title":"åŸºäºreactã€socket.ioã€node.jsä»¿å¾®ä¿¡å¼€å‘","text":"å‰è¨€è¿™ä¸ªé¡¹ç›®æ˜¯æˆ‘è‡ªå­¦ react+redux çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶ç»“åˆè‡ªå·±ä¹‹å‰æ‰€å­¦çš„ node+mongodbï¼Œæ¥æ¨¡ä»¿å¼€å‘å¾®ä¿¡å®¢æˆ·ç«¯ã€‚åˆ©ç”¨æ¯å¤©ä¸‹ç­æ—¶é—´è¾¹å­¦ä¹ è¾¹å†™ã€‚ç”±äºæœ¬äººæŠ€æœ¯æ°´å¹³æœ‰é™ï¼Œæ¯”è¾ƒé€‚åˆæ–°æ‰‹ã€‚ç›®å‰è¿˜æ²¡æœ‰å†™å®Œã€‚å–œæ¬¢çš„è¯å¯ä»¥å¸®å¿™ç»™æˆ‘ github ç‚¹ä¸ª star ^_^ é¡¹ç›®åœ°å€https://github.com/zhouatie/wechat æŠ€æœ¯æ ˆreact+redux+react-router4+socket.io+axios+node.js+mongodb è¯´æ˜1234æœ¬åœ°å¯åŠ¨mongodbæœåŠ¡åˆ†åˆ«è¿›å…¥wechatè·Ÿserveræ–‡ä»¶å¤¹npm installwechaté‡Œnpm run startserveré‡Œnode app.js å’Œ chat.js è¿™ä¸¤ä¸ªæ–‡ä»¶ å¼€å‘ç¯å¢ƒï¼šmacbook pro ã€vscodeã€Chromeã€node å¦‚æœ npm install å¤ªæ…¢å¯¼è‡´æœ‰äº› npm ä¾èµ–åŒ…ä¸‹è½½å¤±è´¥ ä½ å¯ä»¥çœ‹æ§åˆ¶å°çš„æŠ¥é”™ä¿¡æ¯ï¼Œå†æ‰‹åŠ¨ npm install å…·ä½“çš„å¼€å‘åŒ…ï¼Œæ¨èä½¿ç”¨æ·˜å®çš„æ³¨å†Œæºï¼Œç›´æ¥è¿è¡Œ npm install -g cnpm --registry=https://registry.npm.taobao.org ç›®æ ‡åŠŸèƒ½ [âˆš] æ³¨å†Œ [âˆš] ç™»å½• [âˆš] æ·»åŠ å¥½å‹ [âˆš] æ”¯æŒç§èŠ [âˆš] æ¶ˆæ¯åˆ—è¡¨çš„å±•ç¤º [âˆš] æœªè¯»æ¶ˆæ¯æ•°é‡çš„æ˜¾ç¤º [âˆš] axios æ•°æ®è·¨åŸŸçš„è®¾ç½® ç¾¤èŠ [âˆš] ä¸Šä¼ å¤´åƒ [âˆš] ä¸ªäººä¿¡æ¯çš„ç¼–è¾‘ æœ‹å‹åœˆ éƒ¨åˆ†æˆªå›¾ æ€»ç»“1.ä¹‹å‰å†™ vue é¡¹ç›®çš„æ—¶å€™ï¼Œåœ¨ main.js æ–‡ä»¶ä¸­å†™ express æ¥å£ï¼Œå°±è¡Œäº†ï¼Œå°±ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚åœ¨ create-react-app å¯åŠ¨çš„é™æ€èµ„æºæœåŠ¡ä¸­ï¼Œå®åœ¨æ‰¾ä¸åˆ°å“ªé‡Œå¯ä»¥å†™æ¥å£ï¼Œæ‰¾äº†å¥½ä¹…çš„ node_modules ï¼Œéƒ½ä¸çŸ¥é“åœ¨å“ªé‡Œä¸‹æ‰‹ã€‚å¥½åœ¨ create-react-app ä¸­çš„ package.json ä¸­åŠ ä¸Šï¼šproxy:http://localhost:4000å°±èƒ½è§£å†³è·¨åŸŸé—®é¢˜äº†ã€‚ 2.åœ¨ app.js é¡µé¢ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ express æ¡†æ¶ï¼Œå†™ socket.io ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæé†’è·¨åŸŸé—®é¢˜ï¼Œè€Œæˆ‘å‰é¢çš„ç™»å½•æ¥å£ç”¨ axios è·¨åŸŸå°±æ²¡æœ‰é—®é¢˜ï¼Œè€Œä¸”æˆ‘åœ¨ express çš„å¤´éƒ¨åšäº† CORS å¤„ç†ï¼Œè¿˜æ˜¯å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚æ‰€ä»¥åªèƒ½å¦å¯äº†ä¸€ä¸ª node æœåŠ¡ï¼Œé‡‡ç”¨åŸç”Ÿ node.js ç¼–å†™ï¼Œè·¨åŸŸå°±æˆåŠŸäº†ã€‚ä½†æ˜¯æˆ‘åœ¨æ–°å†™çš„æœåŠ¡ä¸­ï¼Œæ¢æˆç”¨ express æ¡†æ¶ï¼Œç»“æœä¹Ÿæç¤ºäº†å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚ç›®å‰ä¸ªäººçŒœæµ‹ express å¯èƒ½æœ‰ä»€ä¹ˆè·¨åŸŸæœºåˆ¶ã€‚ 3.åœ¨å¼•å…¥ react-router4 çš„æ—¶å€™é‡åˆ°äº†å¾ˆå¤šç–‘éš¾æ‚ç—‡ï¼Œæ™šä¸Šå¤§éƒ¨åˆ†çš„ react-router4 ä¸€ä¸‹çš„ç‰ˆæœ¬ã€‚æŒ‰ç…§ç½‘ä¸Šæ¥åšï¼Œå¥½å¤šæŠ¥é”™ï¼Œåˆ°å¤„æ‰¾åšå®¢æ‰¾æ–‡ç« ã€‚åæ¥é€šè¿‡ react-router è‹±æ–‡æ–‡æ¡£çš„é˜…è¯»è§£å†³äº†å„ç§æŠ¥é”™é—®é¢˜ã€‚ 4.æˆ‘æ˜¯é€šè¿‡ redux æ¥æ›´æ–°æ¶ˆæ¯åˆ—è¡¨ï¼Œä¸­é—´å‡ºç° store æ•°æ®æ›´æ–°äº†ï¼Œç»„ä»¶å´ä¸æ¸²æŸ“ã€‚åæ¥æ±‚åŠ©å¥½å‹åï¼ŒåŸæ¥æ˜¯æˆ‘å¼ºåˆ¶ä¿®æ”¹äº† state å¯¼è‡´é¡µé¢æ— æ³•å³ä½¿åˆ·æ–°ã€‚ 5.formdata ä¸Šä¼ æ–‡ä»¶ï¼Œç›¸å½“äºè¡¨å•ä¸Šä¼ ï¼Œå¤´éƒ¨ä¸ºContent-Type:multipart/form-data,è¿™ç‚¹è¦æ³¨æ„äº†ï¼ æ³¨æ„: Multer ä¸ä¼šå¤„ç†ä»»ä½•é multipart/form-data ç±»å‹çš„è¡¨å•æ•°æ®ã€‚å…·ä½“è§ multer 12345678910111213141516var multer = require('multer');var upload = multer({ dest: '../wechat/public/logos' }); // dest æŒ‡çš„æ˜¯å›¾ç‰‡å­˜åˆ°å“ªä¸ªæ–‡ä»¶å¤¹é‡Œ// ä¸Šä¼ å¤´åƒapp.post('/uploadLogo', upload.single('avatar'), (req, res) =&gt; { User.update( { _id: req.body.id }, { $set: { logo: './logos/' + req.file.filename } }, function() { res.send({ status: 'success', url: './logos/' + req.file.filename }); } );}); å‚è€ƒèµ„æ–™ã€Šæ·±å…¥æµ…å‡º React å’Œ Reduxã€‹â€“ ç¨‹å¢¨ ã€ŠMongoDB å®æˆ˜ï¼ˆç¬¬äºŒç‰ˆï¼‰ã€‹ react-router react redux ä¸­æ–‡æ–‡æ¡£ mongoose åŸºäº Vueã€Nodejsã€Socket.io çš„èŠå¤©åº”ç”¨ multer æ–‡ç« éƒ½æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¦‚æœå‘ç°é”™è¯¯ï¼Œæ¬¢è¿ç•™è¨€æŒ‡å‡º","link":"/blog/2018/01/21/%E5%9F%BA%E4%BA%8Ereact%E3%80%81socket-io%E3%80%81node-js%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"},{"title":"æµè§ˆå™¨httpç¼“å­˜","text":"æµè§ˆå™¨ http ç¼“å­˜å¤§è‡´æµç¨‹å›¾ ç¼“å­˜å¥½å¤„ ç¼“è§£æœåŠ¡å™¨å‹åŠ›(ä¸ç”¨æ¯æ¬¡å»è¯·æ±‚èµ„æº)ï¼› æå‡æ€§èƒ½(æ‰“å¼€æœ¬åœ°èµ„æºé€Ÿåº¦å½“ç„¶æ¯”è¯·æ±‚å›æ¥å†æ‰“å¼€è¦å¿«å¾—å¤š)ï¼› å‡å°‘å¸¦å®½æ¶ˆè€—(æˆ‘ç›¸ä¿¡ä½ å¯ä»¥ç†è§£)ï¼› ç¼“å­˜ç§ç±» æµè§ˆå™¨ç¼“å­˜ æµè§ˆå™¨å¯¹äºç¼“å­˜çš„å¤„ç†æ˜¯æ ¹æ®ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶è¿”å›çš„å“åº”å¤´æ¥ç¡®å®šçš„ã€‚ ä»£ç†æœåŠ¡å™¨ç¼“å­˜ ç½‘å…³ç¼“å­˜ æ•°æ®åº“ç¼“å­˜ é€šç”¨é¦–éƒ¨å­—æ®µcache-controlç¼“å­˜è¯·æ±‚æŒ‡ä»¤ æŒ‡ä»¤ å‚æ•° è¯´æ˜ no-cahce æ—  å¼ºåˆ¶å‘æºæœåŠ¡å™¨å†æ¬¡éªŒè¯ no-store æ—  ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹ max-age = [ç§’] å¿…éœ€ æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…çš„å“åº”ä»æœ‰æ•ˆ max-state( = [ç§’]) å¯çœç•¥ æ¥æ”¶å·²è¿‡æœŸçš„å“åº” min-fresh = [ç§’] å¿…éœ€ æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…å‘å“åº”ä»æœ‰æ•ˆ no-transform æ—  ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»å‹ only-if-cached æ—  ä»ç¼“å­˜è·å–èµ„æº cache-extension - æ–°æŒ‡ä»¤æ ‡è®°[token] ##### ç¼“å­˜å“åº”æŒ‡ä»¤ æŒ‡ä»¤ å‚æ•° è¯´æ˜ public æ—  å¯å‘ä»»æ„æ–¹æä¾›å“åº”çš„ç¼“å­˜ private å¯çœç•¥ ä»…å‘ç‰¹å®šç”¨æˆ·è¿”å›å“åº” no-cahce å¯çœç•¥ ç¼“å­˜å‰å¿…éœ€å…ˆç¡®è®¤å…¶æœ‰æ•ˆæ€§ no-store æ—  ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹ no-transform æ—  ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»å‹ must-revalidate æ—  å¯ç¼“å­˜ä½†å¿…é¡»å†æƒ³æºæœåŠ¡å™¨è¿›è¡Œç¡®è®¤ proxy-revalidate æ—  è¦æ±‚ä¸­é—´ç¼“å­˜æœåŠ¡å™¨å¯¹ç¼“å­˜çš„å“åº”æœ‰æ•ˆæ€§å†è¿›è¡Œç¡®è®¤ max-age = [ç§’] å¿…éœ€ å“åº”çš„æœ€å¤§Ageå€¼ s-maxage = [ç§’] å¿…éœ€ å…¬å…±ç¼“å­˜æœåŠ¡å™¨å“åº”çš„æœ€å¤§Ageå€¼ cache-extension - æ–°æŒ‡ä»¤æ ‡è®°[token] è¡¨ç¤ºæ˜¯å¦èƒ½ç¼“å­˜çš„æŒ‡ä»¤public æŒ‡ä»¤ Cache-Control: public å½“ä½¿ç”¨ public æŒ‡ä»¤æ—¶ï¼Œåˆ™æ˜ç¡®è¡¨æ˜å…¶ä»–ç”¨æˆ·ä¹Ÿå¯åˆ©ç”¨ç¼“å­˜ã€‚private æŒ‡ä»¤ Cache-Control: private å½“ä½¿ç”¨ private æŒ‡ä»¤æ—¶ï¼Œå“åº”åªä»¥ç‰¹å®šçš„ç”¨æˆ·ä½œä¸ºå¯¹è±¡ï¼Œè¿™ä¸ public æŒ‡å®šçš„è¡Œä¸ºç›¸åã€‚ ç¼“å­˜æœåŠ¡å™¨ä¼šå¯¹è¯¥ç‰¹å®šç”¨æˆ·æä¾›èµ„æºç¼“å­˜çš„æœåŠ¡ï¼Œå¯¹äºå…¶ä»–ç”¨æˆ·å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œä»£ç†æœåŠ¡å™¨åˆ™ä¸ä¼šè¿”å›ç¼“å­˜ no-cache æŒ‡ä»¤ Cache-Control: no-cache ä½¿ç”¨ no-cache æŒ‡ä»¤çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ä»ç¼“å­˜ä¸­è¿”å›è¿‡æœŸçš„èµ„æºã€‚ å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¦‚æœåŒ…å« no-cache æŒ‡ä»¤ï¼Œåˆ™è¡¨ç¤ºå®¢æˆ·ç«¯å°†ä¸ä¼šç¼“å­˜è¿‡çš„å“åº”ã€‚äºæ˜¯ï¼Œâ€œä¸­é—´â€çš„ç¼“å­˜æœåŠ¡å™¨å¿…é¡»æŠŠå®¢æˆ·ç«¯è¯·æ±‚è½¬å‘ç»™æºæœåŠ¡å™¨ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›çš„å“åº”ä¸­åŒ…å« no-cache æŒ‡ä»¤ï¼Œé‚£ä¹ˆç¼“å­˜æœåŠ¡å™¨ä¸èƒ½å¯¹èµ„æºè¿›è¡Œç¼“å­˜ã€‚æºæœåŠ¡å™¨ä»¥åä¹Ÿå°†ä¸å†å¯¹ç¼“å­˜æœåŠ¡å™¨è¯·æ±‚ä¸­æå‡ºçš„èµ„æºæœ‰æ•ˆæ€§è¿›è¡Œç¡®è®¤ï¼Œä¸”ç¦æ­¢å…¶å¯¹å“åº”èµ„æºè¿›è¡Œç¼“å­˜æ“ä½œã€‚ no-store æŒ‡ä»¤ Cache-Control: no-store å½“ä½¿ç”¨ no-store æŒ‡ä»¤æ—¶ï¼Œæš—ç¤ºè¯·æ±‚ï¼ˆå’Œå¯¹åº”çš„å“åº”ï¼‰æˆ–å“åº”ä¸­åŒ…å«æœºå¯†ä¿¡æ¯ã€‚å› æ­¤ï¼Œè¯¥æŒ‡ä»¤è§„å®šç¼“å­˜ä¸èƒ½å†æœ¬åœ°å­˜å‚¨è¯·æ±‚æˆ–å“åº”çš„ä»»ä¸€éƒ¨åˆ†ã€‚ s-maxage æŒ‡ä»¤ Cache-Control: s-maxage=604800 (å•ä½ ï¼šç§’) s-maxage æŒ‡ä»¤çš„åŠŸèƒ½å’Œ max-age æŒ‡ä»¤çš„ç›¸åŒï¼Œä»–ä»¬çš„ä¸åŒç‚¹æ˜¯ s-maxage æŒ‡ä»¤é€‚ç”¨äºä¾›å¤šä½ç”¨æˆ·ä½¿ç”¨çš„å…¬å…±ç¼“å­˜æœåŠ¡å™¨ã€‚ max-age æŒ‡ä»¤ Cache-Control: max-age = 604800 (å•ä½ ï¼šç§’) å½“å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­åŒ…å« max-age æŒ‡ä»¤æ—¶ï¼Œå¦‚æœåˆ¤å®šç¼“å­˜èµ„æºçš„ç¼“å­˜æ—¶é—´æ•°å€¼æ¯”æŒ‡å®šæ—¶é—´çš„æ•°å€¼æ›´å°ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±æ¥æ”¶ç¼“å­˜çš„èµ„æºã€‚å¦å¤–ï¼Œå½“æŒ‡å®š max-age å€¼ä¸º 0ï¼Œé‚£ä¹ˆç¼“å­˜æœåŠ¡å™¨é€šå¸¸éœ€è¦å°†è¯·æ±‚è½¬å‘ç»™æºæœåŠ¡å™¨ã€‚å½“æœåŠ¡å™¨è¿”å›çš„å“åº”ä¸­åŒ…å« max-age æŒ‡ä»¤æ—¶ï¼Œç¼“å­˜æœåŠ¡å™¨å°†ä¸å¯¹èµ„æºçš„æœ‰æ•ˆæ€§å†ä½œç¡®è®¤ï¼Œè€Œ max-age æ•°å€¼ä»£è¡¨èµ„æºä¿å­˜ä¸ºç¼“å­˜çš„æœ€é•¿æ—¶é—´ã€‚åº”ç”¨ HTTP/1.1 ç‰ˆæœ¬çš„ç¼“å­˜æœåŠ¡å™¨é‡åˆ°åŒæ—¶å­˜åœ¨ Expires é¦–éƒ¨å­—æ®µçš„æƒ…å†µæ—¶ï¼Œä¼šä¼˜å…ˆå¤„ç† max-age æŒ‡ä»¤ï¼Œè€Œå¿½ç•¥æ‰ Expires é¦–éƒ¨å­—æ®µã€‚è€Œ HTTP/1.0 ç‰ˆæœ¬çš„ç¼“å­˜æœåŠ¡å™¨çš„æƒ…å†µå´ç›¸åï¼Œmax-age æŒ‡ä»¤ä¼šè¢«å¿½ç•¥æ‰ã€‚ min-fresh æŒ‡ä»¤ Cache-Control: min-fresh=60(å•ä½ï¼šç§’) min-fresh æŒ‡ä»¤è¦æ±‚ç¼“å­˜æœåŠ¡å™¨è¿”å›è‡³å°‘è¿˜æœªè¿‡æŒ‡å®šæ—¶é—´çš„ç¼“å­˜èµ„æºã€‚æ¯”å¦‚ï¼Œå½“æŒ‡å®š min-fresh ä¸º 60 ç§’åï¼Œåœ¨è¿™ 60 ç§’ä»¥å†…å¦‚æœæœ‰è¶…è¿‡æœ‰æ•ˆæœŸé™çš„èµ„æºéƒ½æ— æ³•ä½œä¸ºå“åº”è¿”å›äº†ã€‚ max-stale æŒ‡ä»¤ Cache-Control:max-stale=3600(å•ä½ï¼šç§’ï¼‰ ä½¿ç”¨ max-stale å¯æŒ‡ç¤ºç¼“å­˜èµ„æºï¼Œå³ä½¿è¿‡æœŸä¹Ÿç…§å¸¸æ¥æ”¶ã€‚ å¦‚æœæŒ‡ä»¤æœªæŒ‡å®šå‚æ•°å€¼ï¼Œé‚£ä¹ˆæ— è®ºç»è¿‡å¤šä¹…ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šæ¥æ”¶å“åº”ï¼›å¦‚æœæŒ‡ä»¤ä¸­æŒ‡å®šäº†å…·ä½“æ•°å€¼ï¼Œé‚£ä¹ˆå³ä½¿è¿‡æœŸï¼Œåªè¦æ‰”å¤„äº max-stale æŒ‡å®šçš„æ—¶é—´å†…ï¼Œä»æ—§ä¼šè¢«å®¢æˆ·ç«¯æ¥æ”¶ã€‚ only-if-cached æŒ‡ä»¤ Cache-Control: only-if-cached ä½¿ç”¨ only-if-cached æŒ‡ä»¤è¡¨ç¤ºå®¢æˆ·ç«¯ä»…åœ¨ç¼“å­˜æœåŠ¡å™¨æœ¬åœ°ç¼“å­˜ç›®æ ‡èµ„æºçš„æƒ…å†µä¸‹æ‰ä¼šè¦æ±‚å…¶è¿”å›ã€‚æ¢è¨€ä¹‹ï¼Œè¯¥æŒ‡ä»¤è¦æ±‚ç¼“å­˜æœåŠ¡å™¨ä¸é‡æ–°åŠ è½½å“åº”ï¼Œä¹Ÿä¸ä¼šå†æ¬¡ç¡®è®¤èµ„æºæœ‰æ•ˆæ€§ã€‚è‹¥å‘ç”Ÿè¯·æ±‚ç¼“å­˜æœåŠ¡å™¨çš„æœ¬åœ°ç¼“å­˜æ— å“åº”ï¼Œåˆ™è¿”å›çŠ¶æ€ç  504 Gateway Timeoutã€‚ must-revalidate æŒ‡ä»¤ Cache-Control: must-revalidate ä½¿ç”¨ must-revalidate æŒ‡ä»¤ï¼Œä»£ç†ä¼šå‘æºæœåŠ¡å™¨å†æ¬¡éªŒè¯å³å°†è¿”å›çš„å“åº”ç¼“å­˜ç›®å‰æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚ è‹¥ä»£ç†æ— æ³•è¿é€šæºæœåŠ¡å™¨å†æ¬¡è·å–æœ‰æ•ˆèµ„æºçš„è¯ï¼Œç¼“å­˜å¿…é¡»ç»™å®¢æˆ·ç«¯ä¸€æ¡ 504ï¼ˆGateway Timeoutï¼‰çŠ¶æ€ç ã€‚ å¦å¤–ï¼Œä½¿ç”¨ must-revalidate æŒ‡ä»¤ä¼šå¿½ç•¥è¯·æ±‚çš„ max-stale æŒ‡ä»¤ï¼ˆå³ä½¿å·²ç»åœ¨é¦–éƒ¨ä½¿ç”¨äº† max-stale,ä¹Ÿä¸ä¼šå†æœ‰æ•ˆæœï¼‰ã€‚ proxy-revalidate æŒ‡ä»¤ Cache-Control: proxy-revalidate proxy-revalidate æŒ‡ä»¤è¦æ±‚æ‰€æœ‰çš„ç¼“å­˜æœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯å¸¦æœ‰è¯¥æŒ‡ä»¤çš„è¯·æ±‚è¿”å›å“åº”ä¹‹å‰ï¼Œå¿…é¡»å†æ¬¡éªŒè¯ç¼“å­˜çš„æœ‰æ•ˆæ€§ã€‚ no-transform æŒ‡ä»¤ Cache-Control: no-transform ä½¿ç”¨ no-transform æŒ‡ä»¤è§„å®šæ— è®ºæ˜¯åœ¨è¯·æ±‚è¿˜æ˜¯å“åº”ä¸­ï¼Œç¼“å­˜éƒ½ä¸èƒ½æ”¹å˜å®ä½“ä¸»ä½“çš„åª’ä½“ç±»å‹ã€‚ Cache-Control æ‰©å±• cache-extension token Cache-Control: private, community=&quot;UCI&quot; é€šè¿‡ cache-extension æ ‡è®°ï¼ˆtokenï¼‰ï¼Œå¯ä»¥æ‰©å±• Cache-Control é¦–éƒ¨å­—æ®µå†…çš„æŒ‡ä»¤ã€‚ å¦‚ä¸Šä¾‹ï¼ŒCache-Control é¦–éƒ¨å­—æ®µæœ¬èº«æ²¡æœ‰ community è¿™ä¸ªæŒ‡ä»¤ã€‚å€ŸåŠ© extension tokens å®ç°äº†è¯¥æŒ‡ä»¤çš„æ·»åŠ ã€‚å¦‚æœç¼“å­˜æœåŠ¡å™¨ä¸èƒ½ç†è§£ community è¿™ä¸ªæ–°æŒ‡ä»¤ï¼Œå°±ä¼šç›´æ¥å¿½ç•¥ã€‚å› æ­¤ï¼Œextension tokens ä»…å¯¹èƒ½ç†è§£å®ƒçš„ç¼“å­˜æœåŠ¡å™¨æ¥è¯´æ˜¯æœ‰æ„ä¹‰çš„ã€‚ Dateé¦–éƒ¨å­—æ®µ Date è¡¨æ˜åˆ›å»º HTTP æŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´ã€‚\bHTTP/1.1 åè®®ä½¿ç”¨åœ¨ RFC1123 ä¸­è§„å®šçš„æ—¥æœŸæ—¶é—´çš„æ ¼å¼ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚Date: Tue, 03 Jul 2012 04:40:59 GMTä¹‹å‰çš„ HTTP åè®®ç‰ˆæœ¬ä¸­ä½¿ç”¨åœ¨ RFC850 ä¸­å®šä¹‰çš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚Date: Tue, 03-Jul-12 04:40:59 GMTé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ ¼å¼ã€‚å®ƒä¸ C æ ‡å‡†åº“å†…çš„ asctime()å‡½æ•°çš„è¾“å‡ºæ ¼å¼ä¸€è‡´ã€‚Date: Tue Jul 03 04:40:59 2012 PragmaPragma æ˜¯ HTTP/1.1 ä¹‹å‰ç‰ˆæœ¬çš„å†å²é—ç•™å­—æ®µï¼Œä»…ä½œä¸ºä¸ HTTP/1.0 çš„å‘åå…¼å®¹è€Œå®šä¹‰ã€‚ \bPragma: no-cache è¯¥é¦–éƒ¨å­—æ®µå±äºé€šç”¨é¦–éƒ¨å­—æ®µï¼Œä½†åªç”¨åœ¨å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­ã€‚å®¢æˆ·ç«¯ä¼šè¦æ±‚æ‰€æœ‰çš„ä¸­é—´æœåŠ¡å™¨ä¸è¿”å›ç¼“å­˜çš„èµ„æºã€‚ æ‰€æœ‰çš„ä¸­é—´æœåŠ¡å™¨å¦‚æœéƒ½èƒ½ä»¥ HTTP/1.1 ä¸ºåŸºå‡†ï¼Œé‚£ç›´æ¥é‡‡ç”¨ Cache-Control: no-cache æŒ‡å®šç¼“å­˜çš„å¤„ç†æ–¹å¼æ˜¯æœ€ä¸ºç†æƒ³çš„ã€‚ä½†è¦æ•´ä½“æŒæ¡å…¨éƒ¨ä¸­é—´æœåŠ¡å™¨ä½¿ç”¨çš„ HTTP åè®®ç‰ˆæœ¬ä¸­å´æ˜¯ä¸ç°å®çš„ã€‚å› æ­¤ï¼Œå‘é€çš„è¯·æ±‚ä¼šåŒæ—¶å«æœ‰ä¸‹é¢ä¸¤ä¸ªé¦–éƒ¨å­—æ®µã€‚ 12Cache-Control: no-cachePragma: no-cache è¯·æ±‚é¦–éƒ¨å­—æ®µIf-Match/If-Modified-Since/If-None-Match/If-Range/If-Unmodified-Since å½¢å¦‚ If-xxx è¿™ç§å½¢å¼çš„è¯·æ±‚é¦–éƒ¨å­—æ®µï¼Œéƒ½å¯ç§°ä¸ºæ¡ä»¶è¯·æ±‚ã€‚æœåŠ¡å™¨æ¥æ”¶åˆ°é™„å¸¦æ¡ä»¶çš„è¯·æ±‚åï¼Œåªæœ‰åˆ¤æ–­æŒ‡å®šæ¡ä»¶ä¸ºçœŸæ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè¯·æ±‚ã€‚ If-Match åªæœ‰å½“ If-Match çš„å€¼ä¸æœåŠ¡å™¨ä¸Šå®ä½“çš„ Etag å€¼ \b ä¸€è‡´æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šæ¥å—è¯·æ±‚ã€‚åä¹‹ï¼Œåˆ™è¿”å›çŠ¶æ€ç  412 \bPrecondition Failed çš„å“åº”ã€‚ \bIf-Modified-Since å¦‚æœåœ¨ If-Modified-Since å­—æ®µæŒ‡å®šçš„æ—¥æœŸæ—¶é—´åï¼Œèµ„æºå‘ç”Ÿäº†æ›´æ–°ï¼ŒæœåŠ¡å™¨ä¼šæ¥å—è¯·æ±‚ã€‚æ¯”å¦‚è¯·æ±‚é¦–éƒ¨If-Modified-Since: Thu, 15 Apr 2004 00:00:00 GMT,è€ŒæœåŠ¡å™¨ä¸Šçš„Last-Modified: Sun 29 Aug 2004 14:03:05 GMTï¼Œå› ä¸ºæ˜¯åœ¨ 2004 å¹´ 4 æœˆ 15 æ—¥ä¹‹åæ›´æ–°è¿‡çš„èµ„æºï¼Œæ‰€ä»¥æœåŠ¡å™¨ä¼šæ¥å—è¯·æ±‚ã€‚ If-None-Match åªæœ‰åœ¨ If-None-Match çš„å­—æ®µå€¼ä¸ Etag å€¼ä¸ä¸€è‡´æ—¶ï¼Œå¯å¤„ç†è¯¥è¯·æ±‚ã€‚ä¸ If-Match é¦–éƒ¨å­—æ®µçš„ä½œç”¨ç›¸åã€‚ \bIf-Range If-Range HTTP è¯·æ±‚å¤´å­—æ®µç”¨æ¥ä½¿å¾— Range å¤´å­—æ®µåœ¨ä¸€å®šæ¡ä»¶ä¸‹èµ·ä½œç”¨ï¼šå½“å­—æ®µå€¼ä¸­çš„æ¡ä»¶å¾—åˆ°æ»¡è¶³æ—¶ï¼ŒRange å¤´å­—æ®µæ‰ä¼šèµ·ä½œç”¨ï¼ŒåŒæ—¶æœåŠ¡å™¨å›å¤ 206 éƒ¨åˆ†å†…å®¹çŠ¶æ€ç ï¼Œä»¥åŠ Range å¤´å­—æ®µè¯·æ±‚çš„ç›¸åº”éƒ¨åˆ†ï¼›å¦‚æœå­—æ®µå€¼ä¸­çš„æ¡ä»¶æ²¡æœ‰å¾—åˆ°æ»¡è¶³ï¼ŒæœåŠ¡å™¨å°†ä¼šè¿”å› 200 OK çŠ¶æ€ç ï¼Œå¹¶è¿”å›å®Œæ•´çš„è¯·æ±‚èµ„æºã€‚ If-Unmodified-Since é¦–éƒ¨å­—æ®µIf-Unmodified-Sinceå’Œé¦–éƒ¨å­—æ®µIf-Modified-Sinceçš„ä½œç”¨ç›¸åã€‚ä»–çš„ä½œç”¨æ˜¯å‘ŠçŸ¥æœåŠ¡å™¨ï¼ŒæŒ‡å®šçš„è¯·æ±‚èµ„æºåªæœ‰åœ¨å­—æ®µå€¼å†…æŒ‡å®šçš„æ—¥æœŸæ—¶é—´ä¹‹åï¼Œæœªå‘ç”Ÿæ›´æ–°çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤„ç†è¯·æ±‚ã€‚å¦‚æœåœ¨æŒ‡å®šçš„æ—¥æœŸæ—¶é—´åå‘ç”Ÿäº†æ›´æ–°ï¼Œåˆ™ä»¥çŠ¶æ€ç  412 \bPrecondition Faied ä½œä¸ºç›¸åº”è¿”å›ã€‚ å“åº”é¦–éƒ¨å­—æ®µå“åº”é¦–éƒ¨å­—æ®µæ˜¯ç”±æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¿”å›å“åº”æŠ¥æ–‡ä¸­æ‰€ä½¿ç”¨çš„å­—æ®µï¼Œç”¨äºè¡¥å……å“åº”çš„é™„åŠ ä¿¡æ¯ã€æœåŠ¡å™¨ä¿¡æ¯ã€ä»¥åŠå¯¹å®¢æˆ·ç«¯çš„é™„åŠ è¦æ±‚ç­‰ä¿¡æ¯ã€‚ Age é¦–éƒ¨å­—æ®µ Age èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯ï¼ŒæºæœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº”ã€‚å­—æ®µå€¼çš„å•ä½ä¸ºç§’ã€‚ è‹¥åˆ›å»ºè¯¥å“åº”çš„æœåŠ¡å™¨æ˜¯ç¼“å­˜æœåŠ¡å™¨ï¼ŒAge å€¼æ˜¯æŒ‡ç¼“å­˜åçš„å“åº”å†æ¬¡å‘èµ·è®¤è¯åˆ°è®¤è¯å®Œæˆçš„æ—¶é—´å€¼ã€‚ä»£ç†åˆ›å»ºå“åº”æ—¶å¿…é¡»åŠ ä¸Šé¦–éƒ¨å­—æ®µ Ageã€‚Age æ¶ˆæ¯å¤´çš„å€¼é€šå¸¸æ¥è¿‘äº 0ã€‚è¡¨ç¤ºæ­¤æ¶ˆæ¯å¯¹è±¡åˆšåˆšä»åŸå§‹æœåŠ¡å™¨è·å–ä¸ä¹…ï¼›å…¶ä»–çš„å€¼åˆ™æ˜¯è¡¨ç¤ºä»£ç†æœåŠ¡å™¨å½“å‰çš„ç³»ç»Ÿæ—¶é—´ä¸æ­¤åº”ç­”æ¶ˆæ¯ä¸­çš„é€šç”¨æ¶ˆæ¯å¤´ Date çš„å€¼ä¹‹å·®ã€‚ Etag é¦–éƒ¨å­—æ®µ Etag èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯å®ä½“æ ‡è¯†ã€‚å®ƒæ˜¯ä¸€ç§å¯å°†èµ„æºä»¥å­—ç¬¦ä¸²å½¢å¼åšå”¯ä¸€æ€§æ ‡è¯†çš„æ–¹å¼ã€‚æœåŠ¡å™¨ä¼šä¸ºæ¯ä»½èµ„æºåˆ†é…å¯¹åº”çš„ Etag å€¼ã€‚ å¦å¤–ï¼Œå½“èµ„æºæ›´æ–°æ—¶ï¼ŒEtag å€¼ä¹Ÿéœ€è¦æ›´æ–°ã€‚ç”Ÿæˆ Etag å€¼æ—¶ï¼Œå¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç®—æ³•è§„åˆ™ï¼Œè€Œä»…ä»…æ˜¯ç”±æœåŠ¡å™¨æ¥åˆ†é…ã€‚ å¼º Etag å€¼ï¼šä¸è®ºå®ä½“å‘ç”Ÿå¤šä¹ˆç»†å¾®çš„å˜åŒ–éƒ½ä¼šæ”¹å˜å…¶å€¼ã€‚Etag: &quot;usagi-1234&quot; å¼± Etag å€¼ï¼šå¼± Etag å€¼åªç”¨äºæç¤ºèµ„æºæ˜¯å¦ç›¸åŒã€‚åªæœ‰èµ„æºå‘ç”Ÿäº†æ ¹æœ¬æ”¹å˜ï¼Œäº§ç”Ÿå·®å¼‚æ—¶æ‰ä¼šæ”¹å˜ Etag å€¼ã€‚è¿™æ—¶ï¼Œä¼šåœ¨å­—æ®µå€¼æœ€å¼€å§‹å¤„é™„åŠ  W/ã€‚ Etag:W/&quot;usagi-1234&quot;ã€‚ å®ä½“é¦–éƒ¨å­—æ®µ\bExpiresExpires: Wed, 04 Jul 2012 08:26:05 GMT é¦–éƒ¨å­—æ®µExpiresä¼šå°†èµ„æºå¤±æ•ˆçš„æ—¥æœŸå‘ŠçŸ¥å®¢æˆ·ç«¯ã€‚ç¼“å­˜æœåŠ¡å™¨åœ¨æ¥å—åˆ°å«æœ‰é¦–éƒ¨å­—æ®µExpiresçš„å“åº”åï¼Œä¼šä»¥ç¼“å­˜æ¥åº”ç­”è¯·æ±‚ï¼Œåœ¨Expireså­—æ®µå€¼æŒ‡å®šçš„æ—¶é—´ä¹‹å‰ï¼Œå“åº”çš„å‰¯æœ¬ä¼šä¸€ç›´è¢«ä¿å­˜ã€‚å½“è¶…è¿‡æŒ‡å®šçš„æ—¶é—´åï¼Œç¼“å­˜æœåŠ¡å™¨åœ¨è¯·æ±‚å‘é€è¿‡æ¥æ—¶ï¼Œä¼šè½¬å‘æºæœåŠ¡å™¨è¯·æ±‚èµ„æºã€‚ æºæœåŠ¡å™¨ä¸å¸Œæœ›ç¼“å­˜æœåŠ¡å™¨å¯¹èµ„æºç¼“å­˜æ—¶ï¼Œæœ€å¥½åœ¨Expireså­—æ®µå†…å†™å…¥ä¸é¦–éƒ¨å­—æ®µ Date ç›¸åŒçš„æ—¶é—´å€¼ã€‚ ä½†æ˜¯ï¼Œå½“é¦–éƒ¨å­—æ®µCache-Controlæœ‰æŒ‡å®šmax-ageæŒ‡ä»¤æ—¶ï¼Œæ¯”èµ·é¦–éƒ¨å­—æ®µExpiresï¼Œ\b ä¼šä¼˜å…ˆå¤„ç† max-age æŒ‡ä»¤ã€‚ \bLast-ModifiedLast-Modified: Wed, 23 May 2012 09:59:55 GMT é¦–éƒ¨å­—æ®µLast-ModifiedæŒ‡æ˜èµ„æºæœ€ç»ˆä¿®æ”¹æ—¶é—´ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ Request-URI æŒ‡å®šèµ„æºè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚ä½†ç±»ä¼¼ä½¿ç”¨ CGI è„šæœ¬è¿›è¡ŒåŠ¨æ€æ•°æ®å¤„ç†æ—¶ï¼Œè¯¥å€¼æœ‰å¯èƒ½ä¼šå˜æˆæ•°æ®æœ€ç»ˆä¿®æ”¹æ—¶çš„æ—¶é—´ã€‚ å‚è€ƒä¸æ¨èã€Šå›¾è§£ HTTPã€‹ç¼“å­˜è¯¦è§£æµ…è°ˆ web ç¼“å­˜æµ…è°ˆæµè§ˆå™¨ç¼“å­˜","link":"/blog/2018/08/26/%E6%B5%8F%E8%A7%88%E5%99%A8http%E7%BC%93%E5%AD%98/"},{"title":"vueå“åº”å¼åŸç†","text":"initState new Vue() =&gt; _init() =&gt; initState: 123456789101112131415function initState(vm: Component) { vm._watchers = []; const opts = vm.$options; if (opts.props) initProps(vm, opts.props); if (opts.methods) initMethods(vm, opts.methods); if (opts.data) { initData(vm); } else { observe((vm._data = {}), true /* asRootData */); } if (opts.computed) initComputed(vm, opts.computed); if (opts.watch &amp;&amp; opts.watch !== nativeWatch) { initWatch(vm, opts.watch); }} åˆ¤æ–­è¯¥ vue å®ä¾‹æ˜¯å¦å­˜åœ¨propsã€methodsã€dataã€computedã€watchè¿›è¡Œè°ƒç”¨ç›¸åº”çš„åˆå§‹åŒ–å‡½æ•° initProps ä¸ initDataä¸»è¦å·¥ä½œæ˜¯è°ƒç”¨definePropertyç»™å±æ€§åˆ†åˆ«æŒ‚è½½ get(è§¦å‘è¯¥é’©å­æ—¶ï¼Œä¼šå°†å½“å‰å±æ€§çš„ dep å®ä¾‹æ¨å…¥å½“å‰çš„ Dep.target ä¹Ÿå°±æ˜¯å½“å‰ watcher çš„ deps ä¸­å³å®ƒè®¢é˜…çš„ä¾èµ–ï¼ŒDep.target ä¸‹æ–‡ä¼šè®²åˆ°ã€‚ä¸”è¯¥ dep å®ä¾‹ä¹Ÿä¼šå°†å½“å‰ watcher å³è§‚å¯Ÿè€…æ¨å…¥å…¶ subs æ•°ç»„ä¸­)ã€set æ–¹æ³•ï¼ˆé€šçŸ¥è¯¥ä¾èµ– subs ä¸­æ‰€æœ‰çš„è§‚å¯Ÿè€… watcher å»è°ƒç”¨ä»–ä»¬çš„ update æ–¹æ³•ï¼‰ã€‚ initComputedå®ƒçš„ä½œç”¨æ˜¯å°† computed å¯¹è±¡ä¸­æ‰€æœ‰çš„å±æ€§éå†ï¼Œå¹¶ç»™è¯¥å±æ€§ new ä¸€ä¸ª computed watcherï¼ˆè®¡ç®—å±æ€§ä¸­å®šä¹‰äº†ä¸ª dep ä¾èµ–ï¼Œç»™éœ€è¦ä½¿ç”¨è¯¥è®¡ç®—å±æ€§çš„ watcher è®¢é˜…ï¼‰ã€‚ä¹Ÿä¼šé€šè¿‡è°ƒç”¨definePropertyç»™ computed æŒ‚è½½ getï¼ˆget æ–¹æ³•ï¼‰ã€set æ–¹æ³•ï¼ˆset æ–¹æ³•ä¼šåˆ¤æ–­æ˜¯å¦ä¼ å…¥ï¼Œå¦‚æœæ²¡ä¼ å…¥ä¼šè®¾ç½®æˆ noop ç©ºå‡½æ•°ï¼‰computedå±æ€§çš„ get æ–¹æ³•æ˜¯ä¸‹é¢å‡½æ•°çš„è¿”å›å€¼å‡½æ•° 123456789function createComputedGetter(key) { return function computedGetter() { const watcher = this._computedWatchers &amp;&amp; this._computedWatchers[key]; if (watcher) { watcher.depend(); return watcher.evaluate(); } };} æ³¨æ„å…¶ä¸­çš„watcher.depend(),è¯¥æ–¹æ³•è®©ç”¨åˆ°è¯¥å±æ€§çš„ watcher è§‚å¯Ÿè€…è®¢é˜…è¯¥ watcher ä¸­çš„ä¾èµ–ï¼Œä¸”è¯¥è®¡ç®—å±æ€§ watcher ä¼šå°†è®¢é˜…å®ƒçš„ watcher æ¨å…¥ä»–çš„ subs ä¸­(å½“è®¡ç®—å±æ€§å€¼æ”¹å˜çš„æ—¶å€™ï¼Œé€šçŸ¥è®¢é˜…ä»–çš„ watcher è§‚å¯Ÿè€…)watcher.evaluate()ï¼Œè¯¥æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ watcher çš„ get æ–¹æ³•(å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ watcher çš„ get æ–¹æ³•ä¼šè°ƒç”¨ pushTarget å°†ä¹‹å‰çš„ Dep.target å®ä¾‹å…¥æ ˆï¼Œå¹¶è®¾ç½® Dep.target ä¸ºè¯¥ computed watcher,è¢«è¯¥è®¡ç®—å±æ€§ä¾èµ–çš„å“åº”å¼å±æ€§ä¼šå°†è¯¥ computed watcher æ¨å…¥å…¶ subs ä¸­ï¼Œæ‰€ä»¥å½“è¢«ä¾èµ–çš„å“åº”å¼å±æ€§æ”¹å˜æ—¶ï¼Œä¼šé€šçŸ¥è®¢é˜…ä»–çš„ computed watcher,computed watcher å†é€šçŸ¥è®¢é˜…è¯¥è®¡ç®—å±æ€§çš„ watcher è°ƒç”¨ update æ–¹æ³•)ï¼Œget æ–¹æ³•ä¸­è°ƒç”¨è®¡ç®—å±æ€§ key ç»‘å®šçš„ handler å‡½æ•°è®¡ç®—å‡ºå€¼ã€‚ initWatchè¯¥ watcher ä¸º user watcherï¼ˆå¼€å‘äººå‘˜è‡ªå·±åœ¨ç»„ä»¶ä¸­è‡ªå®šä¹‰çš„ï¼‰ã€‚initWatch çš„ä½œç”¨æ˜¯éå† watch ä¸­çš„å±æ€§ï¼Œå¹¶å¯¹æ¯ä¸ª watch ç›‘å¬çš„å±æ€§è°ƒç”¨å®šä¹‰çš„$watch 12345678910111213141516171819Vue.prototype.$watch = function( expOrFn: string | Function, cb: any, options?: Object): Function { const vm: Component = this; if (isPlainObject(cb)) { return createWatcher(vm, expOrFn, cb, options); } options = options || {}; options.user = true; // ä»£è¡¨è¯¥watcheræ˜¯ç”¨æˆ·è‡ªå®šä¹‰watcher const watcher = new Watcher(vm, expOrFn, cb, options); if (options.immediate) { cb.call(vm, watcher.value); } return function unwatchFn() { watcher.teardown(); };}; ä»£ç ä¸­è°ƒç”¨ new Watcher çš„æ—¶å€™ï¼Œä¹Ÿä¼šåŒ render watcher ä¸€æ ·ï¼Œæ‰§è¡Œä¸‹ watcher çš„ get æ–¹æ³•ï¼Œè°ƒç”¨pushTargetå°†å½“å‰ user watcher èµ‹å€¼ç»™ Dep.target,get()ä¸­value = this.getter.call(vm, vm)è¿™ä¸ªè¯­å¥ä¼šè§¦å‘è¯¥è‡ªå®šä¹‰ watcher ç›‘å¬çš„å“åº”å¼å±æ€§çš„ get æ–¹æ³•ï¼Œå¹¶å°†å½“å‰çš„ user watcher æ¨å…¥è¯¥å±æ€§ä¾èµ–çš„ subs ä¸­ï¼Œæ‰€ä»¥å½“ user watcher ç›‘å¬çš„å±æ€§ set è§¦å‘åï¼Œé€šçŸ¥è®¢é˜…è¯¥ä¾èµ–çš„ watcher å»è§¦å‘ updateï¼Œä¹Ÿå°±æ˜¯è§¦å‘è¯¥ watch ç»‘å®šçš„ key å¯¹åº”çš„ handlerã€‚ç„¶åå°±æ˜¯è°ƒç”¨ popTarget å‡ºæ ˆå¹¶èµ‹å€¼ç»™ Dep.targetã€‚ $mountinitState åˆå§‹åŒ–å·¥ä½œå¤§è‡´åˆ°è¿™é‡Œè¿‡ï¼Œæ¥ä¸‹å»ä¼šæ‰§è¡Œ$mountå¼€å§‹æ¸²æŸ“å·¥ä½œ$mount ä¸»è¦å·¥ä½œï¼šnew äº†ä¸€ä¸ªæ¸²æŸ“ Watcherï¼Œå¹¶å°† updateCompent ä½œä¸º callback ä¼ é€’è¿›å»å¹¶æ‰§è¡Œ 12345678910111213141516updateComponent = () =&gt; { vm._update(vm._render(), hydrating);};new Watcher( vm, updateComponent, noop, { before() { if (vm._isMounted) { callHook(vm, 'beforeUpdate'); } } }, true /* isRenderWatcher */); ä¸‰ç§ watcher ä¸­ new Watcher çš„æ—¶å€™ï¼Œåªæœ‰ computed watcher ä¸ä¼šä¸€å¼€å§‹å°±æ‰§è¡Œå®ƒçš„ get()æ–¹æ³•ã€‚$mount é‡Œé¢ new çš„è¿™ä¸ª render watcher ä¼šè°ƒç”¨get()æ–¹æ³•ï¼Œè°ƒç”¨pushTargetå°†å½“å‰ render watcher èµ‹å€¼ç»™ Dep.targetã€‚æ¥ä¸‹å»é‡å¤´æˆæ¥äº†ï¼Œè°ƒç”¨updateComponent,è¯¥æ–¹æ³•ä¼šæ‰§è¡Œvm._update(vm._render(), hydrating)ï¼Œå…¶ä¸­ render å‡½æ•°ä¼šè§¦å‘ html ä¸­ä½¿ç”¨åˆ°çš„å“åº”å¼å±æ€§çš„ get é’©å­ã€‚get é’©å­ä¼šè®©è¯¥å“åº”å¼å±æ€§çš„ä¾èµ–å®ä¾‹ dep å°†å½“å‰çš„ render watcher æ¨å…¥å…¶ subs æ•°ç»„ä¸­ï¼Œæ‰€ä»¥å½“ä¾èµ–çš„å“åº”å¼å±æ€§æ”¹å˜ä¹‹åï¼Œä¼šéå† subs é€šçŸ¥è®¢é˜…å®ƒçš„ watcher å»è°ƒç”¨ update()ã€‚ ä¾‹å­å¯èƒ½å¤§å®¶å¯¹ watcher å’Œ dep è°ƒæ¥è°ƒå»ä¸€å¤´é›¾æ°´ï¼Œæˆ‘è®²ä¸ªå®ä¾‹ 1234567891011121314151617&lt;div id='app'&gt; &lt;div&gt;{{ a }}&lt;/div&gt; &lt;div&gt;{{ b }}&lt;/div&gt;&lt;/div&gt;;new Vue({ el: '#app', data() { return { a: 1 }; }, computed: { b() { return a + 1; } }}); æˆ‘ç›´æ¥ä»æ¸²æŸ“å¼€å§‹è®²ï¼Œåªè®²è·Ÿ dep è·Ÿ watcher æœ‰å…³çš„$mountï¼šnew ä¸€ä¸ªæ¸²æŸ“ watcherï¼ˆwatcher çš„ get æ–¹æ³•ä¸­ä¼šå°†æ¸²æŸ“ watcher èµ‹å€¼ç»™ Dep.targetï¼‰çš„æ—¶å€™ä¼šè§¦å‘ vm._update(vm._render(), hydrating)ï¼Œrender çš„æ—¶å€™ä¼šè·å– html ä¸­ç”¨åˆ°çš„å“åº”å¼å±æ€§ï¼Œä¸Šé¢ä¾‹å­ä¸­å…ˆç”¨åˆ°äº† a,è¿™æ—¶ä¼šè§¦å‘ a çš„ get é’©å­,å…¶ä¸­dep.depend()ä¼šå°†å½“å‰çš„æ¸²æŸ“ watcher æ¨å…¥åˆ° a å±æ€§çš„ dep çš„ subs æ•°ç»„ä¸­ã€‚æ¥ä¸‹å»ç»§ç»­æ‰§è¡Œï¼Œè®¿é—®åˆ° bï¼ˆb æ˜¯è®¡ç®—å±æ€§çš„å€¼ï¼‰ï¼Œä¼šè§¦å‘è®¡ç®—å±æ€§çš„ get æ–¹æ³•ã€‚è®¡ç®—å±æ€§çš„ get æ–¹æ³•æ˜¯è°ƒç”¨createComputedGetterå‡½æ•°åçš„è¿”å›å‡½æ•°computedGetterï¼ŒcomputedGetterå‡½æ•°ä¸­ä¼šæ‰§è¡Œwatcher.depend()ã€‚Watcher çš„ depend æ–¹æ³•æ˜¯ä¸“é—¨ç•™ç»™ computed watcher ä½¿ç”¨çš„ã€‚åˆšæ‰ä¸Šé¢è¯´è¿‡äº†é™¤äº† computed watcherï¼Œå…¶ä»–ä¸¤ç§ watcher åœ¨ new å®Œä¹‹åéƒ½ä¼šæ‰§è¡Œä»–ä»¬çš„ get æ–¹æ³•ï¼Œé‚£ä¹ˆ computed watcher åœ¨ new å®Œä¹‹åå¹²å˜›å‘¢ï¼Œå®ƒä¼š new ä¸€ä¸ª depã€‚å›åˆ°åˆšæ‰è¯´çš„ä¸“é—¨ä¸º computed watcher å¼€è®¾çš„æ–¹æ³•watcher.depend()ï¼Œä»–çš„ä½œç”¨æ˜¯æ‰§è¡Œthis.dep.depend()ï¼ˆcomputed watcher å®šä¹‰çš„ dep å°±æ˜¯åœ¨è¿™é‡Œä½¿ç”¨åˆ°çš„ï¼‰ã€‚this.dep.depend()ä¼šè®©å½“å‰çš„æ¸²æŸ“ watcher è®¢é˜…è¯¥è®¡ç®—å±æ€§ä¾èµ–ï¼Œè¯¥è®¡ç®—å±æ€§ä¹Ÿä¼šå°†æ¸²æŸ“ watcher æ¨å…¥åˆ°å®ƒè‡ªå·±çš„ subsï¼ˆ[render watcher]ï¼‰ä¸­ï¼Œå½“è®¡ç®—å±æ€§çš„å€¼ä¿®æ”¹ä¹‹åä¼šé€šçŸ¥ subs ä¸­çš„ watcher è°ƒç”¨update(),æ‰€ä»¥è®¡ç®—å±æ€§å€¼å˜äº†é¡µé¢èƒ½åˆ·æ–°ã€‚å›åˆ°å‰é¢è¯´çš„è§¦å‘ b è®¡ç®—å±æ€§çš„ get é’©å­é‚£é‡Œï¼Œget é’©å­æœ€åä¼šæ‰§è¡Œwatcher.evaluate(),watcher.evaluate()ä¼šæ‰§è¡Œ computed watcher çš„get()æ–¹æ³•ã€‚è¿™æ—¶å€™é‡ç‚¹æ¥äº†ï¼Œä¼šå°† Dep.targetï¼ˆrender watcherï¼‰æ¨å…¥ targetStack æ ˆä¸­ï¼ˆå­˜å…¥ä¹‹åä»¥ä¾¿å¾…ä¼šå„¿å–å‡ºç»§ç»­ç”¨ï¼‰ï¼Œç„¶åå°†è¿™ä¸ªè®¡ç®—å±æ€§çš„ computed watcher èµ‹å€¼ç»™ Dep.targetã€‚get æ–¹æ³•ä¸­value = this.getter.call(vm, vm),ä¼šæ‰§è¡Œ computed å±æ€§ç»‘å®šçš„ handlerã€‚å¦‚ä¸Šé¢ä¾‹å­ä¸­ return a + 1ã€‚ä½¿ç”¨äº† a é‚£ä¹ˆå°±ä¸€å®šä¼šè§¦å‘ a çš„ get é’©å­ï¼Œget é’©å­åˆä¼šè°ƒç”¨dep.depend()ï¼Œdep.depend()ä¼šè®© computed watcher å°† dep å­˜å…¥å®ƒçš„ deps æ•°ç»„ä¸­ï¼Œa çš„ dep ä¼šå°†å½“å‰çš„ Dep.target(computed watcher)å­˜å…¥å…¶ subs æ•°ç»„ä¸­ï¼Œå½“å‰ä¾‹å­ä¸­ a çš„ subs ä¸­å°±ä¼šæ˜¯[render watcher,computed watcher],æ‰€ä»¥ a å€¼å˜åŒ–ä¼šéå† a çš„ subs ä¸­çš„ watcher è°ƒç”¨update()æ–¹æ³•ï¼Œhtml ä¸­ç”¨åˆ°çš„ a ä¼šåˆ·æ–°ï¼Œè®¡ç®—å±æ€§ watcher è°ƒç”¨update()æ–¹æ³•ä¼šé€šçŸ¥ä»–è‡ªå·±çš„ subsï¼ˆ[render watcher]ï¼‰ä¸­ render watcher å»è°ƒç”¨ update æ–¹æ³•ï¼Œhtml ä¸­ç”¨åˆ°çš„è®¡ç®—å±æ€§ b æ‰ä¼šåˆ·æ–° domï¼ˆè¿™é‡Œæä¸ªé†’ï¼Œæˆ‘åªæ˜¯ç²—ç•¥çš„è®²ï¼Œè®¡ç®—å±æ€§ä¾èµ–çš„å±æ€§å˜åŒ–åä»–ä¸ä¸€å®šä¼šè§¦å‘æ›´æ–°ï¼Œä»–ä¼šæ¯”è¾ƒè®¡ç®—å®Œä¹‹åçš„å€¼æ˜¯å¦å˜åŒ–ï¼‰ã€‚computed watcher çš„ get()æ–¹æ³•æœ€åä¼šè°ƒç”¨popTarget(),å°†ä¹‹å‰å­˜å…¥ render watcher å‡ºæ ˆå¹¶èµ‹å€¼ç»™ Dep.targetï¼Œè¿™æ—¶å€™æˆ‘ä¾‹å­ä¸­ targetStack å°±å˜æˆç©ºæ•°ç»„äº†ã€‚render watcher çš„ get æ–¹æ³•æ‰§è¡Œåˆ°æœ€åä¹Ÿä¼šå‡ºæ ˆï¼Œè¿™æ—¶å€™ä¼šå°† Dep.target èµ‹å€¼ä¼šç©ºã€‚","link":"/blog/2018/09/10/vue%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/"},{"title":"é…ç½®nginxè§£å†³vueè·¯ç”±historyæ¨¡å¼ä¸‹åˆ·æ–°404é—®é¢˜","text":"åœ¨ vue è·¯ç”±æ¨¡å¼ä¸º history çš„æ—¶å€™ï¼Œåˆ·æ–°é¡µé¢ä¼šå‡ºç° 404 é—®é¢˜ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨æœåŠ¡å™¨é…ç½®å¦‚æœ URL åŒ¹é…ä¸åˆ°ä»»ä½•é™æ€èµ„æºï¼Œå°±è·³è½¬åˆ°é»˜è®¤çš„ index.htmlã€‚ 123456789server { listen 8105; // è¡¨ç¤ºä½ nginxç›‘å¬çš„ç«¯å£å· root /home/admin/sites/vue-nginx/dist; // vueæ‰“åŒ…åçš„æ–‡ä»¶å¤¹distç›®å½• index index.html; location / { try_files $uri $uri/ /index.html; }}","link":"/blog/2018/09/11/%E9%85%8D%E7%BD%AEnginx%E8%A7%A3%E5%86%B3vue%E8%B7%AF%E7%94%B1history%E6%A8%A1%E5%BC%8F%E4%B8%8B%E5%88%B7%E6%96%B0404%E9%97%AE%E9%A2%98/"},{"title":"é˜»æ­¢ä¸­æ–‡è¾“å…¥æ³•è¾“å…¥æ‹¼éŸ³çš„æ—¶å€™è§¦å‘inputäº‹ä»¶","text":"å‰è¨€æœ€è¿‘çœ‹ element-ui æºç çš„æ—¶å€™çœ‹åˆ° el-input å‘ç°çš„è¿™ä¸ªå°‘è§çš„äº‹ä»¶ã€‚ compositionstartã€compositionendäº‹ä»¶ï¼ˆMDN è§£é‡Š)compositionstartäº‹ä»¶è§¦å‘äºä¸€æ®µæ–‡å­—çš„è¾“å…¥ä¹‹å‰ï¼ˆç±»ä¼¼äº keydown äº‹ä»¶ï¼Œä½†æ˜¯è¯¥äº‹ä»¶ä»…åœ¨è‹¥å¹²å¯è§å­—ç¬¦çš„è¾“å…¥ä¹‹å‰ï¼Œè€Œè¿™äº›å¯è§å­—ç¬¦çš„è¾“å…¥å¯èƒ½éœ€è¦ä¸€è¿ä¸²çš„é”®ç›˜æ“ä½œã€è¯­éŸ³è¯†åˆ«æˆ–è€…ç‚¹å‡»è¾“å…¥æ³•çš„å¤‡é€‰è¯ï¼‰ã€‚å½“æ–‡æœ¬æ®µè½çš„ç»„æˆå®Œæˆæˆ–å–æ¶ˆæ—¶, compositionend äº‹ä»¶å°†è¢«è§¦å‘ (å…·æœ‰ç‰¹æ®Šå­—ç¬¦çš„è§¦å‘, éœ€è¦ä¸€ç³»åˆ—é”®å’Œå…¶ä»–è¾“å…¥, å¦‚è¯­éŸ³è¯†åˆ«æˆ–ç§»åŠ¨ä¸­çš„å­—è¯å»ºè®®)ã€‚ 123456789101112131415161718192021222324252627282930/** * @param {Element} elem inputå…ƒç´  * @param {Function} callback inputäº‹ä»¶ç»‘å®šçš„å›è°ƒ */function inputEvent(elem, callback) { let isOnComposition = false; elem.addEventListener('compositionstart', function(event) { isOnComposition = true; }); elem.addEventListener('compositionend', function(event) { isOnComposition = false; const val = event.target.value; handleInput(val); }); elem.addEventListener('input', function(event) { const val = event.target.value; handleInput(val); }); function handleInput(val) { if (isOnComposition) return; callback(val); }}window.onload = function() { const input = document.getElementById('input'); inputEvent(input, function(val) { console.log(val); });};","link":"/blog/2018/11/12/%E9%98%BB%E6%AD%A2%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95%E8%BE%93%E5%85%A5%E6%8B%BC%E9%9F%B3%E7%9A%84%E6%97%B6%E5%80%99%E8%A7%A6%E5%8F%91input%E4%BA%8B%E4%BB%B6/"},{"title":"javascriptæ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°","text":"æ•°ç»„ æ–¹æ³•123456789101112//ä¸€ã€æ•°ç»„var arr = [];// æ·»åŠ å…ƒç´ arr.push(1, 2); // [1,2]// å¼€å¤´æ’å…¥arr.unshift(0); // [0, 1, 3]// å°¾éƒ¨åˆ é™¤arr.pop(); // [0, 1]// å¤´éƒ¨åˆ é™¤arr.shift(); // [1]// æ•°ç»„åˆå¹¶[1].concat([2]); // [1,2] è¿­ä»£å™¨ every every æ–¹æ³•ä¼šè¿­ä»£æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°è¿”å› falseã€‚ some some å’Œ every ç±»ä¼¼ï¼Œä¸è¿‡ some æ–¹æ³•ä¼šè¿­ä»£æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°å‡½æ•°è¿”å› true forEach å’Œ for å¾ªç¯çš„ç»“æœç›¸åŒ map è¿”å›æ–°çš„æ•°ç»„ [1,2].map(o =&gt; o * 2) // [2,4] filter è¿”å›æ–°çš„æ•°ç»„ [1,2].filter(o =&gt; o &gt; 1) // [2] reduce [1,2].reduce((result, current) =&gt; result + current) // 3 for of for (let n of numbers) { console.log((n % 2 === 0) ? 'even' : 'odd')}; entries 12345const numbers = [1, 2, 3];let aEntries = numbers.entries(); // å¾—åˆ°é”®å€¼å¯¹çš„è¿­ä»£å™¨console.log(aEntries.next().value); // [0, 1] ä½ç½®0çš„å€¼ä¸º1console.log(aEntries.next().value); // [1, 2] ä½ç½®1çš„å€¼ä¸º2console.log(aEntries.next().value); // [2, 3] ä½ç½®2çš„å€¼ä¸º3 keys 12const numbers = [1, 2, 3];console.log(Object.keys(numbers)); // ['0','1','2']; values 12const numbers = [1, 2, 3];console.log(Object.values(numbers)); // [1,2,3] Array.from Array.of fill copyWithin sort find findIndex includes æ ˆ æ ˆæ˜¯ä¸€ç§éµä»åè¿›å…ˆå‡ºåŸåˆ™çš„æœ‰åºé›†åˆ å®ç°1234567891011121314151617181920212223242526272829function Stack() { let items = []; // å‘æ ˆæ·»åŠ å…ƒç´  this.push = function(element) { items.push(element); }; // ä»æ ˆç§»é™¤å…ƒç´  this.pop = function() { return items.pop(); }; // æŸ¥çœ‹æ ˆé¡¶å…ƒç´  this.peek = function() { return items[item.length - 1]; }; // æ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º this.isEmpty = function() { return items.length == 0; }; this.size = function() { return items.length; }; // æ¸…ç©ºå’Œæ‰“å°æ ˆå…ƒç´  this.clear = function() { items = []; }; this.print = function() { console.log(items.toString()); };} ç”¨æ ˆè§£å†³é—®é¢˜å­˜å‚¨è®¿é—®è¿‡çš„ä»»åŠ¡æˆ–è·¯å¾„ã€æ’¤é”€çš„æ“ä½œç­‰ã€‚ é˜Ÿåˆ— é˜Ÿåˆ—æ˜¯éµå¾ª FIFO(First In First Out, å…ˆè¿›å…ˆå‡ºï¼Œä¹Ÿç§°ä¸ºå…ˆæ¥å…ˆæœåŠ¡) å®ç°1234567891011121314151617181920212223242526function Queue() { let items = []; // å‘é˜Ÿåˆ—æ·»åŠ å…ƒç´  this.enqueue = function(element) { items.push(element); }; // ä»é˜Ÿåˆ—ç§»é™¤å…ƒç´  this.dequeue = function() { return items.shift(); }; // æŸ¥çœ‹é˜Ÿåˆ—å¤´å…ƒç´  this.front = function() { return items[0]; }; // æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º this.isEmpty = function() { return items.length == 0; }; this.size = function() { return items.length; }; // æ‰“å°é˜Ÿåˆ—å…ƒç´  this.print = function() { console.log(items.toString()); };} é“¾è¡¨ é“¾è¡¨æ‘ç²—æœ‰åºçš„å…ƒç´ é›†åˆï¼Œä½†ä¸åŒäºæ•°ç»„ï¼Œé“¾è¡¨ä¸­çš„å…ƒç´ åœ¨å†…å­˜ä¸­å¹¶ä¸æ˜¯è¿ç»­æ”¾ç½®çš„ã€‚æ¯ä¸ªå…ƒç´ ç”±ä¸€ä¸ªå­˜å‚¨å…ƒç´ æœ¬èº«çš„èŠ‚ç‚¹å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼ˆä¹Ÿç§°æŒ‡é’ˆæˆ–é“¾æ¥ï¼‰ç»„æˆã€‚ç›¸å¯¹äºä¼ ç»Ÿçš„æ•°ç»„ï¼Œé“¾è¡¨çš„ä¸€ä¸ªå¥½å¤„åœ¨äºï¼Œæ·»åŠ æˆ–ç§»é™¤å…ƒç´ çš„æ—¶å€™ä¸éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚ç„¶è€Œï¼Œé“¾è¡¨éœ€è¦ä½¿ç”¨æŒ‡é’ˆï¼Œå› æ­¤å®ç°é“¾è¡¨æ—¶éœ€è¦é¢å¤–æ³¨æ„ã€‚æ•°ç»„çš„å¦ä¸€ä¸ªç»†èŠ‚æ˜¯å¯ä»¥ç›´æ¥è®¿é—®ä»»ä½•ä½ç½®çš„ä»»ä½•å…ƒç´ ï¼Œè€Œè¦æƒ³è®¿é—®é“¾è¡¨ä¸­é—´çš„ä¸€ä¸ªå…ƒç´ ï¼Œéœ€è¦ä»èµ·ç‚¹ï¼ˆè¡¨å¤´ï¼‰å¼€å§‹è¿­ä»£åˆ—è¡¨ç›´åˆ°æ‰¾åˆ°æ‰€éœ€çš„å…ƒç´ ã€‚ å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122function LinkedList() { let Node = function(element) { this.element = element; this.next = null; }; let length = 0; let head = null; // å‘é“¾è¡¨å°¾éƒ¨è¿½åŠ å…ƒç´  this.append = function(element) { let node = new Node(element), current; if (head === null) { head = node; } else { current = head; // å¾ªç¯åˆ—è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åä¸€é¡¹ while (current.next) { current = current.next; } // æ‰¾åˆ°æœ€åä¸€é¡¹ï¼Œå°†å…¶nextèµ‹ä¸ºnodeï¼Œå»ºç«‹é“¾æ¥ current.next = node; } length++ï¼› // æ›´æ–°åˆ—è¡¨çš„é•¿åº¦ } // ä»é“¾è¡¨ä¸­ç§»é™¤å…ƒç´  this.removeAt = function() { // æ£€æŸ¥è¶Šç•Œå€¼ if (position &gt; -1 &amp;&amp; position &lt; length) { let current = head, previous, index = 0; // ç§»é™¤ç¬¬ä¸€é¡¹ if (position === 0) { head = current.next; } else { while (index++ &lt; position) { previous = current; current = current.next; } // å°†previous ä¸ currentçš„ä¸‹ä¸€é¡¹é“¾æ¥èµ·æ¥ï¼š è·³è¿‡currentï¼Œä»è€Œç§»é™¤å®ƒ previous.next = current.next; } length--; return current.element; } else { return null; } } // åœ¨ä»»æ„ä½ç½®æ’å…¥å…ƒç´  this.insert = function(position, element) { // æ£€æŸ¥è¶Šç•Œå€¼ if (position &gt;= 0 &amp;&amp; position &lt;= length) { let node = new Node(element), current = head, previous, index = 0; if (position === 0) { // åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ  node.next = current; head = node; } else { while (index++ &lt; position) { previous = current; current = current.next; } node.next = current; previous.next = node; } length++; // æ›´æ–°åˆ—è¡¨çš„é•¿åº¦ return true; } else { return false; } } // toStringæ–¹æ³• this.toString = function() { let current = head, string = ''; while (current) { string += current.element + (current.next ? 'n' : ''); current = current.next; } return string; } // indexOf æ–¹æ³• this.indexOf = function(elment) { let current = head, index = 0; while(current) { if (element === current.element) { return index; } index++; current = current.next; } return -1; } // remove æ–¹æ³• this.remove = function(elment) { let index = this.indexOf(element); return this.removeAt(index); } // isEmpty æ–¹æ³• this.isEmpty = function() { return length == 0; } // size æ–¹æ³• this.size = function() { return length; } // getHead æ–¹æ³• this.getHead = function() { return head; }} åŒå‘é“¾è¡¨ï¼ˆç•™ç»™å¤§å®¶è‡ªå·±æ€è€ƒï¼‰é›†åˆ é›†åˆæ˜¯ç”±ä¸€ç»„æ— åºä¸”å”¯ä¸€ï¼ˆå³ä¸èƒ½é‡å¤ï¼‰çš„é¡¹ç»„åˆçš„ã€‚è¿™ä¸ªæ•°æ®ç»“æ„ä½¿ç”¨äº†ä¸æœ‰é™é›†åˆç›¸åŒçš„æ•°å­¦æ¦‚å¿µï¼Œä½†åº”ç”¨åœ¨è®¡ç®—æœºç§‘å­¦çš„æ•°æ®ç»“æ„ä¸­ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495function Set() { let items = {}; // has æ–¹æ³• this.has = function(value) { return items.hasOwnProperty(value); }; // add æ–¹æ³• this.add = function(value) { if (!this.has(value)) { items[value] = value; return true; } return false; }; // remove æ–¹æ³• this.remove = function(value) { if (this.has(value)) { delete items[value]; return true; } return false; }; // clear æ–¹æ³• this.clear = function() { items = {}; }; // size æ–¹æ³• this.size = function() { return Object.keys(items).length; }; // values æ–¹æ³• this.values = function() { let values = []; for (let i = 0, keys = Object.keys(items); i &lt; keys.length; i++) { values.push(items[keys[i]]); } return values; }; // å¹¶é›† this.union = function(otherSet) { let unionSet = new Set(); let values = this.values(); for (let i = 0; i &lt; values.length; i++) { unionSet.add(values[i]); } values = otherSet.values(); for (let i = 0; i &lt; values.length; i++) { unionSet.add(values[i]); } return unionSet; }; // äº¤é›† this.intersection = function(otherSet) { let intersectionSet = new Set(); let values = this.values(); for (let i = 0; i &lt; values.length; i++) { if (otherSet.has(values[i])) { intersectionSet.add(values[i]); } } return intersectionSet; }; // å·®é›† this.difference = function(otherSet) { let differenceSet = new Set(); let values = this.values(); for (let i = 0; i &lt; values.length; i++) { if (!otherSet.has(values[i])) { differenceSet.add(values[i]); } } return differenceSet; }; // å­é›† this.subset = function(otherSet) { if (this.size() &gt; otherSet.size()) { return false; } else { let values = this.values(); for (let i = 0; i &lt; values.length; i++) { if (!otherSet.has(values[i])) { return false; } } return true; } };} å­—å…¸å’Œæ•£åˆ—è¡¨å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748function Dictionary() { var items = {}; // has å’Œ set æ–¹æ³• this.has = function(key) { return items.hasOwnProperty(key); }; this.set = function(key, value) { item[key] = value; }; // delete æ–¹æ³• this.delete = function(key) { if (this.has(key)) { delete items[key]; return true; } return false; }; // get å’Œ values æ–¹æ³• this.get = function(key) { return this.has(key) ? items[key] : undefined; }; this.values = function() { var values = []; for (var k in items) { if (this.has(k)) { values.push(items[k]); } } return values; }; // clear æ–¹æ³• this.clear = function() { items = {}; }; // size æ–¹æ³• this.size = function() { return Object.keys(items).length; }; // keys æ–¹æ³• this.keys = function() { return Object.keys(items); }; // getItems æ–¹æ³• this.getItems = function() { return items; };} æ•£åˆ—è¡¨ HashTable ç±» ä¹Ÿå« HashMap ç±»ï¼Œå®ƒæ˜¯ Dictionary ç±»çš„ä¸€ç§æ•£åˆ—è¡¨æ˜¯å®ç°æ–¹å¼ã€‚æ•£åˆ—ç®—æ³•çš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«çš„åœ¨æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ã€‚ 123456789101112131415161718192021function HashTable() { var table = []; var loseloseHashCode = function(key) { var hash = 0; for (var i = 0; i &lt; key.length; i++) { hash += key.charCodeAt(i); } return hash % 37; }; this.put = function(key, value) { var position = loseloseHashCode(key); console.log(position + ' - ' + key); table[position] = value; }; this.get = function(key) { return table[loseloseHashCode(key)]; }; this.remove = function(key) { table[loseloseHashCode(key)] = undefined; };} Map ç±» es6 æ–°å¢äº† Map ç±» 12345678910var map = new Map();map.set('a', 'b');console.log(map.has('a')); // trueconsole.log(map.size()); // è¾“å‡º1console.log(map.keys()); // ['a']console.log(map.values()); // ['b'];// å’ŒDictionaryç±»ä¸åŒï¼Œes6çš„Mapç±»çš„valuesæ–¹æ³•å’Œkeysæ–¹æ³•éƒ½è¿”å›Iteratorï¼Œè€Œä¸æ˜¯å€¼æˆ–é”®æ„æˆçš„æ•°ç»„ã€‚ es6 â€” WeakMap ç±» å’Œ WeakSet ç±» WeakMap å’Œ WeakSet ç±»æ²¡æœ‰ entries keys values ç­‰æ–¹æ³• åªèƒ½ç”¨å¯¹è±¡ä½œä¸ºé”® 1234567var map = new WeakMap();var obj = { name: 'a' };map.set(obj, 'b');console.log(map.has(obj)); // è¾“å‡ºtrueconsole.log(map.get(obj)); // è¾“å…¥'b'map.delete(obj); æ ‘ ä¸€ä¸ªæ ‘ç»“æ„åŒ…å«ä¸€ç³»åˆ—å­˜åœ¨çˆ¶å­å…³ç³»çš„èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼ˆé™¤äº†é¡¶éƒ¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ä»¥åŠé›¶ä¸ªæˆ–å¤šä¸ªå­èŠ‚ç‚¹ï¼› äºŒå‰æ ‘å’ŒäºŒå‰æœç´¢æ ‘123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169function BinarySearchTree() { var Node = function(key) { this.key = key; this.left = null; this.right = null; }; var root = null; var insertNode = function(node, newNode) { if (newNode.key &lt; node.key) { if (node.left === null) { node.left = newNode; } else { insertNode(node.left, newNode); } } else { if (node.right === null) { node.right = newNode; } else { insertNode(node.right, newNode); } } }; // å‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªé”® this.insert = function(key) { var newNode = new Node(key); if ((root = null)) { root = newNode; } else { insertNode(root, newNode); } }; var inOrderTraverseNode = function(node, callback) { if (node !== null) { inOrderTraverseNode(node.left, callback); callback(node.key); inOrderTraverseNode(node.right, callback); } }; // ä¸­åºéå† this.inOrderTraverse = function(callback) { inOrderTraverseNode(root, callback); }; var preOrderTraverseNode = function(node, callback) { if (node !== null) { callback(node.key); preOrderTraverseNode(node.left, callback); preOrderTraverseNode(node.right, callback); } }; // å…ˆåºéå† this.preOrderTraverse = function(callback) { preOrderTraverseNode(root, callback); }; var postOrderTraverseNode = function(node, callback) { if (node !== null) { postOrderTraverseNode(node.left, callback); postOrderTraverseNode(node.right, callback); callback(node.key); } }; // ååºéå† this.postOrderTraverse = function(callback) { postOrderTraverseNode(root, callback); }; // æœç´¢æœ€å°å€¼ this.min = function() { return minNode(root); }; var minNode = function(node) { if (node) { while (node &amp;&amp; node.left !== null) { node = node.left; } return node.key; } return null; }; // æœç´¢æœ€å¤§å€¼ this.max = function() { return maxNode(root); }; var maxNode = function(node) { if (node) { while (node &amp;&amp; node.right !== null) { node = node.right; } return node.key; } return null; }; // æœç´¢ä¸€ä¸ªç‰¹å®šçš„å€¼ this.search = function(key) { return searchNode(root, key); }; var searchNode = function(node, key) { if (node === null) { return false; } if (key &lt; node.key) { return searchNode(node.left, key); } else if (key &gt; node.key) { return searchNode(node.right, key); } else { return true; } }; // ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹ this.remove = function(key) { root = removeNode(root, key); }; var removeNode = function(node, key) { if (node === null) { return null; } if (key &lt; node.key) { node.left = removeNode(node.left, key); return node; } else if (key &gt; node.key) { node.right = removeNode(node.right, key); return node; } else { // é”®ç­‰äºnode.key // ç¬¬ä¸€ç§æƒ…å†µ--ä¸€ä¸ªå¶èŠ‚ç‚¹ if (node.left === null &amp;&amp; node.right === null) { node = null; return node; } // ç¬¬äºŒç§æƒ…å†µ--ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ if (node.left === null) { node = node.right; return node; } else if (node.right === null) { node = node.left; return node; } // ç¬¬ä¸‰ç§æƒ…å†µ---- ä¸€ä¸ªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ var aux = findMinNode(node.right); node.key = aux.key; node.right = removeNode(node.rihgt, aux.key); return node; } var findMinNode = function(node) { while (node &amp;&amp; node.left !== null) { node = node.left; } return node; }; };} è‡ªå¹³è¡¡æ ‘ï¼ˆAVL) å½“æ ‘å¾ˆæ·±çš„æ—¶å€™ï¼Œæ·»åŠ ç§»é™¤å’Œæœç´¢æŸä¸ªèŠ‚ç‚¹æ—¶å¼•èµ·ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263var heightNode = function(node) { if (node === null) { return -1; } else { return Math.max(heightNode(node.left), heightNode(node.right)) + 1; }}var rotationRR = function(node) { var tmp = node.right; node.right = tmp.left; tmp.left = node; return tmp;}var rotationLL = function(node) { var tmp = node.left; node.left = tmp.right; tmp.right = node; return tmp;}var rotationLR = function(node) { node.left = rotationRR(node.left); return rotationLL(node);}var rotationRL = function(node) { node.right = rotationLL(node.right); return rotationRR(node);}var insertNode = function(node, element) { if (node === null) { node = new Node(element); } else if (element &lt; node.key) { node.left = insertNode(node.left, element); if (node.left !== null) { // ç¡®è®¤æ˜¯å¦éœ€è¦å¹³è¡¡ if ((heightNode(node.left) - heightNode(node.right) &gt; 1)) { if (element &lt; node.left.key) { node = rotationLL(node); } else { node = rotationLR(node); } } } } else if (element &gt; node.key) { node.right = insertNode(node.right, element); if (node.right !== null) { // ç¡®è®¤æ˜¯å¦éœ€è¦å¹³è¡¡ if ((heightNode(node.right) - heightNode(node.left) &gt; 1)) { if (element &gt; node.right.key) { node = rotationRR(node); } else { node = rotationRL(node); } } } } return node;} å›¾ å›¾æ˜¯ç½‘ç»œç»“æ„çš„æŠ½è±¡æ¨¡å‹ï¼Œå›¾æ˜¯ä¸€ç»„ç”±è¾¹è¿æ¥çš„èŠ‚ç‚¹ï¼ˆæˆ–é¡¶ç‚¹ï¼‰ã€‚å­¦ä¹ å›¾æ˜¯é‡è¦çš„ï¼Œå› ä¸ºä»»ä½•å…³ç³»éƒ½å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤º 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163function Graph() { var vertices = []; var adjList = new Dictionary(); this.addVertex = function(v) { vartices.push(v); adjList.set(v, []); }; this.addEdge = function(v, w) { addList.get(v).push(w); addList.get(w).push(v); }; this.toString = function() { var s = ''; for (var i = 0; i &lt; vertices.length; i++) { s += vertices[i] + ' -&gt; '; var neighbors = adjList.get(vertices[i]); for (var j = 0; j &lt; neighbors.length; j++) { s += neighbors[j] + ' '; } s += '\\n'; } return s; }; // å¹¿åº¦ä¼˜å…ˆæœç´¢ var initializeColor = function() { var color = []; for (var i = 0; i &lt; vertices.length; i++) { color[vertices[i]] = 'white'; } return color; }; this.bfs = function(v, callback) { var color = initializeColor(), queue = new Queue(); queue.enqueue(v); while (!queue.isEmpty()) { var u = queue.dequeue(), neighbors = adjList.get(u); color[u] = 'grey'; for (var i = 0; i &lt; neighbors.length; i++) { var w = neighbors[i]; if (color[w] === 'white') { color[w] = 'grey'; queue.enqueue(w); } } color[u] = 'black'; if (callback) { callback(); } } }; // ä½¿ç”¨BFSå¯»æ‰¾æœ€çŸ­è·¯å¾„ this.BFS = function(v) { var color = initializeColor(), queue = new Queue(), d = []; pred = []; queue.enqueue(v); for (var i = 0; i &lt; vertices.length; i++) { d[vertices[i]] = 0; pred[vertices[i]] = null; } while (!queue.isEmpty()) { var u = queue.dequeue(), neighbors = adjList.get(u); color[u] = 'grey'; for (i = 0; i &lt; neighbors.length; i++) { var w = neighbors[i]; if (color[w] === 'white') { color[w] = 'grey'; d[w] = d[u] + 1; pred[w] = u; queue.enqueue(w); } } color[u] = 'black'; } return { distances: d, predecessors: pred }; }; // æ·±åº¦ä¼˜å…ˆéå† var dfsVisit = function(u, color, callback) { color[u] = 'grey'; if (callback) { callback(u); } var neighbors = adjList.get(u); for (var i = 0; i &lt; neighbors.length; i++) { var w = neighbors[i]; if (color[w] === 'white') { dfsVisit(w, color, callback); } } color[u] = 'black'; }; this.dfs = function(callback) { var color = initializeColor(); for (var i = 0; i &lt; vertices.length; i++) { if (color[vertices[i]] === 'white') { dfsVisit(vertices[i], color, callback); } } }; // æ¢ç´¢æ·±åº¦ä¼˜å…ˆç®—æ³• var time = 0; this.DFS = function() { var color = nitializeColor(), d = [], f = [], p = [], time = 0; for (var i = 0; i &lt; vertices.length; i++) { f[vertices[i]] = 0; d[vertices[i]] = 0; p[vertices[i]] = null; } for (i = 0; i &lt; vertices.length; i++) { if (color[vertices[i]] === 'white') { DFSVisit(vertices[i], color, d, f, p); } } return { discovery: d, finished: f, predecessors: p }; }; var DFSVisit = function(u, color, d, f, p) { console.log('discovered ' + u); color[u] = 'grey'; d[u] = ++time; var neighbors = adjList.get(u); for (var i = 0; i &lt; neighbors.length; i++) { var w = neighbors[i]; if (color[w] === 'white') { p[w] = u; DFSVisit(w, color, d, f, p); } } color[u] = 'black'; f[u] = ++time; console.log('explored ' + u); };}","link":"/blog/2019/03/04/javascript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"title":"javaScriptæ’åºç®—æ³•å­¦ä¹ ç¬”è®°","text":"ç›´æ¥ä¸Šdemo 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196// ç”¨äºåˆ›å»ºæ•°ç»„function createNonSortedArray(size) { var array = new ArrayList(); for (var i = size; i &gt; 0; i--) { array.insert(i); } return array;}function ArrayList() { var array = []; this.insert = function(item) { console.log(item, 'insert'); array.push(item); }; this.toString = function() { console.log('tostring'); return array.join(); }; /* * å†’æ³¡æ’åº * å†’æ³¡æ’åºæ¯”è¾ƒä»»ä½•ä¸¤ä¸ªç›¸é‚»çš„é¡¹ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œåˆ™äº¤æ¢å®ƒä»¬ã€‚ * å…ƒç´ é¡¹å‘ä¸Šç§»åŠ¨è‡³æ­£ç¡®çš„é¡ºåºï¼Œå°±å¥½åƒæ°”æ³¡å‡è‡³è¡¨é¢ä¸€æ ·ï¼Œå†’æ³¡æ’åºå› æ­¤å¾—åã€‚ * ç¬¬ä¸€è½®æ¯”è¿‡ä¹‹åæœ€åä¸€ä¸ªå°±ä¸€å®šæ˜¯æœ€å¤§çš„ æ— éœ€å†æ¯”è¾ƒã€‚æ‰€ä»¥ä¸‹æ¬¡è¦ - i */ this.bubbleSort = function() { var length = array.length; for (var i = 0; i &lt; length; i++) { for (var j = 0; j &lt; length - 1 - i; j++) { if (array[j] &gt; array[j + 1]) { swap(array, j, j + 1); } } } }; /* * é€‰æ‹©æ’åº * é€‰æ‹©æ’åºç®—æ³•æ˜¯ä¸€ç§åŸå€æ¯”è¾ƒæ’åºç®—æ³•ã€‚é€‰æ‹©æ’åºå¤§è‡´çš„æ€è·¯æ˜¯æ‰¾åˆ°æ•°æ®ç»“æ„ä¸­çš„æœ€å°å€¼ * å¹¶å°†å…¶æ”¾ç½®åœ¨ç¬¬ä¸€ä½ï¼Œæ¥ç€æ‰¾åˆ°ç¬¬äºŒå°çš„å€¼å¹¶å°†å…¶æ”¾åœ¨ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ¯”å¦‚ï¼Œç¬¬ä¸€ä¸ª * çš„æ—¶å€™ï¼Œä¼šéå†åé¢æ‰€æœ‰æƒ³è·Ÿå…¶æ¯”è¾ƒï¼Œæ‰¾åˆ°æœ€å°çš„æ›´å…¶äº¤æ¢ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªæ­¤æ—¶ä¸€å®šæ˜¯æœ€å°çš„ã€‚ * éšæ„ç¬¬äºŒä¸ªçš„æ—¶å€™ï¼Œåªä¼šå¾ªç¯åé¢çš„å‡ ä¸ªã€‚å¦‚æœæ‰¾åˆ°ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªæ›´å°çš„ï¼Œé‚£ä¹ˆäº¤æ¢ä½ç½®ã€‚ */ this.selectionSort = function() { var length = array.length, indexMin; for (var i = 0; i &lt; length - 1; i++) { indexMin = i; for (var j = i; j &lt; length; j++) { if (array[indexMin] &gt; array[j]) { indexMin = j; } } if (i !== indexMin) { swap(array, i, indexMin); } } }; /* * æ’å…¥æ’åº * æ’å…¥æ’åºæ¯æ¬¡æ’ç¬¬ä¸€ä¸ªæ•°ç»„é¡¹ï¼Œä»¥æ­¤æ–¹å¼æ„å»ºæœ€åçš„æ’åºæ•°ç»„ã€‚å‡å®šç¬¬ä¸€é¡¹å·²ç»æ’åºäº†ï¼Œæ¥ç€ï¼Œ * å®ƒå’Œç¬¬äºŒé¡¹è¿›è¡Œæ¯”è¾ƒï¼Œç¬¬äºŒé¡¹æ˜¯åº”è¯¥å¾…åœ¨åŸä½è¿˜æ˜¯æ’åˆ°ç¬¬ä¸€é¡¹ä¹‹å‰å‘¢ï¼Ÿè¿™æ ·ï¼Œå¤´ä¸¤é¡¹å°±å·²æ­£ç¡® * æ’åºï¼Œæ¥ç€å’Œç¬¬ä¸‰é¡¹æ¯”è¾ƒï¼ˆå®ƒæ˜¯è¯¥æ’å…¥åˆ°ç¬¬ä¸€ã€ç¬¬äºŒè¿˜æ˜¯ç¬¬ä¸‰ä½ç½®å‘¢ï¼Ÿï¼‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚ * ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯éå†æ•°ç»„çš„æ¯ä¸€é¡¹ï¼Œæ‹¿è¿™ä¸€é¡¹å»è·Ÿå‰é¢çš„é¡¹æ¯”è¾ƒï¼Œå¦‚æœæ¯”ä»–å°å°±æ’å…¥åˆ°å®ƒå‰é¢ã€‚ */ this.insertionSort = function() { var length = array.length, j, temp; for (var i = 1; i &lt; length; i++) { j = i; temp = array[i]; while (j &gt; 0 &amp;&amp; array[j - 1] &gt; temp) { array[j] = array[j - 1]; j--; } array[j] = temp; } }; // å½’å¹¶æ’åº // å½’å¹¶æ’åºæ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ã€‚å…¶æ€æƒ³æ˜¯å°†åŸå§‹æ•°ç»„åˆ‡åˆ†æˆè¾ƒå°çš„æ•°ç»„ï¼Œç›´åˆ°æ¯ä¸ª // å°æ•°ç»„åªæœ‰ä¸€ä¸ªä½ç½®ï¼Œæ¥ç€å°†å°æ•°ç»„å½’å¹¶æˆè¾ƒå¤§çš„æ•°ç»„ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ’åºå®Œæ¯•çš„å¤§æ•°ç»„ã€‚ this.mergeSort = function() { array = mergeSortRec(array); }; var mergeSortRec = function(array) { var length = array.length; if (length === 1) { return array; } var mid = Math.floor(length / 2), left = array.slice(0, mid), right = array.slice(mid, length); return merge(mergeSortRec(left), mergeSortRec(right)); }; var merge = function(left, right) { var result = [], il = 0, ir = 0; // å®Œæˆä¸‹åˆ—æ“ä½œçš„å‰ææ˜¯leftã€rightæ•°ç»„å‡å·²ç»å®Œæˆã€‚æ‰€ä»¥é‡‡ç”¨é€’å½’çš„å½¢å¼ // åœ¨æ•°ç»„é•¿åº¦ä¸º1çš„æ—¶å€™å…ˆå¼€å§‹æ’åºï¼Œç„¶ååœ¨é€šè¿‡merge leftä¸rightæ•°ç»„ while (il &lt; left.length &amp;&amp; ir &lt; right.length) { if (left[il] &lt; right[ir]) { result.push(left[il++]); } else { result.push(right[ir++]); } } // ä¸Šé¢æ˜¯å°†leftä¸rightæ•°ç»„æ’å®Œåºï¼Œé‚£ä¹ˆå…¶ä¸­ä¹‹ä¸€æ•°ç»„å¿…ç„¶ä¸ºç©ºï¼Œ // ä¸‹é¢çš„æ“ä½œå°±æ˜¯å°†å‰©ä¸‹çš„rightæˆ–è€…leftå…¨éƒ¨æ¨å…¥resultæ•°ç»„ä¸­ while (il &lt; left.length) { result.push(left[il++]); } while (ir &lt; right.length) { result.push(right[ir++]); } return result; }; // å¿«é€Ÿæ’åº // é¦–å…ˆï¼Œä»æ•°ç»„ä¸­é€‰æ‹©ä¸­é—´ä¸€é¡¹ä½œä¸ºä¸»å…ƒ // åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆï¼Œå·¦è¾¹ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼Œå³è¾¹ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æœ€åä¸€ä¸ªé¡¹ã€‚ // ç§»åŠ¨å·¦æŒ‡é’ˆç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ¯”ä¸»å…ƒå¤§çš„å…ƒç´ ï¼Œæ¥ç€ï¼Œç§»åŠ¨å³æŒ‡é’ˆç›´åˆ°æ‰¾åˆ°ä¸€ä¸ª // æ¯”ä¸»å…ƒå°çš„å…ƒç´ ï¼Œç„¶åäº¤æ¢ä»–ä»¬ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å·¦æŒ‡é’ˆè¶…è¿‡å³æŒ‡é’ˆã€‚è¿™ä¸ª // è¿‡ç¨‹å°†ä½¿å¾—æ¯”ä¸»å…ƒå°çš„å€¼éƒ½æ’åœ¨ä¸»å…ƒä¹‹å‰ï¼Œè€Œæ¯”ä¸»å…ƒå¤§çš„å€¼éƒ½æ’åœ¨ä¸»å…ƒä¹‹åã€‚è¿™ä¸€æ­¥ // å«åšåˆ’åˆ†æ“ä½œã€‚ // æ¥ç€ï¼Œç®—æ³•å¯¹åˆ’åˆ†åçš„å°æ•°ç»„ï¼ˆè¾ƒä¸»å…ƒå°çš„å€¼ç»„æˆçš„å­æ•°ç»„ï¼Œä»¥åŠè¾ƒä¸»å…ƒå¤§çš„å€¼ // ç»„æˆçš„å­æ•°ç»„ï¼‰é‡å¤ä¹‹å‰çš„ä¸¤ä¸ªæ­¥éª¤ï¼Œç›´åˆ°æ•°ç»„å·²å®Œå…¨æ’åºã€‚ // ç®€è€Œè¨€ä¹‹ï¼Œå…ˆåˆ†æ²»ï¼Œä¸æ–­çš„ç»†åŒ–ä¸‹å»ï¼Œåˆ°æœ€åä¸€ä¸ªæ•°ç»„æ— æ³•å†äº¤æ¢ä½ç½®è¿›è¡Œæ’åºä½ç½® this.quickSort = function() { quick(array, 0, array.length - 1); }; var quick = function(array, left, right) { var index; if (array.length &gt; 1) { index = partition(array, left, right); if (left &lt; index - 1) { quick(array, left, index - 1); } if (index &lt; right) { quick(array, index, right); } } }; var partition = function(array, left, right) { var pivot = array[Math.floor((left + right) / 2)], i = left, j = right; while (i &lt;= j) { while (array[i] &lt; pivot) { i++; } while (array[j] &gt; pivot) { j--; } if (i &lt;= j) { swap(array, i, j); i++; j--; } } return i; }; var swap = function(array, index1, index2) { var aux = array[index1]; array[index1] = array[index2]; array[index2] = aux; };}var array = createNonSortedArray(9);console.log(array.toString());array.bubbleSort();// array.selectionSort();// array.insertionSort();// array.mergeSort();// array.quickSort();console.log(array.toString());","link":"/blog/2019/03/12/javaScript%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"title":"vue ssrä»è®¤è¯†åˆ°æ„å»ºä¸€ä¸ªå·¥ç¨‹é¡¹ç›®ï¼ˆä¸€ï¼‰","text":"vue ssr å…¥é—¨å‰è¨€è¿‘æœŸéœ€è¦æ¥æ‰‹ä¸€ä¸ª vue ssr é¡¹ç›®ï¼Œç”±äºæœ¬äººä¹‹å‰æ²¡æœ‰å†™è¿‡ ssrï¼Œåªæ˜¯ç¨å¾®äº†è§£äº†ç‚¹ã€‚æ‰€ä»¥è·Ÿç€å®˜ç½‘å­¦äº†ä¸‹ï¼Œå¹¶æ•´ç†å‡ºäº†è¿™ç¯‡å­¦ä¹ ç¬”è®°ã€‚æ–¹ä¾¿è‡ªå·±ä»¥åå¯¹ vue ssr çŸ¥è¯†çš„å›é¡¾ã€‚å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€‚ ä»‹ç»ç›¸ä¿¡å¤§å®¶åœ¨çœ‹åˆ°è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œéƒ½çŸ¥é“ ssr æ˜¯ä»€ä¹ˆäº†ã€‚SSRï¼Œè‹±æ–‡å…¨ç§°å« Server(æœåŠ¡) side(ç«¯) rendering (æ¸²æŸ“)å“ˆå“ˆ â˜º é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Ÿ Vue.js æ˜¯æ„å»ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¾“å‡º Vue ç»„ä»¶ï¼Œè¿›è¡Œç”Ÿæˆ DOM å’Œæ“ä½œ DOMã€‚ç„¶è€Œï¼Œä¹Ÿå¯ä»¥å°†åŒä¸€ä¸ªç»„ä»¶æ¸²æŸ“ä¸ºæœåŠ¡å™¨ç«¯çš„ HTML å­—ç¬¦ä¸²ï¼Œå°†å®ƒä»¬ç›´æ¥å‘é€åˆ°æµè§ˆå™¨ï¼Œæœ€åå°†è¿™äº›é™æ€æ ‡è®°â€æ¿€æ´»â€ä¸ºå®¢æˆ·ç«¯ä¸Šå®Œå…¨å¯äº¤äº’çš„åº”ç”¨ç¨‹åºã€‚ æœåŠ¡å™¨æ¸²æŸ“çš„ Vue.js åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯â€åŒæ„â€æˆ–â€é€šç”¨â€ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºçš„å¤§éƒ¨åˆ†ä»£ç éƒ½å¯ä»¥åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šè¿è¡Œã€‚ å¦‚æœä½ é—®æˆ‘ä¸ºä»€ä¹ˆä½¿ç”¨ ssr å‘¢ï¼Ÿ(å…·ä½“å¯å‚è€ƒå®˜ç½‘) æœ‰åˆ©äº seoã€‚ æ›´å¿«çš„å†…å®¹åˆ°è¾¾æ—¶é—´ (time-to-content),ç‰¹åˆ«æ˜¯å¯¹äºç¼“æ…¢çš„ç½‘ç»œæƒ…å†µæˆ–è¿è¡Œç¼“æ…¢çš„è®¾å¤‡ã€‚å¤§ä½“å¯ä»¥ç†è§£ä¸ºæ¸²æŸ“å‡ºé¡µé¢æ—¶é—´ï¼Œcsr æ¯” ssr å¤šäº†ä¸ª js ä¸‹è½½æ—¶é—´ã€‚å› ä¸º ssr ä¸€å¼€å§‹åŠ è½½ä¸‹æ¥å°±æ¸²æŸ“å‡ºæ¥äº†ï¼Œç„¶ååœ¨ä¸‹è½½æ¿€æ´» html çš„ jsã€‚csr æ˜¯ä¸‹è½½å®Œåœ¨æ¸²æŸ“ã€‚ æ­£æ–‡åŸºæœ¬ç”¨æ³•ssr ä¸»è¦ä¾é ä¸¤ä¸ªåŒ…vue-server-rendererå’Œ vue(ä¸¤ä¸ªç‰ˆæœ¬å¿…é¡»åŒ¹é…) å®‰è£…: npm install vue vue-server-renderer --save å…¥é—¨é…ç½®ssr æœ€ç®€æ˜“é…ç½®12345678910111213141516171819202122232425262728// server.jsconst server = require('express')();const Vue = require('vue');const renderer = require('vue-server-renderer').createRenderer();server.get('*', (req, res) =&gt; { const context = { url: req.url }; const app = new Vue({ template: `&lt;div&gt;${context.url}&lt;/div&gt;` }); renderer.renderToString(app, (err, html) =&gt; { if (err) { res.status(500).end('Internal Server Error'); return; } res.end(` &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt; &lt;body&gt;${html}&lt;/body&gt; &lt;/html&gt; `); });});server.listen(8080); node server.js æµè§ˆå™¨è¾“å…¥ localhost:8080 è®¿é—®è¯¥ ssr é¡µé¢ è¿™æ—¶å€™ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºä½ è¾“å…¥ä»€ä¹ˆè·¯å¾„ï¼Œé¡µé¢æ–‡æœ¬éƒ½ä¼šæ˜¾ç¤ºå‡ºä½ çš„è·¯å¾„ ssr ä½¿ç”¨æ¨¡æ¿å½“ä½ åœ¨æ¸²æŸ“ Vue åº”ç”¨ç¨‹åºæ—¶ï¼Œrenderer åªä»åº”ç”¨ç¨‹åºç”Ÿæˆ HTML æ ‡è®° (markup)ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»ç”¨ä¸€ä¸ªé¢å¤–çš„ HTML é¡µé¢åŒ…è£¹å®¹å™¨ï¼Œæ¥åŒ…è£¹ç”Ÿæˆçš„ HTML æ ‡è®°ã€‚çº¯å®¢æˆ·ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªæ¨¡æ¿ï¼Œä¼šæ’å…¥ä½ æ‰“åŒ…åçš„ä¸€äº›æ–‡ä»¶ç­‰ã€‚é‚£ä¹ˆ ssr ä¼šä¸ä¼šä¹Ÿæœ‰è¿™ç§æ¨¡æ¿å‘¢ï¼Ÿå½“ç„¶ä¼šæœ‰ã€‚ é¦–å…ˆåœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªindex.template.htmlæ–‡ä»¶ 123456789&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt; &lt;head&gt; &lt;title&gt;Hello&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;!--vue-ssr-outlet--&gt; &lt;/body&gt;&lt;/html&gt; æ³¨æ„äº† â€“è·Ÿ vue æˆ–è€… outlet è·Ÿâ€“ä¹‹é—´ä¸èƒ½ç”¨ç©ºæ ¼ã€‚æ³¨é‡Š â€“ è¿™é‡Œå°†æ˜¯åº”ç”¨ç¨‹åº HTML æ ‡è®°æ³¨å…¥çš„åœ°æ–¹ã€‚ æ¥ä¸‹æ¥ï¼Œä¿®æ”¹ä¸‹åˆšæ‰çš„ server.js æ–‡ä»¶åå¦‚ä¸‹ 12345678910111213141516171819202122const server = require('express')();const Vue = require('vue');const renderer = require('vue-server-renderer').createRenderer({ template: require('fs').readFileSync('./index.template.html', 'utf-8')});server.get('*', (req, res) =&gt; { const context = { url: req.url }; const app = new Vue({ template: `&lt;div&gt;${context.url}&lt;/div&gt;` }); renderer.renderToString(app, (err, html) =&gt; { if (err) { res.status(500).end('Internal Server Error'); return; } res.end(html); });});server.listen(8080); å°±æ˜¯åœ¨ createRenderer ä¸­å¤šåŠ ä¸€ä¸ªå‚æ•° template(è¯»å–æ¨¡æ¿æ–‡ä»¶)ï¼Œå¹¶ä¼ é€’ç»™ createRenderer æ–¹æ³• æ¨¡æ¿è¿˜æ”¯æŒæ’å€¼ 123456789101112&lt;html&gt; &lt;head&gt; &lt;!-- ä½¿ç”¨åŒèŠ±æ‹¬å·(double-mustache)è¿›è¡Œ HTML è½¬ä¹‰æ’å€¼(HTML-escaped interpolation) --&gt; &lt;title&gt;{{ title }}&lt;/title&gt; &lt;!-- ä½¿ç”¨ä¸‰èŠ±æ‹¬å·(triple-mustache)è¿›è¡Œ HTML ä¸è½¬ä¹‰æ’å€¼(non-HTML-escaped interpolation) --&gt; {{{ meta }}} &lt;/head&gt; &lt;body&gt; &lt;!--vue-ssr-outlet--&gt; &lt;/body&gt;&lt;/html&gt; æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ªâ€æ¸²æŸ“ä¸Šä¸‹æ–‡å¯¹è±¡â€ï¼Œä½œä¸º renderToString å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¥æä¾›æ’å€¼æ•°æ®ï¼š 123456789101112const context = { title: 'hello', meta: ` &lt;meta ...&gt; &lt;meta ...&gt; `};renderer.renderToString(app, context, (err, html) =&gt; { // é¡µé¢ title å°†ä¼šæ˜¯ \"Hello\" // meta æ ‡ç­¾ä¹Ÿä¼šæ³¨å…¥}); ç¼–å†™é€šç”¨ä»£ç æˆ‘ä»¬ä»¥å¾€çš„çº¯æµè§ˆå™¨æ¸²æŸ“éƒ½æ˜¯æŠŠ js ä¸‹è½½åˆ°æœ¬åœ°æ‰§è¡Œçš„ã€‚ä¸Šè¿°ä»£ç ä½ ä¼šå‘ç°éƒ½æ˜¯ç”¨çš„åŒä¸€ä¸ª Vue æ„é€ å‡½æ•°ï¼Œä½†æ˜¯æƒ³å¯¹è¯¥æ„é€ å‡½æ•°åšç‰¹æ®Šå¤„ç†æ—¶ï¼Œå°±ä¼šå¯¹å…¶ä»–ç”¨æˆ·é€ æˆæ±¡æŸ“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ç›´æ¥åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ï¼Œè€Œæ˜¯åº”è¯¥æš´éœ²ä¸€ä¸ªå¯ä»¥é‡å¤æ‰§è¡Œçš„å·¥å‚å‡½æ•°ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„åº”ç”¨ç¨‹åºå®ä¾‹ï¼š 123456789101112131415161718// ä¿®æ”¹åŸå…ˆä»£ç å¦‚ä¸‹-const Vue = require('vue');+const createApp = require('./app.js')- const app = new Vue({- template: `&lt;div&gt;${context.url}&lt;/div&gt;`- })+ const { app } = createApp(context)// æ–°å¢app.jsconst Vue = require('vue');module.exports = function createApp(context) { const app = new Vue({ template: `&lt;div&gt;${context.url}&lt;/div&gt;` }) return { app }} è¿™æ ·ï¼Œæ¯æ¬¡è®¿é—®è¯¥æœåŠ¡å™¨çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ vue å®ä¾‹ã€‚åŒæ ·çš„è§„åˆ™ä¹Ÿé€‚ç”¨äº routerã€store å’Œ event bus å®ä¾‹ã€‚ä½ ä¸åº”è¯¥ç›´æ¥ä»æ¨¡å—å¯¼å‡ºå¹¶å°†å…¶å¯¼å…¥åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œè€Œæ˜¯éœ€è¦åœ¨ createApp ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¹¶ä»æ ¹ Vue å®ä¾‹æ³¨å…¥ã€‚ å‚è€ƒVue SSR æŒ‡å— vue æœåŠ¡ç«¯æ¸²æŸ“ ssr å¸¦ä½ äº”æ­¥å­¦ä¼š Vue SSR","link":"/blog/2019/04/10/%E4%BB%8E%E8%AE%A4%E8%AF%86%E5%88%B0%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B7%A5%E7%A8%8B%E9%A1%B9%E7%9B%AE%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"webpack4å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰","text":"å‰è¨€è¿™æ˜¯æˆ‘èŠ±äº†å‡ ä¸ªæ˜ŸæœŸå­¦ä¹  webpack4 çš„å­¦ä¹ ç¬”è®°ã€‚å†…å®¹ä¸å¤Ÿç»†ï¼Œå› ä¸ºä¸€äº›ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ï¼Œå°±éšæ„å¸¦è¿‡äº†ã€‚å¸Œæœ›æ–‡ç« èƒ½ç»™å¤§å®¶å¸¦æ¥å¸®åŠ©ã€‚å¦‚æœ‰é”™è¯¯ï¼Œå¸Œæœ›åŠæ—¶æŒ‡å‡ºã€‚ä¾‹å­éƒ½åœ¨learn-webpackä»“åº“ä¸Šã€‚å¦‚æœä½ ä»ä¸­æœ‰æ‰€æ”¶è·çš„è¯ï¼Œå¸Œæœ›ä½ èƒ½ç»™æˆ‘çš„githubç‚¹ä¸ªstarã€‚ å°çŸ¥è¯†npm info webpack æŸ¥çœ‹ webpack çš„å†å²ç‰ˆæœ¬ä¿¡æ¯ç­‰npm init -y è·³è¿‡é‚£äº›é€‰é¡¹ï¼Œé»˜è®¤å…¨å±€å®‰è£…çš„webpack ï¼š webpack index.js æ‰“åŒ…é¡¹ç›®ä¸­å®‰è£…çš„webpackï¼šnpx webpack index.js æ‰“åŒ…scriptä¸­è„šæœ¬æ‰“åŒ… ï¼š npm run buildå‘½ä»¤è¡Œä¸­æ‰“åŒ…ï¼šnpx webpack index.js -o bundle.js å…¥å£æ˜¯index.js, å‡ºå£æ˜¯bundle.jswebpack4è®¾ç½®modeï¼šproduction ä¼šå‹ç¼©ä»£ç  development å°±ä¸å‹ç¼©ä»£ç æ‰“åŒ…outputé‡Œé¢[name].js loaderä¸­çš„nameå˜é‡ å…¶å®å°±æ˜¯entry:{main: index.js} ä¸­çš„key =&gt; main source-mapdevtool: source-mapsource-map: distæ–‡ä»¶å¤¹é‡Œä¼šå¤šç”Ÿæˆä¸ªmapåç¼€æ–‡ä»¶ï¼Œè¿™æ ·é¡µé¢æŠ¥é”™çš„æ—¶å€™ï¼Œç‚¹å‡»æŠ¥é”™åé¢çš„åœ°å€ï¼Œä¼šè·³è½¬åˆ°ä»£ç å†™çš„åœ°æ–¹ã€‚è€Œä¸ä¼šè·³è½¬åˆ°æ‰“åŒ…åçš„ä»£ç é‡Œã€‚inline-source-map: ä¸ä¼šæ–°ç”Ÿæˆ.map æ–‡ä»¶ï¼Œä¼šæ’å…¥åˆ°æ‰“åŒ…çš„æ–‡ä»¶åº•éƒ¨cheap-inline-source-map: å› ä¸ºinline-source-mapæŠ¥é”™ä¼šå‘Šè¯‰ä½ ç¬¬å‡ è¡Œç¬¬å‡ ä¸ªå­—ç¬¦ã€‚å‰é¢åŠ ä¸Šcheapçš„è¯ åªä¼šå‘Šè¯‰ä½ ç¬¬å‡ è¡Œcheap-module-inline-source-map: æœ¬æ¥ map åªä¼šæ˜ å°„æ‰“åŒ…å‡ºæ¥çš„ index.js è·Ÿä¸šåŠ¡ä»£ç ä¸­çš„å…³ç³»ã€‚ç¬¬ä¸‰æ–¹å¼•å…¥åº“æŠ¥é”™æ˜ å°„ä¸åˆ°ã€‚ä¸­é—´åŠ äº† module è¿™ä¸ªå‚æ•°å°±å¯ä»¥äº†ã€‚æ¯”å¦‚loaderä¹Ÿä¼šæœ‰source-mapå¼€å‘çš„æ—¶å€™å»ºè®®ä½¿ç”¨ï¼šcheap-module-eval-source-map,evalè¡¨ç¤ºä¸ä¼šç‹¬ç«‹ç”Ÿæˆ map æ–‡ä»¶ï¼Œè€Œæ˜¯æ‰“åŒ…è¿›ä»£ç é‡Œã€‚ä¸€èˆ¬developmentç¯å¢ƒç”¨ cheap-module-eval-source-mapproductionç¯å¢ƒç”¨cheap-module-source-map loader1234// style.cssbody { color: red;} å½“ä½ æƒ³ç»™é¡¹ç›®æ·»åŠ æ ·å¼çš„æ—¶å€™ï¼Œimport ./style.csså¯¼å…¥cssï¼Œå¹¶æ‰§è¡Œæ‰“åŒ…å‘½ä»¤çš„æ—¶å€™ã€‚é¡µé¢å¹¶æŠ¥é”™ 123ERROR in ./style.css 1:5Module parse failed: Unexpected token (1:5)You may need an appropriate loader to handle this file type. è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨loaderæ¥ç¼–è¯‘äº†ã€‚å®‰è£…:npm i style-loader css-loader -Dä¸ºä»€ä¹ˆè¿˜éœ€è¦å®‰è£…style-loaderå‘¢ï¼Ÿå› ä¸ºstyle-loaderä¼šå°†ä½ çš„æ ·å¼é€šè¿‡styleæ ‡ç­¾æ’å…¥åˆ°é¡µé¢ä¸­é…ç½®webpack.config.js 123456789101112131415161718// webpack.config.jsconst HtmlWebpackPlugin = require('html-webpack-plugin');module.exports = { mode: 'development', entry: './index.js', output: { filename: 'bundle.js' }, module: { rules: [ { test: /\\.css$/, use: ['style-loader', 'css-loader'] } ] }, plugins: [new HtmlWebpackPlugin()]}; ä¸Šé¢ä½¿ç”¨äº†HtmlWebpackPluginæ˜¯å› ä¸ºæˆ‘ç”¨å®ƒæ¥è‡ªåŠ¨ç”Ÿæˆindex.htmlæ–¹ä¾¿é¡µé¢è®¿é—® 1234// package.json\"scripts\": { \"build\": \"webpack --config webpack.config.js\"}, æ‰§è¡Œnpm run buildè¿›è¡Œæ‰“åŒ…ï¼Œè®¿é—®distç›®å½•ä¸‹çš„index.html,å¯ä»¥çœ‹åˆ°é¡µé¢æ˜¾ç¤ºæˆåŠŸã€‚loaderæ‰§è¡Œé¡ºåºæ˜¯ä»ä¸‹åˆ°ä¸Šï¼Œå³åˆ°å·¦ã€‚ webpack-dev-serverwebpack-dev-server webpack-dev-serverä¼šå¯¹ä½ çš„ä»£ç è¿›è¡Œæ‰“åŒ…ï¼Œå°†æ‰“åŒ…çš„å†…å®¹æ”¾åˆ°å†…å­˜é‡Œé¢ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨ç»™ä½ æ‰“åŒ…æ”¾è¿› dist é‡Œã€‚webpack â€”watché¡µé¢ä¼šåˆ·æ–°ä¸‹ï¼Œå†…å®¹ä¼šè‡ªåŠ¨æ›´æ–°webpack-dev-serverä¼šè‡ªåŠ¨æ›´æ–°å½“å‰é¡µé¢webpack-dev-server, ç°åœ¨çš„webpack-dev-serveræ¯”ä»¥å‰å¥½å¤šäº† vue-cli3 å’Œreactéƒ½æ˜¯ç”¨è¿™ä¸ªäº† 123456devServer: { contentBase: './dist', // æœ‰è¿™ä¸ªå°±å¤Ÿäº†ï¼Œ open: true, // è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ port: 8080, // ç«¯å£ä¸å¿…å¡« proxy: {'/api': http://localhost:3000}} å¯åŠ¨æœåŠ¡æ¥çƒ­æ›´æ–°npm install express webpack-dev-middleware -Dåœ¨outputä¸­æ·»åŠ publicPath 1234567891011121314const express = require('express');const webpack = require('webpack');const webpackDevMiddleWare = require('webpack-dev-middleware');const config = require('./webpack.config.js');const complier = webpack(config); // å¸®æˆ‘ä»¬åšç¼–è¯‘çš„ä¸œè¥¿ï¼Œwebpackä¼ å…¥configä¹‹åä¼šç”³è¯·ä¸€ä¸ªç¼–è¯‘å™¨app.use( webpackDevMiddleware(complier, { publicPath: config.output.publicPath // æ„æ€æ˜¯åªè¦æ–‡ä»¶æ”¹å˜äº†ï¼Œå°±é‡æ–°è¿è¡Œ }));const app = express();app.listen(3000, () =&gt; { console.log('server is running 3000');}); ç°åœ¨è¿™æ ·å­å†™å¤ªéº»çƒ¦äº†ï¼ˆvue-cli2 ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ã€‚å› ä¸ºä»¥å‰ç‰ˆæœ¬webpack-dev-serverè¿˜ä¸å¤Ÿå¼ºå¤§ï¼Œç°åœ¨ä¸ä¸€æ ·äº†ã€‚éå¸¸çš„å¼ºå¤§äº†ã€‚ Hot Module Replacement çƒ­æ›¿æ¢ï¼Œå°±æ˜¯ä¸ä¼šåˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚å½“ä¸ä½¿ç”¨çƒ­æ›´æ–°çš„æ—¶å€™ï¼Œæ“ä½œä¸€äº›åŠŸèƒ½ï¼Œæ–°å¢äº†ä¸‰ä¸ªå…ƒç´ ï¼Œä¿®æ”¹æ ·å¼é¡µé¢è‡ªåŠ¨åˆ·æ–°åï¼Œåˆšæ‰æ–°å¢çš„å…ƒç´ ä¼šæ¶ˆå¤±ã€‚å¦‚æœå¼€å¯äº†çƒ­æ›¿æ¢ï¼Œé‚£ä¹ˆåŸå…ˆçš„ dom ä¼šè¿˜åœ¨ã€‚ 123456789101112const webpack = require('webpack') // .... devServer: { contentBase: './dist', open: true, hot: true, hotOnly: true // ä»¥é˜²hotå¤±æ•ˆåï¼Œé¡µé¢è¢«åˆ·æ–°ï¼Œä½¿ç”¨è¿™ä¸ªï¼Œhotå¤±æ•ˆä¹Ÿä¸åˆ·æ–°é¡µé¢ }, // ... plugins: [ new webpack.HotModuleReplacementPlugin() ] 12345678import number from './number.js';if (module.hot) { // å¦‚æœçƒ­æ›´æ–°å­˜åœ¨ // ç›‘å¬çš„æ–‡ä»¶æ”¹å˜ï¼Œä¼šè§¦å‘åé¢çš„å›è°ƒæ–¹æ³• module.hot.accept('./number', () =&gt; { // dosomething });} ä¸ºä»€ä¹ˆä¿®æ”¹äº† css æ–‡ä»¶ä¸éœ€è¦å†™ module.hotã€‚è€Œå†™ js éœ€è¦å†™å‘¢ï¼Œå› ä¸º css-loader å·²ç»è‡ªåŠ¨å¸®ä½ å¤„ç†äº†ã€‚ babelåŸºæœ¬ç”¨æ³•å°†é«˜ç‰ˆæœ¬çš„ js ä»£ç è½¬æ¢æˆä½ç‰ˆæœ¬çš„ js ä»£ç ã€‚æ¯”å¦‚ ie æµè§ˆå™¨ä¸å…¼å®¹ es6ï¼Œéœ€è¦ä½¿ç”¨ babel æŠŠ es6 ä»£ç æŠŠ js è½¬æ¢æˆä½ç‰ˆæœ¬çš„ js ä»£ç ã€‚å®‰è£…ï¼šnpm install --save-dev babel-loader @babel/core 123module: { rules: [{ test: /\\.js$/, exclude: /node_modules/, loader: 'babel-loader' }];} babel-loaderå¹¶ä¸ä¼šå¸®åŠ©ä½ æŠŠ es6 è¯­æ³•è½¬æ¢æˆä½çº§çš„è¯­æ³•ã€‚å®ƒåªæ˜¯å¸®åŠ©æ‰“é€š webpack è·Ÿ babel ä¹‹é—´çš„è”ç³»ã€‚è½¬æ¢æˆ es5 çš„è¯­æ³•ï¼šå®‰è£…ï¼šnpm install @babel/preset-env --save-dev@babel/preset-envåŒ…å«äº† es6 è½¬æ¢æˆ es5 çš„æ‰€æœ‰è§„åˆ™ã€‚ 123456789101112module: { rules: [ { test: /\\.js$/, exclude: /node_modules/, loader: 'babel-loader', options: { presets: ['@babel/preset-env'] } } ];} å¦‚æœè¿˜éœ€è¦é™åˆ°æ›´ä½ç‰ˆæœ¬å°±å¾—ä½¿ç”¨babel-polyfillå®‰è£…ï¼šnpm install --save @babel/polyfillé¡µé¢é¡¶éƒ¨å¼•å…¥import &quot;@babel/polyfill&quot;;å°±å¯ä»¥å°†é«˜çº§ç‰ˆæœ¬è¯­æ³•è½¬æ¢æˆä½çº§è¯­æ³•ã€‚ä½†æ˜¯ç›´æ¥importä¼šè®©æ‰“åŒ…åçš„æ–‡ä»¶éå¸¸å¤§ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦å†é…ç½®webpack.config.jsuseBuiltIns 12345678910111213{ test: /\\.js$/, exclude: /node_modules/, loader: \"babel-loader\", options: { // \"presets\": [\"@babel/preset-env\"] // å½“ä½ åšbabel-polyfillå¾€æµè§ˆå™¨å¡«å……çš„æ—¶å€™ï¼Œæ ¹æ®ä¸šåŠ¡ä»£ç ç”¨åˆ°ä»€ä¹ˆåŠ ä»€ä¹ˆï¼Œå¹¶ä¸ä¼šå…¨éƒ¨å†™å…¥, // æ•°ç»„ä¸­ï¼Œåé¢çš„å¯¹è±¡æ˜¯å¯¹æ•°ç»„å‰é¢çš„babelåšé…ç½® \"presets\": [[\"@babel/preset-env\", { useBuiltIns: 'usage' }]] }} å¦‚æœå¼€å‘ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œç±»åº“ã€‚ä½¿ç”¨babel-polyfillä¼šæ³¨å…¥åˆ°å…¨å±€ï¼Œæ±¡æŸ“åˆ°å…¨å±€ç¯å¢ƒã€‚å®‰è£…ï¼šnpm install --save-dev @babel/plugin-transform-runtimeå®‰è£…ï¼šnpm install --save @babel/runtime 12345678{ test: /\\.js$/, exclude: /node_modules/, loader: \"babel-loader\", options: { \"plugins\": [\"@babel/plugin-transform-runtime\"] }} å½“ä½ è¦æ·»åŠ é…ç½®æ—¶ 1234567891011121314{ test: /\\.js$/, exclude: /node_modules/, loader: \"babel-loader\", options: { \"plugins\": [[\"@babel/plugin-transform-runtime\", { \"absoluteRuntime\": false, \"corejs\": false, \"helpers\": true, \"regenerator\": true, \"useESModules\": false }]] }} å¦‚æœä½ è¦å°† corejs èµ‹å€¼ä¸º 2å®‰è£…ï¼šnpm install --save @babel/runtime-corejs2 1234567891011121314{ test: /\\.js$/, exclude: /node_modules/, loader: \"babel-loader\", options: { \"plugins\": [[\"@babel/plugin-transform-runtime\", { \"absoluteRuntime\": false, \"corejs\": 2, \"helpers\": true, \"regenerator\": true, \"useESModules\": false }]] }} @babel/plugin-transform-runtimeä¸ä¼šæ±¡æŸ“åˆ°å…¨å±€ç¯å¢ƒã€‚å½“ babel é…ç½®éå¸¸å¤šçš„æ—¶å€™ï¼Œå¯ä»¥å°†ä»–ä»¬æ”¾åˆ°.babelrcæ–‡ä»¶é‡Œåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º.babelrcæ–‡ä»¶å°†optionsé‡Œçš„ä»£ç æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹ï¼š 123456789{ \"plugins\": [[\"@babel/plugin-transform-runtime\", { \"absoluteRuntime\": false, \"corejs\": 2, \"helpers\": true, \"regenerator\": true, \"useESModules\": false }]]} react ä¸­åº”ç”¨ babelå®‰è£…ï¼šnpm install --save-dev @babel/preset-reactå¾€åˆšåˆšçš„.babelrcæ–‡ä»¶ä¸­æ·»åŠ é…ç½® 123456789// presetså¯¹åº”ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœè¿™ä¸ªå€¼éœ€è¦åšé…ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼åœ¨åŒ…è£…è¿›ä¸€ä¸ªæ•°ç»„ï¼Œæ”¾åˆ°ç¬¬ä¸€é¡¹ï¼Œç¬¬äºŒé¡¹æ˜¯ä¸ªå¯¹è±¡ï¼Œç”¨äºæè¿°è¯¥babel{ \"presets\": [ [\"@babel/preset-env\", { \"useBuiltIns\": \"usage\" }], \"@babel/preset-react\" ]} æ³¨æ„ï¼šè½¬æ¢æ˜¯å…ˆä¸‹åä¸Šï¼Œå°±æ˜¯ä½¿ç”¨ preset-react è½¬æ¢ react ä»£ç ï¼Œå†ç”¨ preset-env å°† js ä»£ç è½¬æ¢ä¸º es5 ä»£ç ","link":"/blog/2019/05/15/webpack4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"webpack4å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰","text":"å‰è¨€è¿™æ˜¯æˆ‘èŠ±äº†å‡ ä¸ªæ˜ŸæœŸå­¦ä¹  webpack4 çš„å­¦ä¹ ç¬”è®°ã€‚å†…å®¹ä¸å¤Ÿç»†ï¼Œå› ä¸ºä¸€äº›ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ï¼Œå°±éšæ„å¸¦è¿‡äº†ã€‚å¸Œæœ›æ–‡ç« èƒ½ç»™å¤§å®¶å¸¦æ¥å¸®åŠ©ã€‚å¦‚æœ‰é”™è¯¯ï¼Œå¸Œæœ›åŠæ—¶æŒ‡å‡ºã€‚ä¾‹å­éƒ½åœ¨learn-webpackä»“åº“ä¸Šã€‚å¦‚æœä½ ä»ä¸­æœ‰æ‰€æ”¶è·çš„è¯ï¼Œå¸Œæœ›ä½ èƒ½ç»™æˆ‘çš„githubç‚¹ä¸ªstarã€‚ tree shakingä¸€ä¸ªæ¨¡å—é‡Œä¼šå¯¼å‡ºå¾ˆå¤šä¸œè¥¿ã€‚æŠŠä¸€ä¸ªæ¨¡å—é‡Œæ²¡æœ‰è¢«ç”¨åˆ°çš„ä¸œè¥¿éƒ½ç»™å»æ‰ã€‚ä¸ä¼šæŠŠä»–æ‰“åŒ…åˆ°å…¥å£æ–‡ä»¶é‡Œã€‚tree shaking åªæ”¯æŒ es6 çš„æ–¹å¼å¼•å…¥(import)ï¼Œä½¿ç”¨requireæ— æ³•ä½¿ç”¨tree shakingã€‚ webpackçš„developmentæ— æ³•ä½¿ç”¨tree shakingåŠŸèƒ½ã€‚é™¤éåœ¨æ‰“åŒ…çš„é…ç½®é‡ŒåŠ ä¸Š 1234// å¼€å‘ç¯å¢ƒéœ€è¦åŠ å¦‚ä¸‹ä»£ç optimization: { usedExports: true;} å½“ä½ éœ€è¦ import æŸä¸ªæ¨¡å—ï¼Œåˆä¸æƒ³tree shakingæŠŠä»–ç»™å¹²æ‰ï¼Œå°±éœ€è¦åœ¨ package.json é‡Œä¿®æ”¹sideEffectså‚æ•°ã€‚æ¯”å¦‚å½“ä½ import './console.js', import './index.css'ç­‰æ²¡æœ‰export(å¯¼å‡º)æ¨¡å—çš„æ–‡ä»¶ã€‚åˆä¸æƒ³tree shakingæŠŠå®ƒå¹²æ‰ã€‚ 1234// package.jsonsideEffects: ['./console.js', './index.css'];// åä¹‹sideEffects: false; åœ¨developmentç¯å¢ƒå³ä½¿ä½ ä½¿ç”¨tree shakingï¼Œå®ƒä¹Ÿä¸ä¼šæŠŠå…¶ä»–å¤šä½™çš„ä»£ç ç»™å¹²æ‰ã€‚ä»–åªä¼šåœ¨æ‰“åŒ…çš„æ–‡ä»¶é‡Œæ³¨æ˜æŸæ®µä»£ç æ˜¯ä¸è¢«ä½¿ç”¨çš„ã€‚ development å’Œ production åŒºåˆ«developmentä»£ç ä¸å‹ç¼©ï¼Œproductionä»£ç ä¼šå‹ç¼© çœç•¥â€¦â˜º webpack-merge reactå’Œvueéƒ½ä¼šåŒºåˆ†ç¯å¢ƒè¿›è¡Œä¸åŒçš„webpacké…ç½®,ä½†æ˜¯å®ƒä»¬ä¸€å®šä¼šæœ‰ç›¸åŒçš„éƒ¨åˆ†ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦é€šè¿‡ä½¿ç”¨webpack-mergeè¿›è¡ŒæŠ½ç¦»ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738// webpack.base.config.jsconst path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');module.exports = { mode: 'production', // mode: 'development', entry: './index.js', output: { filename: 'bundle.js', path: path.resolve(__dirname, './dist') }, module: { rules: [ { test: /\\.css$/, use: ['style-loader', 'css-loader'] } ] }, optimization: { usedExports: true }, plugins: [ new HtmlWebpackPlugin({ template: './index.html' }) ]};// webpack.dev.config.jsconst merge = require('webpack-merge');const baseConfig = require('./webpack.base.config');const devConfig = { mode: 'development'};module.exports = merge(baseConfig, devConfig); è¿™é‡Œå°±ä¸é‡å¤æŠŠproductionç¯å¢ƒåœ¨é…ç½®å‡ºæ¥äº†ï¼Œä¸»è¦ä»‹ç»ä¸‹webpack-mergeç”¨æ³•ã€‚ å®‰è£…npm i webpack-merge -D æ–°å»ºä¸€ä¸ªå…¬å…±çš„æ–‡ä»¶å¦‚ï¼šwebpack.base.config.js å°†developmentå’Œproductionä¸¤ä¸ªwebpacké…ç½®ç›¸åŒçš„æŠ½ç¦»åˆ°webpack.base.config.jsæ–‡ä»¶ä¸­ åœ¨ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­(å…·ä½“ä»£ç å¦‚ä¸Š) const merge = require('webpack-merge') const baseConfig = require('./webpack.base.config.js') module.exports = merge(baseConfig, devConfig) code splittingå’ŒsplitChunkså½“ä½ æŠŠæ‰€æœ‰çš„ä»£ç éƒ½æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œæ¯æ¬¡æ”¹ä¸€ä¸ªä»£ç éƒ½éœ€è¦é‡æ–°æ‰“åŒ…ã€‚ä¸”ç”¨æˆ·éƒ½è¦é‡æ–°åŠ è½½ä¸‹è¿™ä¸ª js æ–‡ä»¶ã€‚ä½†æ˜¯å¦‚æœä½ æŠŠä¸€äº›å…¬å…±çš„ä»£ç æˆ–ç¬¬ä¸‰æ–¹åº“æŠ½ç¦»å¹¶å•ç‹¬æ‰“åŒ…ã€‚é€šè¿‡ç¼“å­˜åŠ è½½ï¼Œä¼šåŠ å¿«é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚ å¼‚æ­¥åŠ è½½çš„ä»£ç ï¼Œwebpack ä¼šå•ç‹¬æ‰“åŒ…åˆ°ä¸€ä¸ª js æ–‡ä»¶ä¸­ åŒæ­¥åŠ è½½çš„ä»£ç æœ‰ä¸¤ç§æ–¹å¼ åŸå§‹ä»£ç  123import _ from 'lodash';console.log(666); æ‰“åŒ…åçš„æ–‡ä»¶ï¼š main.js 551 KiB main [emitted] mainå¯ä»¥çœ‹åˆ°ï¼Œwebpack å°†ä¸šåŠ¡ä»£ç è·Ÿ lodash åº“æ‰“åŒ…åˆ°ä¸€ä¸ª main.js æ–‡ä»¶äº† æ–¹æ³•ä¸€ï¼š åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ 12import _ from 'lodash';window._ = _; å°†æ–‡ä»¶æŒ‚è½½åˆ°windowå¯¹è±¡ä¸Š,è¿™æ ·å…¶ä»–åœ°æ–¹å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚ ç„¶ååœ¨ webpack é…ç½®æ–‡ä»¶ä¸­çš„ entry å¢åŠ ä¸€ä¸ªå…¥å£ä¸ºè¯¥æ–‡ä»¶ã€‚è®©è¯¥æ–‡ä»¶å•ç‹¬æ‰“åŒ…ã€‚ 123 Asset Size Chunks Chunk Nameslodash.js 551 KiB lodash [emitted] lodash main.js 3.79 KiB main [emitted] main æ–¹æ³•äºŒï¼š é€šè¿‡æ·»åŠ optimizationé…ç½®å‚æ•° optimization: ä¼šå°†è¯¸å¦‚lodashç­‰åº“æŠ½ç¦»æˆå•ç‹¬çš„chunk,è¿˜ä¼šå°†å¤šä¸ªæ¨¡å—å…¬ç”¨çš„æ¨¡å—æŠ½ç¦»æˆå•ç‹¬çš„chunk 12345optimization: { splitChunks: { chunks: 'all' }}, æ‰“åŒ…åæ–‡ä»¶ï¼š 123 Asset Size Chunks Chunk Names main.js 6.78 KiB main [emitted] mainvendors~main.js 547 KiB vendors~main [emitted] vendors~main å¯ä»¥çœ‹åˆ°ï¼Œwebpack å°† lodash æŠ½æˆå…¬å…±çš„ chunk æ‰“åŒ…å‡ºæ¥äº†ã€‚ splitChunksé‡Œé¢è¿˜å¯ä»¥åœ¨æ·»åŠ ä¸ªå‚æ•°cacheGroups 1234567891011121314optimization: { splitChunks: { chunks: 'all', cacheGroups: { // ä¸‹é¢çš„æ„æ€æ˜¯ï¼šå°†ä»node_modulesä¸­å¼•å…¥çš„æ¨¡å—ç»Ÿä¸€æ‰“åŒ…åˆ°ä¸€ä¸ªvendors.jsæ–‡ä»¶ä¸­ vendors: { test: /[\\\\/]node_modules[\\\\/]/, priority: -10, filename: 'vendors.js' }, default: false } }} cacheGroupsä¸­vendorsé…ç½®è¡¨ç¤ºå°†ä»node_modulesä¸­å¼•å…¥çš„æ¨¡å—ç»Ÿä¸€æ‰“åŒ…åˆ°ä¸€ä¸ª vendors.js æ–‡ä»¶ä¸­ splitChunksçš„vendorsçš„defaultå‚æ•°ï¼š æ ¹æ®ä¸Šä¸‹æ–‡æ¥è§£é‡Šï¼Œå¦‚ä¸Šé…ç½®äº†vendorsï¼Œæ‰“åŒ…node_modulesæ–‡ä»¶å¤¹ä¸­çš„æ¨¡å—ï¼Œ é‚£ä¹ˆdefaultå°†ä¼šæ‰“åŒ…è‡ªå·±ç¼–å†™çš„å…¬å…±æ–¹æ³•ã€‚ å½“ä¸ä½¿ç”¨defaulté…ç½®æ—¶ã€‚ 123 Asset Size Chunks Chunk Namesmain.js 315 KiB main [emitted] maintest.js 315 KiB test [emitted] test æ·»åŠ å¦‚ä¸‹é…ç½®ä¹‹åï¼š 12345678910111213141516171819optimization: { splitChunks: { chunks: 'all', cacheGroups: { // ä¸‹é¢çš„æ„æ€æ˜¯ï¼šå°†ä»node_modulesä¸­å¼•å…¥çš„æ¨¡å—ç»Ÿä¸€æ‰“åŒ…åˆ°ä¸€ä¸ªvendors.jsæ–‡ä»¶ä¸­ vendors: { test: /[\\\\/]node_modules[\\\\/]/, priority: -10, filename: 'vendors.js' }, // æ‰“åŒ…é™¤ä¸Šé¢vendorsä»¥å¤–çš„å…¬å…±æ¨¡å— default: { priority: -20, reuseExistingChunks: true, // å¦‚æœè¯¥chunkå·²ç»è¢«æ‰“åŒ…è¿›å…¶ä»–æ¨¡å—äº†ï¼Œè¿™é‡Œå°±å¤ç”¨äº†ï¼Œä¸æ‰“åŒ…è¿›common.jsäº† filename: 'common.js' } } }} æ‰“åŒ…åçš„æ–‡ä»¶ä½“ç§¯ä¸º 1234 Asset Size Chunks Chunk Namescommon.js 308 KiB default~main~test [emitted] default~main~test main.js 7.03 KiB main [emitted] main test.js 7.02 KiB test [emitted] test é…ç½®è¯´æ˜ 12345678910splitChunks: { chunk: 'all', // all(å…¨éƒ¨)ï¼Œ async(å¼‚æ­¥çš„æ¨¡å—)ï¼Œinitial(åŒæ­¥çš„æ¨¡å—) minSize: 3000, // è¡¨ç¤ºæ–‡ä»¶å¤§äº3000kçš„æ—¶å€™æ‰å¯¹ä»–è¿›è¡Œæ‰“åŒ… maxSize: 0, minChunks: 1, // å½“æŸä¸ªæ¨¡å—æ»¡è¶³minChunkså¼•ç”¨æ¬¡æ•°æ—¶ï¼Œæ‰ä¼šè¢«æ‰“åŒ…ã€‚ä¾‹å¦‚,lodashåªè¢«ä¸€ä¸ªæ–‡ä»¶importï¼Œé‚£ä¹ˆlodashå°±ä¸ä¼šè¢«code splitting,lodashå°†ä¼šè¢«æ‰“åŒ…è¿› è¢«å¼•å…¥çš„é‚£ä¸ªæ–‡ä»¶ä¸­ã€‚å¦‚æœæ»¡è¶³minChunkså¼•ç”¨æ¬¡æ•°ï¼Œlodashä¼šè¢«å•ç‹¬æŠ½ç¦»å‡ºæ¥ï¼Œæ‰“å‡ºä¸€ä¸ªchunkã€‚ maxAsyncRequests: 5, // åœ¨æ‰“åŒ…æŸä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œæœ€å¤šåˆ†æˆ5ä¸ªchunkï¼Œå¤šä½™çš„ä¼šåˆåˆ°æœ€åä¸€ä¸ªchunkä¸­ã€‚è¿™é‡Œåˆ†æä¸‹è¿™ä¸ªå±æ€§è¿‡å¤§è¿‡å°å¸¦æ¥çš„é—®é¢˜ã€‚å½“è®¾ç½®çš„è¿‡å¤§æ—¶ï¼Œæ¨¡å—è¢«æ‹†çš„å¤ªç»†ï¼Œé€ æˆå¹¶å‘è¯·æ±‚å¤ªå¤šã€‚å½±å“æ€§èƒ½ã€‚å½“è®¾ç½®è¿‡å°æ—¶ï¼Œæ¯”å¦‚1ï¼Œå…¬å…±æ¨¡å—æ— æ³•è¢«æŠ½ç¦»æˆå…¬å…±çš„chunkã€‚æ¯ä¸ªæ‰“åŒ…å‡ºæ¥çš„æ¨¡å—éƒ½ä¼šæœ‰å…¬å…±chunk automaticNameDelimiter: '~', // å½“vendorsæˆ–è€…defaultä¸­çš„filenameä¸å¡«æ—¶ï¼Œæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åå°±ä¼šå¸¦~ name: true, cashGroups: {} // å¦‚ä¸Š} maxAsyncRequests Lazy Loadingå¼‚æ­¥importçš„åŒ…ä¼šè¢«å•ç‹¬æ‰“æˆä¸€ä¸ªchunk 1234567891011async function getComponent() { const { default: _ } = await import(/* webpackChunkNanem:'lodash */ 'lodash'); const element = document.createElement('div'); element.innerHTML = _.join(['Dell', 'Lee'], '-'); return element;}document.addEventListener('click', () =&gt; { getComponent().then(element =&gt; { document.body.appendChild(element); });}); lazy loading chunkæ¯ä¸€ä¸ªjsæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªchunk chunkæ˜¯ä½¿ç”¨Webpackè¿‡ç¨‹ä¸­æœ€é‡è¦çš„å‡ ä¸ªæ¦‚å¿µä¹‹ä¸€ã€‚åœ¨ Webpack æ‰“åŒ…æœºåˆ¶ä¸­ï¼Œç¼–è¯‘çš„æ–‡ä»¶åŒ…æ‹¬ entryï¼ˆå…¥å£ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªèµ„æºåˆå¹¶è€Œæˆï¼Œç”± html é€šè¿‡ script æ ‡ç­¾å¼•å…¥ï¼‰å’Œ chunkï¼ˆè¢« entry æ‰€ä¾èµ–çš„é¢å¤–çš„ä»£ç å—ï¼ŒåŒæ ·å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶ï¼‰ã€‚ä»é¡µé¢åŠ é€Ÿçš„è§’åº¦æ¥è®²ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å°†æ‰€æœ‰çš„ js æ‰“åŒ…åˆ°ä¸€ä¸ª bundle.js ä¹‹ä¸­ï¼Œä½†æ˜¯æ€»ä¼šæœ‰ä¸€äº›åŠŸèƒ½æ˜¯ä½¿ç”¨è¿‡ç¨‹ä¸­æ‰ä¼šç”¨åˆ°çš„ã€‚å‡ºäºæ€§èƒ½ä¼˜åŒ–çš„éœ€è¦ï¼Œå¯¹äºè¿™éƒ¨åˆ†èµ„æºæˆ‘ä»¬å¯ä»¥åšæˆæŒ‰éœ€åŠ è½½ã€‚ æ‰“åŒ…åˆ†ææ‰“åŒ…åˆ†æï¼š å®‰è£…ï¼šnpm install --save-dev webpack-bundle-analyzer 123// package.json =&gt; scripts\"analyz\": \"NODE_ENV=production npm_config_report=true npm run build\" 12345// webpack.config.jsconst BundleAnalyzerPlugin = require('webpack-bundle-analyzer') .BundleAnalyzerPlugin;plugins: [new BundleAnalyzerPlugin()]; æ‰§è¡Œå‘½ä»¤npm run analyz æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨æ‰“å¼€localhost:8888ï¼Œåˆ†æå›¾å°±ä¼šå±•ç°åœ¨ä½ çœ¼å‰ éå¸¸æ¸…æ™°ç›´è§‚çš„çœ‹å‡º ![image-20190421142354243](/Users/zhouatie/Library/Application Support/typora-user-images/image-20190421142354243.png) CSS æ–‡ä»¶çš„ä»£ç åˆ†å‰²æˆ‘ä»¬ä¹‹å‰å†™çš„ css æ–‡ä»¶éƒ½ä¼šè¢«æ‰“åŒ…è¿› js æ–‡ä»¶ä¸­ï¼Œè¦æƒ³æŠŠ css å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ª css æ–‡ä»¶è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°MiniCssExtractPlugin å¼€å‘ç¯å¢ƒç”¨ä¸åˆ°è¿™ä¸ªåŠŸèƒ½ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ å®‰è£…ï¼šnpm install --save-dev mini-css-extract-plugin 123456789101112131415161718192021222324252627282930313233343536// webpack.config.jsconst MiniCssExtractPlugin = require('mini-css-extract-plugin')module: { rules: [ { test: /\\.css$/, use: [{ loader: MiniCssExtractPlugin.loader, options: { // å¯ä»¥åœ¨æ­¤å¤„æŒ‡å®špublicPath // é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåœ¨webpackoptions.outputä¸­ä½¿ç”¨publicPath publicPath: '../', // hmr: process.env.NODE_ENV === 'development', }, }, 'css-loader'] } ]},plugins: [ new MiniCssExtractPlugin({ // ä¸webpackoptions.outputä¸­ç›¸åŒé€‰é¡¹ç±»ä¼¼çš„é€‰é¡¹ // ä¸¤ä¸ªé€‰é¡¹éƒ½æ˜¯å¯é€‰çš„ filename: '[name].css', chunkFilename: '[id].css', }),]// index.jsimport './index.css';console.log('haha')// index.cssbody { background: green;} è¿™æ ·æ‰“åŒ…ä¹‹åï¼Œcss ä¼šè¢«å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ª css æ–‡ä»¶ã€‚ ç¼“å­˜ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹å†…å®¹ï¼Œæ‰“åŒ…å‡ºå»åçš„æ–‡ä»¶åéƒ½ä¸å˜ã€‚çº¿ä¸Šç¯å¢ƒçš„æ–‡ä»¶æ˜¯æœ‰ç¼“å­˜çš„ã€‚æ‰€ä»¥å½“ä½ æ–‡ä»¶åä¸å˜çš„è¯ï¼Œæ›´æ–°å†…å®¹æ‰“åŒ…ä¸Šçº¿ã€‚æœ‰ç¼“å­˜çš„ç”µè„‘å°±æ— æ³•è·å–åˆ°æœ€æ–°çš„ä»£ç ã€‚ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ä¼šç”¨åˆ°contenthash æˆ‘ä»¬å…ˆè®°å½•é…ç½®contenthashä¹‹å‰æ‰“åŒ…çš„æ–‡ä»¶åã€‚ 123 Asset Size Chunks Chunk Namesindex.html 180 bytes [emitted] main.js 3.81 KiB main [emitted] main æ¥ä¸‹æ¥æˆ‘ä»¬æ¥é…ç½®ä¸‹contenthash (å°±æ˜¯æ ¹æ®ä½ æ–‡ä»¶å†…å®¹ç”Ÿæˆçš„ hash å€¼) 12345// webpack.config.jsoutput: { path: path.resolve(__dirname, '../dist'), filename: '[name][contenthash].js'}, æ‰“åŒ…å®Œä¹‹åä¼šåœ¨mainåé¢æ¥ä¸Šhashå€¼ã€‚ 123 Asset Size Chunks Chunk Names index.html 200 bytes [emitted]mainf5faa2d3d1e119256290.js 3.81 KiB main [emitted] main å½“ä½ ä¸æ›´æ–°å†…å®¹é‡æ–°æ‰“åŒ…åï¼Œcontenthashè¿˜ä¼šç»´æŒä¸å˜ã€‚æ‰€ä»¥çº¿ä¸Šç”¨æˆ·è®¿é—®çš„æ—¶å€™å°±ä¸ä¼šå»æœåŠ¡å™¨é‡æ–°æ‹¿å–ä»£ç ï¼Œè€Œæ˜¯ä»ç¼“å­˜ä¸­å–æ–‡ä»¶ã€‚ shimming (é¢„ç½®ä¾èµ–)ä»¥jqueryä¸ºä¾‹ï¼Œä»£ç å¦‚ä¸‹ 12345678910// index.jsimport $ from 'jquery';$('body').html('HHAHAH');import func from './test.js';func();// test.jsexport default function func() { $('body').append('&lt;h1&gt;2&lt;/h1&gt;');} å½“ä½ ä¸åœ¨ test.js ä¸­å¼•å…¥import $ from 'jquery' é‚£ä¹ˆæµè§ˆå™¨è®¿é—®çš„æ—¶å€™ï¼Œä¼šæŠ¥ test.js:5 Uncaught ReferenceError: $ is not defined è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨å«ç‰‡åŠŸèƒ½ 1234567const webpack = require('webpack');plugins: [ new webpack.ProvidePlugin({ $: 'jquery' })]; å½“ä½ åŠ ä¸Šè¿™æ®µä»£ç åï¼Œæ¨¡å—åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œå‘ç°ä½ ä½¿ç”¨äº†$å°±ä¼šåœ¨ä½ æ¨¡å—é¡¶éƒ¨è‡ªåŠ¨åŠ å…¥import $ from 'jquery' å…¶ä»–å…³äºshimmingçš„å†…å®¹å‚è€ƒwebpackå®˜ç½‘ shimming","link":"/blog/2019/05/15/webpack4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"},{"title":"webpack4å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰","text":"å‰è¨€è¿™æ˜¯æˆ‘èŠ±äº†å‡ ä¸ªæ˜ŸæœŸå­¦ä¹  webpack4 çš„å­¦ä¹ ç¬”è®°ã€‚å†…å®¹ä¸å¤Ÿç»†ï¼Œå› ä¸ºä¸€äº›ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ï¼Œå°±éšæ„å¸¦è¿‡äº†ã€‚å¸Œæœ›æ–‡ç« èƒ½ç»™å¤§å®¶å¸¦æ¥å¸®åŠ©ã€‚å¦‚æœ‰é”™è¯¯ï¼Œå¸Œæœ›åŠæ—¶æŒ‡å‡ºã€‚ä¾‹å­éƒ½åœ¨learn-webpackä»“åº“ä¸Šã€‚å¦‚æœä½ ä»ä¸­æœ‰æ‰€æ”¶è·çš„è¯ï¼Œå¸Œæœ›ä½ èƒ½ç»™æˆ‘çš„githubç‚¹ä¸ªstarã€‚ libraryå½“ä½ è¦å¼€å‘ç¬¬ä¸‰æ–¹åº“ä¾›åˆ«äººä½¿ç”¨æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ°libraryå’ŒlibraryTargetè¿™ä¸¤ä¸ªé…ç½®äº†ã€‚ library 12345output: { filename: 'library.js', library: 'library', libraryTarget: 'umd'}, library: å½“é…ç½®äº†è¿™ä¸ªlibraryå‚æ•°åï¼Œä¼šæŠŠlibraryè¿™ä¸ªkeyå¯¹åº”çš„valueå³ä¸Šé¢ä»£ç libraryæŒ‚è½½åˆ°å…¨å±€ä½œç”¨åŸŸä¸­ã€‚htmlç”¨scriptæ ‡ç­¾å¼•å…¥ï¼Œå¯ä»¥é€šè¿‡è®¿é—®å…¨å±€å˜é‡libraryè®¿é—®åˆ°æˆ‘ä»¬è‡ªå·±å¼€å‘çš„åº“ã€‚ libraryTarget:è¿™ä¸ªé»˜è®¤å€¼ä¸ºvarã€‚æ„æ€å°±æ˜¯è®© library å®šä¹‰çš„å˜é‡æŒ‚è½½åˆ°å…¨å±€ä½œç”¨åŸŸä¸‹ã€‚å½“ç„¶è¿˜æœ‰æµè§ˆå™¨ç¯å¢ƒçš„window,nodeç¯å¢ƒçš„global,umdç­‰ã€‚å½“è®¾ç½®äº†windowã€global,libraryå°±ä¼šæŒ‚è½½åˆ°è¿™ä¸¤ä¸ªå¯¹è±¡ä¸Šã€‚å½“é…ç½®äº†umdåï¼Œä½ å°±å¯ä»¥é€šè¿‡import,requireç­‰æ–¹å¼å¼•å…¥äº†ã€‚ externals exteralsæ˜¯å¼€å‘å…¬å…±åº“å¾ˆé‡è¦çš„ä¸€ä¸ªé…ç½®ã€‚å½“ä½ çš„å…¬å…±åº“å¼•å…¥äº†ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œå…¬å…±åº“ä¼šæŠŠè¯¥ç¬¬ä¸‰æ–¹åº“ä¹Ÿæ‰“åŒ…è¿›ä½ çš„æ¨¡å—é‡Œã€‚å½“ä½¿ç”¨è€…ä¹Ÿå¼•å…¥äº†è¿™ä¸ªç¬¬ä¸‰æ–¹åº“åï¼Œè¿™ä¸ªæ—¶å€™æ‰“åŒ…å°±ä¼šåˆæ‰“äº†ä¸€ä»½ç¬¬ä¸‰æ–¹åº“è¿›æ¥ã€‚ æ‰€åœ¨åœ¨å…¬å…±æ¨¡å—åº“ä¸­é…ç½®å¦‚ä¸‹ä»£ç  12345externals: { // å‰é¢çš„lodashæ˜¯æˆ‘çš„åº“é‡Œå¼•å…¥çš„åŒ…å æ¯”å¦‚ import _ from 'lodash' // åé¢çš„lodashæ˜¯åˆ«äººä¸šåŠ¡ä»£ç éœ€è¦æ³¨å…¥åˆ°ä»–è‡ªå·±æ¨¡å—çš„lodash æ¯”å¦‚ import lodash from 'lodash',æ³¨æ„ä¸èƒ½import _ from 'lodash',å› ä¸ºé…ç½®é¡¹å†™äº†lodash å°±ä¸èƒ½import _ lodash: 'lodash'}, å‰é¢çš„lodashæ˜¯æˆ‘çš„åº“é‡Œå¼•å…¥çš„åŒ…å æ¯”å¦‚import _ from 'lodash',åé¢çš„lodashæ˜¯åˆ«äººä¸šåŠ¡ä»£ç éœ€è¦æ³¨å…¥åˆ°ä»–è‡ªå·±æ¨¡å—çš„lodash æ¯”å¦‚ import lodash from 'lodash',æ³¨æ„ä¸èƒ½import _ from 'lodash',å› ä¸ºé…ç½®é¡¹å†™äº†lodash å°±ä¸èƒ½import _ã€‚ æœ¬äººåšäº†ä¸ªè¯•éªŒï¼Œå½“è‡ªå·±å¼€å‘çš„åŒ…ä¸å¼•å…¥lodash,ä¸šåŠ¡ä»£ç ä¸­ä¹Ÿä¸å¼•å…¥lodash,é‚£ä¹ˆæ‰“åŒ…ä¸šåŠ¡ä»£ç çš„æ—¶å€™ï¼Œwebpackä¼šæŠŠlodashæ‰“è¿›ä½ ä¸šåŠ¡ä»£ç åŒ…é‡Œã€‚ å½“ç„¶externals,é…ç½®è¿˜æœ‰å¤šç§å†™æ³•ï¼Œå¦‚ä¸‹ 123456789101112externals: { lodash: { commonjs: 'lodash', commonjs2: 'lodash', amd: 'lodash', root: '_' }}externals: ['lodash', 'jquery']externals: 'lodash' å…·ä½“è¯·å‚è€ƒå®˜ç½‘externals å‘å¸ƒè‡ªå·±å¼€å‘çš„ npm åŒ…å­¦äº†ä¸Šé¢çš„é…ç½®åï¼Œå°±éœ€è¦å­¦ä¹ ä¸‹å¦‚ä½•å°†è‡ªå·±çš„åŒ…å‘å¸ƒåˆ°npmä»“åº“ä¸Šäº†ã€‚ package.json çš„å…¥å£è¦æ”¹æˆdistç›®å½•ä¸‹çš„ js æ–‡ä»¶å¦‚ï¼š &quot;main&quot;: &quot;./dist/library.js&quot; æ³¨å†Œ npm è´¦å·ã€‚npm ä¼šå‘é€ä¸€ä»½é‚®ä»¶åˆ°ä½ çš„é‚®ç®±ä¸Šï¼Œç‚¹å‡»ä¸‹é‡Œé¢çš„é“¾æ¥è¿›è¡Œæ¿€æ´»ã€‚ å‘½ä»¤è¡Œè¾“å…¥npm login è¿›è¡Œç™»å½•ï¼Œæˆ–è€…npm adduser æ·»åŠ è´¦å· npm publish å½“å‡ºç°å¦‚ä¸‹æç¤ºä»£è¡¨å‘å¸ƒæˆåŠŸ 123// å½“å‡ºç°ç±»ä¼¼å¦‚ä¸‹ä»£ç æ—¶ï¼Œè¡¨ç¤ºä½ å·²ç»å‘å¸ƒæˆåŠŸâœ library git:(master) âœ— npm publish+ atie-first-module-library@1.0.0 é‡åˆ°çš„é—®é¢˜ï¼š å½“ä½ é‡åˆ°npm ERR! you must verify your email before publishing a new packageè¯´æ˜ä½ è¿˜æ²¡æœ‰æ¿€æ´»ä½ çš„é‚®ç®±ï¼Œå»é‚®ç®±é‡Œç‚¹å‡»ä¸‹é“¾æ¥æ¿€æ´»ä¸‹å°± ok äº† å½“ä½ å·²ç»ç™»å½•äº†æé†’npm ERR! 404 unauthorized Login first,è¿™ä¸ªæ—¶å€™ä½ å°±è¦æ³¨æ„ä¸‹ä½ çš„npmæºäº†ï¼Œçœ‹çœ‹æ˜¯å¦è®¾ç½®äº†æ·˜å®æºç­‰ã€‚è®°å¾—è®¾ç½®å›æ¥npm config set registry https://registry.npmjs.org/ PWAhttp-server workbox-webpack-plugin ç›¸ä¿¡å¾ˆå¤šæœ‹å‹éƒ½æœ‰è€³é—»è¿‡PWAè¿™é—¨æŠ€æœ¯,PWAæ˜¯Progressive Web Appçš„è‹±æ–‡ç¼©å†™ï¼Œ ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ¸è¿›å¼å¢å¼º WEB åº”ç”¨ï¼Œ æ˜¯ Google åœ¨ 2016 å¹´æå‡ºçš„æ¦‚å¿µï¼Œ2017 å¹´è½åœ°çš„ web æŠ€æœ¯ã€‚ç›®çš„å°±æ˜¯åœ¨ç§»åŠ¨ç«¯åˆ©ç”¨æä¾›çš„æ ‡å‡†åŒ–æ¡†æ¶ï¼Œåœ¨ç½‘é¡µåº”ç”¨ä¸­å®ç°å’ŒåŸç”Ÿåº”ç”¨ç›¸è¿‘çš„ç”¨æˆ·ä½“éªŒçš„æ¸è¿›å¼ç½‘é¡µåº”ç”¨ã€‚ ä¼˜ç‚¹ï¼š å¯é  å³ä½¿åœ¨ä¸ç¨³å®šçš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¹Ÿèƒ½ç¬é—´åŠ è½½å¹¶å±•ç° å¿« å¿«é€Ÿå“åº”ï¼Œå¹¶ä¸” åŠ¨ç”»å¹³æ»‘æµç•… åº”ç”¨åœºæ™¯ï¼š å½“ä½ è®¿é—®æ­£å¸¸è¿è¡Œçš„æœåŠ¡å™¨é¡µé¢çš„æ—¶å€™ï¼Œé¡µé¢æ­£å¸¸åŠ è½½ã€‚å¯å½“ä½ æœåŠ¡å™¨æŒ‚äº†çš„æ—¶å€™ï¼Œé¡µé¢å°±æ— æ³•æ­£å¸¸åŠ è½½äº†ã€‚ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ° pwa æŠ€æœ¯äº†ã€‚ è¿™é‡Œæˆ‘ç¼–å†™æœ€ç®€å•çš„ä»£ç é‡ç°ä¸‹åœºæ™¯ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940// webpack.config.jsconst HtmlWebpackPlugin = require('html-webpack-plugin')const CleanWebpackPlugin = require('clean-webpack-plugin')module.exports = { mode: 'production', entry: './index.js', output: { filename: 'bundle.js' }, plugins: [ new CleanWebpackPlugin(), new HtmlWebpackPlugin() ]}// index.jsconsole.log('this is outer console')// package.json{ \"name\": \"PWA\", \"version\": \"1.0.0\", \"description\": \"\", \"main\": \"index.js\", \"scripts\": { \"build\": \"webpack --config webpack.config.js\", \"start\": \"http-server ./dist\" }, \"keywords\": [], \"author\": \"\", \"license\": \"ISC\", \"devDependencies\": { \"clean-webpack-plugin\": \"^2.0.1\", \"html-webpack-plugin\": \"^3.2.0\", \"http-server\": \"^0.11.1\", \"webpack\": \"^4.30.0\", \"webpack-cli\": \"^3.3.1\", }} æ‰§è¡Œä¸‹npm run build 123.â”œâ”€â”€ bundle.jsâ””â”€â”€ index.html ä¸ºäº†æ¨¡æ‹ŸæœåŠ¡å™¨ç¯å¢ƒï¼Œæˆ‘ä»¬å®‰è£…ä¸‹http-server npm i http-server -D é…ç½®ä¸‹package.jsonï¼Œ&quot;start&quot;: &quot;http-server ./dist&quot; æ‰§è¡Œnpm run startæ¥å¯åŠ¨ dist æ–‡ä»¶å¤¹ä¸‹çš„é¡µé¢ è¿™ä¸ªæ—¶å€™æ§åˆ¶å°ä¼šæ­£å¸¸æ‰“å°å‡º'this is outer console' å½“æˆ‘ä»¬æ–­å¼€http-serveræœåŠ¡åï¼Œåœ¨è®¿é—®è¯¥é¡µé¢æ—¶ï¼Œé¡µé¢å°±æŠ¥ 404 äº† è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ° pwa æŠ€æœ¯äº† ä½¿ç”¨æ­¥éª¤ï¼š å®‰è£…ï¼š npm i workbox-webpack-plugin -D webpack é…ç½®æ–‡ä»¶é…ç½®ï¼š 1234567891011121314151617181920// webpack.config.jsconst { GenerateSW } = require('workbox-webpack-plugin');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = { mode: 'production', entry: './index.js', output: { filename: 'bundle.js' }, plugins: [ new CleanWebpackPlugin(), new HtmlWebpackPlugin(), new GenerateSW({ skipWaiting: true, // å¼ºåˆ¶ç­‰å¾…ä¸­çš„ Service Worker è¢«æ¿€æ´» clientsClaim: true // Service Worker è¢«æ¿€æ´»åä½¿å…¶ç«‹å³è·å¾—é¡µé¢æ§åˆ¶æƒ }) ]}; è¿™é‡Œæˆ‘ä»¬å†™ä¸€ä¸ªæœ€ç®€å•çš„ä¸šåŠ¡ä»£ç ï¼Œåœ¨æ³¨å†Œå®Œ pwa ä¹‹åæ‰“å°ä¸‹å†…å®¹ï¼š 1234567891011121314151617// index.jsconsole.log('this is outer console');// è¿›è¡Œ service-wroker æ³¨å†Œif ('serviceWorker' in navigator) { window.addEventListener('load', () =&gt; { navigator.serviceWorker .register('./service-worker.js') .then(registration =&gt; { console.log('====== this is inner console ======'); console.log('SW registered: ', registration); }) .catch(registrationError =&gt; { console.log('SW registration failed: ', registrationError); }); });} æ‰§è¡Œä¸‹æ‰“åŒ…å‘½ä»¤ï¼šnpm run build 12345.â”œâ”€â”€ bundle.jsâ”œâ”€â”€ index.htmlâ”œâ”€â”€ precache-manifest.e21ef01e9492a8310f54438fcd8b1aad.jsâ””â”€â”€ service-worker.js æ‰“åŒ…ä¹‹åä¼šç”Ÿæˆä¸ªservice-worker.jsä¸precache-manifest.e21ef01e9492a8310f54438fcd8b1aad.js æ¥ä¸‹æ¥å†é‡å¯ä¸‹http-serveræœåŠ¡ï¼šnpm run start é¡µé¢å°†ä¼šæ‰“å°å‡º 123this is outer console====== this is inner console ======... ç„¶åæˆ‘ä»¬å†æ–­å¼€http-serveræœåŠ¡ åˆ·æ–°ä¸‹é¡µé¢ï¼Œç«Ÿç„¶æ‰“å°å‡ºäº†ç›¸åŒçš„ä»£ç ã€‚è¯´æ˜ pwa ç¦»çº¿ç¼“å­˜æˆåŠŸã€‚ typescriptä½¿ç”¨ webpack æ‰“åŒ… ts æ–‡ä»¶ï¼Œå°±éœ€è¦å®‰è£…ts-loader å®‰è£…ï¼šnpm i ts-loader typescript -D webpack.config.jsæ–‡ä»¶ä¸­æ·»åŠ è§£ætypescriptä»£ç çš„loader 1234567891011121314151617181920const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = { mode: 'production', entry: './src/index.ts', output: { filename: 'bundle.js' }, module: { rules: [ { test: /\\.ts$/, loader: 'ts-loader', exclude: /node_modules/ } ] }, plugins: [new CleanWebpackPlugin(), new HtmlWebpackPlugin()]}; é…ç½®äº†webpack.config.jsè¿˜ä¸è¡Œï¼Œè¿˜å¾—åœ¨æ ¹ç›®å½•æ–‡ä»¶ä¸‹æ–°å¢ä¸ª.tsconfig.jsonæ–‡ä»¶ 123456789{ \"compilerOptions\": { \"outDir\": \"./dist/\", // é»˜è®¤è§£æåçš„æ–‡ä»¶è¾“å‡ºä½ç½® \"noImplicitAny\": true, // å­˜åœ¨éšå¼ any æ—¶æŠ›é”™ \"module\": \"es6\", // è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªes6æ¨¡å—æœºåˆ¶ \"target\": \"es5\", // è¡¨ç¤ºè¦è®²tsä»£ç è½¬æˆes5ä»£ç  \"allowJs\": true // è¡¨ç¤ºå…è®¸å¼•å…¥jsæ–‡ä»¶ã€‚TS æ–‡ä»¶æŒ‡æ‹“å±•åä¸º .tsã€.tsx æˆ– .d.ts çš„æ–‡ä»¶ã€‚å¦‚æœå¼€å¯äº† allowJs é€‰é¡¹ï¼Œé‚£ .js å’Œ .jsx æ–‡ä»¶ä¹Ÿå±äº TS æ–‡ä»¶ }} æ–°å»ºindex.ts 12345678910111213141516171819class Greeter { greeting: string; constructor(message: string) { this.greeting = message; } greet() { return 'Hello, ' + this.greeting; }}let greeter = new Greeter('world');let button = document.createElement('button');button.textContent = 'Say Hello';button.onclick = function() { alert(greeter.greet());};document.body.appendChild(button); æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼Œè®¿é—®æ‰“åŒ…åçš„é¡µé¢ï¼Œé¡µé¢æ­£å¸¸æ‰§è¡Œã€‚ å½“éœ€è¦ä½¿ç”¨lodashç­‰åº“æ—¶ï¼Œ éœ€å®‰è£…ï¼šnpm i @types/lodash -D ä¿®æ”¹é¡µé¢ä»£ç  å¼•å…¥ lodash 123456789101112131415161718192021import * as _ from 'lodash';class Greeter { greeting: string; constructor(message: string) { this.greeting = message; } greet() { return 'Hello, ' + this.greeting; }}let greeter = new Greeter('world');let button = document.createElement('button');button.textContent = 'Say Hello';button.onclick = function() { alert(_.join(['lodash', greeter.greet()], '-'));};document.body.appendChild(button); æé†’ï¼šts ä½¿ç”¨çš„åŒ…ï¼Œå¯é€šè¿‡https://microsoft.github.io/TypeSearch è¿™ä¸ªç½‘å€å»æŸ¥å¯¹åº”çš„åŒ…ä½¿ç”¨æŒ‡å— ä½¿ç”¨WebpackDevServerå®ç°è¯·æ±‚è½¬å‘å½“æˆ‘ä»¬å·¥ä½œæœ¬åœ°å¼€å‘æŸä¸€ä¸ªéœ€æ±‚çš„æ—¶å€™ï¼Œéœ€è¦å°†è¿™å—éœ€æ±‚çš„è¯·æ±‚åœ°å€è½¬å‘åˆ°æŸä¸ªåç«¯åŒäº‹çš„æœ¬åœ°æœåŠ¡å™¨æˆ–æŸä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°±éœ€è¦ç”¨åˆ°ä»£ç†ã€‚ç„¶åå…¶ä»–é¡µé¢çš„è¯·æ±‚éƒ½èµ°æµ‹è¯•ç¯å¢ƒçš„è¯·æ±‚ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€æ ·æ‹¦æˆªæŸä¸ªè¯·æ±‚ï¼Œå¹¶å°†å…¶è½¬å‘åˆ°æˆ‘ä»¬æƒ³è¦è½¬å‘çš„æ¥å£ä¸Šå‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°webpack-dev-server ä¸»è¦çœ‹devServeré…ç½®ï¼š 1234567891011121314151617// webpack.config.jsconst CleanWebpackPlugin = require('clean-webpack-plugin');const HtmlWebpackPlugin = require('html-webpack-plugin');module.exports = { mode: 'development', entry: './index.js', output: { filename: 'bundle.js' }, devServer: { contentBase: './dist', open: true, hot: true }, plugins: [new HtmlWebpackPlugin(), new CleanWebpackPlugin()]}; 12345// package.jsonscripts: { \"server\": \"webpack-dev-server\"} 12345678910111213// index.jsimport axios from 'axios';const div = document.createElement('div');div.innerHTML = 'hahahha';div.addEventListener('click', () =&gt; { alert('hahah'); axios.get('/list').then(res =&gt; { console.log(res); });});document.body.appendChild(div); åœ¨å†™ä¸€ä¸ªæœ¬åœ°å¯åŠ¨çš„æœåŠ¡ç«¯ä»£ç  123456789101112const express = require('express');const app = express();app.get('/api/list', (req, res) =&gt; { res.json({ success: true });});app.listen(8888, () =&gt; { console.log('listening localhost:8888');}); æ‰§è¡Œnpm run serverå‘½ä»¤ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€é¡µé¢ã€‚ç‚¹å‡» div åï¼Œä¼šå‘èµ·è¯·æ±‚ã€‚ æµè§ˆå™¨æç¤ºhttp://localhost:8080/api/list 404 (Not Found),è¡¨ç¤ºè¯¥æ¥å£ä¸å­˜åœ¨ã€‚ å› ä¸ºæˆ‘ä»¬webpackå¯åŠ¨é™æ€èµ„æºæœåŠ¡å™¨é»˜è®¤ç«¯å£ä¸º 8080ï¼Œæ‰€ä»¥ä»–æ±‚ä¼šç›´æ¥è¯·æ±‚åˆ° 8080 çš„/api/list æ¥å£ã€‚æ‰€ä»¥ä¼šæç¤ºæ‰¾ä¸åˆ°è¯¥æ¥å£ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†è¯¥è¯·æ±‚ä» 8080 ç«¯å£ä»£ç†åˆ° 8888 ç«¯å£(ä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±æœ¬åœ°å¯åŠ¨çš„æœåŠ¡) é…ç½®webpack.config.js è¿™é‡Œæˆ‘åªå±•ç¤ºdevServerä»£ç  1234567891011// webpack.config.jsdevServer: { contentBase: './dist', open: true, hot: true, proxy: { '/api': { target: 'http://localhost:8888' } }}, é…ç½®devServerçš„proxyå­—æ®µçš„å‚æ•°ï¼Œå°†è¯·æ±‚/apiå¼€å¤´çš„è¯·æ±‚éƒ½è½¬å‘åˆ°http://localhost:8888, é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥è§£å†³ä¸€å¼€å§‹æåˆ°çš„æœ¬åœ°å¼€å‘çš„æ—¶å€™ï¼Œåªæƒ³æŠŠéƒ¨åˆ†æ¥å£è½¬å‘åˆ°æŸå°éƒ¨ç½²æ–°éœ€æ±‚çš„æœåŠ¡å™¨ä¸Šã€‚æ¯”å¦‚å½“ä½ è¿™ä¸ªé¡¹ç›®è¯·æ±‚å¾ˆå¤šï¼Œä¸åŒæ¥å£éƒ¨ç½²åœ¨ä¸åŒçš„ç«¯å£æˆ–è€…ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡é…ç½®ç¬¬ä¸€ä¸ªè·¯å¾„ï¼Œæ¥åŒºåˆ†ä¸åŒçš„æ¨¡å—ã€‚å¹¶è½¬å‘åˆ°ä¸åŒçš„æœåŠ¡ä¸Šã€‚å¦‚ï¼š 1234567891011121314151617// webpack.config.jsdevServer: { contentBase: './dist', open: true, hot: true, proxy: { '/module1': { target: 'http://localhost:8887' }, '/module2': { target: 'http://localhost:8888' }, '/module3': { target: 'http://localhost:8889' } }}, å½“ä½ è¦ä»£ç†åˆ°æŸä¸ª https çš„æ¥å£ä¸Šï¼Œå°±éœ€è¦è®¾ç½®secure: false 123456789// webpack.config.jsdevServer: { proxy: { '/api': { target: 'https://other-server.example.com', secure: false } }} 12345678target: ''ï¼Œ // ä»£ç†çš„ç›®æ ‡åœ°å€secure: false, // è¯·æ±‚httpsçš„éœ€è¦è®¾ç½®changeOrigin: true, // è·¨åŸŸçš„æ—¶å€™éœ€è¦è®¾ç½®headers: { host: 'http://www.baidu.com', //ä¿®æ”¹è¯·æ±‚åŸŸå cookie: ''}... å…¶ä»–å…³äºdevServerçš„é…ç½®è¯¦è§devServer WebpackDevServer è§£å†³å•é¡µé¢è·¯ç”± 404 é—®é¢˜ç›¸ä¿¡å¤§å®¶éƒ½æ˜¯å¼€å‘è¿‡ vue æˆ–è€… react å•é¡µé¢å¸¦è·¯ç”±çš„åº”ç”¨ã€‚è¿™é‡Œå°±å¿½ç•¥ä¸šåŠ¡ä»£ç ï¼Œä»‹ç»ä¸‹devServerçš„historyApiFallbackå‚æ•° 123devServer: { historyApiFallback: true, // å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œåˆ‡æ¢è·¯ç”±å°±ä¸ä¼šå‡ºç°è·¯ç”±404çš„é—®é¢˜äº†} è¯¦è§historyApiFallback eslintå®‰è£…eslint: npm i eslint -D ç›®å½•ä¸‹æ–°å»º.eslintrc.jsonæ–‡ä»¶ã€‚ environment: æŒ‡å®šè„šæœ¬çš„è¿è¡Œç¯å¢ƒ globals: è„šæœ¬åœ¨æ‰§è¡ŒæœŸé—´è®¿é—®çš„é¢å¤–å…¨å±€å˜é‡ã€‚ rules: å¯åŠ¨çš„è§„åˆ™åŠå…¶å„è‡ªçš„é”™è¯¯çº§åˆ«ã€‚ è§£æå™¨é€‰é¡¹: è§£æå™¨é€‰é¡¹ ç¼–è¾‘ä½ çš„eslintçš„è§„åˆ™ 123456789101112{ \"parserOptions\": { \"ecmaVersion\": 6, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true } }, \"rules\": { \"semi\": 2 }} vscodeå®‰è£…eslintæ’ä»¶ã€‚ é…ç½®ä¸‹webpack.config.jsé…ç½®ã€‚ 123456789101112131415...devServer: { overlay: true, contentBase: './dist', hot: true, open: true},module: { rules: [{ test: /\\.js$/, exclude: /node_modules/, use: ['eslint-loader'] }]}... eslint-loaderæ˜¯ç”¨äºæ£€æŸ¥jsä»£ç æ˜¯å¦ç¬¦åˆeslintè§„åˆ™ã€‚ è¿™é‡ŒdevServerä¸­çš„overlayçš„ä½œç”¨æ˜¯ï¼Œå½“ä½  eslint æŠ¥é”™çš„æ—¶å€™ï¼Œé¡µé¢ä¼šæœ‰ä¸ªæŠ¥é”™è’™å±‚ã€‚è¿™æ ·å°±ä¸å±€é™äºç¼–è¾‘å™¨ï¼ˆvscode)çš„æŠ¥é”™æé†’äº†ã€‚ å¦‚æœ js ä»£ç ä½¿ç”¨äº†å¤šä¸ª loaderï¼Œé‚£ä¹ˆ eslint-loader ä¸€å®šè¦å†™åœ¨æœ€å³è¾¹ã€‚å¦‚æœä¸å†™åœ¨æœ€åä¸€ä¸ªçš„è¯ï¼Œéœ€åœ¨é‡Œé¢æ·»åŠ enforce: &quot;pre&quot;,è¿™æ ·ä¸ç®¡å†™åœ¨å“ªä¸ªä½ç½®éƒ½ä¼šä¼˜å…ˆä½¿ç”¨eslint-loaderæ ¡éªŒä¸‹ä»£ç è§„èŒƒã€‚ 123456{ loader: 'eslint-loader', options: { enforce: \"pre\", }} æå‡webpackæ‰“åŒ…é€Ÿåº¦çš„æ–¹æ³•1. è·Ÿä¸ŠæŠ€æœ¯çš„è¿­ä»£ å‡çº§webpackç‰ˆæœ¬ nodeç‰ˆæœ¬npmç­‰ç‰ˆæœ¬ 2. å°½å¯èƒ½å°‘çš„æ¨¡å—ä¸Šåº”ç”¨loader include exclude 3. å°½å¯èƒ½å°‘çš„ä½¿ç”¨plugin4. resolve123456resolve: { extensions: ['.js'], alias: { 'src': path.resolve(__dirname, '../src') }} extensions: å¯ä»¥è®©ä½  import æ¨¡å—çš„æ—¶å€™ä¸å†™æ ¼å¼ï¼Œå½“ä½ ä¸å†™æ ¼å¼çš„æ—¶å€™ï¼Œwebpack ä¼šé»˜è®¤é€šè¿‡ extensions ä¸­çš„æ ¼å¼å»ç›¸åº”çš„æ–‡ä»¶å¤¹ä¸­æ‰¾ alias:å½“ä½ importçš„è·¯å¾„å¾ˆé•¿çš„æ—¶å€™ï¼Œæœ€å¥½ä½¿ç”¨åˆ«åï¼Œèƒ½ç®€åŒ–ä½ çš„è·¯å¾„ã€‚ æ¯”å¦‚ï¼šimport index.js from '../src/a/b/c/index.js' è®¾ç½®åˆ«åï¼š 12345resolve: { alias: { '@c': path.resolve(__dirname, '../src/a/b/c') }} è¿™æ ·ä½ çš„importå¯¼å…¥ä»£ç å°±å¯ä»¥æ”¹æˆimport index.js from '@c/index.js' 5. dllPluginæˆ‘ä»¬å…ˆè®°å½•ä¸‹ä¸ä½¿ç”¨dllæ‰“åŒ…æ—¶é—´787msï¼š 12345Time: 787msBuilt at: 2019-05-04 18:32:29 Asset Size Chunks Chunk Names bundle.js 861 KiB main [emitted] mainindex.html 396 bytes [emitted] æ¥ä¸‹æ¥æˆ‘ä»¬å°±å°è¯•ä½¿ç”¨dllæŠ€æœ¯ æˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸ªç”¨äºæ‰“åŒ…dllæ–‡ä»¶çš„webpacké…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆæ‰“åŒ…åçš„jsæ–‡ä»¶ä¸æè¿°åŠ¨æ€é“¾æ¥åº“çš„manifest.json 123456789101112131415161718192021// webpack.dll.config.jsconst path = require('path');const webpack = require('webpack');module.exports = { entry: { vendor: ['jquery', 'lodash'] // è¦æ‰“åŒ…è¿›vendorçš„ç¬¬ä¸‰æ–¹åº“ }, output: { filename: '[name].dll.js', // æ‰“åŒ…åçš„æ–‡ä»¶å path: path.resolve(__dirname, './dll'), // æ‰“åŒ…åå­˜å‚¨çš„ä½ç½® library: '[name]_[hash]' // æŒ‚è½½åˆ°å…¨å±€å˜é‡çš„å˜é‡åï¼Œè¿™é‡Œè¦æ³¨æ„ è¿™é‡Œçš„libraryä¸€å®šè¦ä¸DllPluginä¸­çš„nameä¸€è‡´ }, plugins: [ new webpack.DllPlugin({ // ç”¨äºæ‰“åŒ…å‡ºä¸€ä¸ªä¸ªå•ç‹¬çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ name: '[name]_[hash]', // å¼•ç”¨outputæ‰“åŒ…å‡ºçš„æ¨¡å—å˜é‡åï¼Œåˆ‡è®°è¿™é‡Œå¿…é¡»ä¸output.libraryä¸€è‡´ path: path.join(__dirname, './dll', '[name].manifest.json') // æè¿°åŠ¨æ€é“¾æ¥åº“çš„ manifest.json æ–‡ä»¶è¾“å‡ºæ—¶çš„æ–‡ä»¶åç§° }) ]}; é‡ç‚¹ï¼šè¿™é‡Œå¼•å…¥çš„ DllPlugin æ’ä»¶ï¼Œè¯¥æ’ä»¶å°†ç”Ÿæˆä¸€ä¸ª manifest.json æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¾› webpack.config.js ä¸­åŠ å…¥çš„ DllReferencePlugin ä½¿ç”¨ï¼Œä½¿æˆ‘ä»¬æ‰€ç¼–å†™çš„æºæ–‡ä»¶èƒ½æ­£ç¡®åœ°è®¿é—®åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„é™æ€èµ„æºï¼ˆè¿è¡Œæ—¶ä¾èµ–åŒ…ï¼‰ã€‚ é…ç½®ä¸‹package.jsonæ–‡ä»¶çš„scripts: &quot;build:dll&quot;: &quot;webpack --config webpack.dll.config.js&quot; æ‰§è¡Œä¸‹ npm run build:dll 1234Time: 548msBuilt at: 2019-05-04 18:54:09 Asset Size Chunks Chunk Namesvendor.dll.js 157 KiB 0 [emitted] vendor é™¤äº†æ‰“åŒ…å‡ºdllæ–‡ä»¶ä¹‹å¤–ï¼Œè¿˜å¾—å†ä¸»webpacké…ç½®æ–‡ä»¶ä¸­å¼•å…¥ã€‚è¿™é‡Œå°±éœ€è¦ä½¿ç”¨åˆ°DllReferencePluginã€‚å…·ä½“é…ç½®å¦‚ä¸‹ï¼š 1234// webpack.config.jsnew webpack.DllReferencePlugin({ manifest: require('./dll/vendor.manifest.json')}), è¿™é‡Œçš„manifestï¼šéœ€è¦é…ç½®çš„æ˜¯ä½ dllPluginæ‰“åŒ…å‡ºæ¥çš„manifest.jsonæ–‡ä»¶ã€‚è®©ä¸»webpacké…ç½®æ–‡ä»¶é€šè¿‡è¿™ä¸ª æè¿°åŠ¨æ€é“¾æ¥åº“manifest.jsonæ–‡ä»¶ï¼Œè®©jså¯¼å…¥è¯¥æ¨¡å—çš„æ—¶å€™ï¼Œç›´æ¥å¼•ç”¨dllæ–‡ä»¶å¤¹ä¸­æ‰“åŒ…å¥½çš„æ¨¡å—ã€‚ çœ‹ä¼¼éƒ½é…ç½®å¥½äº†ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œä¸‹å‘½ä»¤ npm run build ä½¿ç”¨dllæ‰“åŒ…åæ—¶é—´ï¼š 12345Time: 471msBuilt at: 2019-05-04 18:19:49 Asset Size Chunks Chunk Names bundle.js 6.43 KiB main [emitted] mainindex.html 182 bytes [emitted] ç›´æ¥ä»æœ€å¼€å§‹çš„787msé™ä½åˆ°471msï¼Œå½“ä½ æŠ½ç¦»çš„ç¬¬ä¸‰æ–¹æ¨¡å—è¶Šå¤šï¼Œè¿™ä¸ªæ•ˆæœå°±è¶Šæ˜æ˜¾ã€‚ æµè§ˆå™¨è·‘ä¸‹htmlé¡µé¢ï¼Œä¼šæŠ¥é”™ Uncaught ReferenceError: vendor_e406fbc5b0a0acb4f4e9 is not defined è¿™æ˜¯å› ä¸ºindex.htmlè¿˜éœ€è¦é€šè¿‡scriptæ ‡ç­¾å¼•å…¥è¿™ä¸ªdllæ‰“åŒ…å‡ºæ¥çš„jsæ–‡ä»¶ æˆ‘ä»¬å¦‚æœæ¯æ¬¡è‡ªå·±æ‰‹åŠ¨å¼•å…¥çš„è¯ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœdllæ–‡ä»¶éå¸¸å¤šçš„è¯ï¼Œå°±éš¾ä»¥æƒ³è±¡äº†ã€‚ è¿™ä¸ªæ—¶å€™å°±éœ€è¦å€ŸåŠ©add-asset-html-webpack-pluginè¿™ä¸ªåŒ…äº†ã€‚ 12345const AddAssetHtmlPlugin = require('add-asset-html-webpack-plugin');new AddAssetHtmlPlugin({ filepath: path.resolve(__dirname, './dll/vendor.dll.js')}); é€šè¿‡è¿™åŒ…ï¼Œwebpackä¼šå°†dllæ‰“åŒ…å‡ºæ¥çš„jsæ–‡ä»¶é€šè¿‡scriptæ ‡ç­¾å¼•å…¥åˆ°index.htmlæ–‡ä»¶ä¸­ è¿™ä¸ªæ—¶å€™ä½ åœ¨npm run buildï¼Œè®¿é—®ä¸‹é¡µé¢å°±æ­£å¸¸äº† 6. æ§åˆ¶åŒ…æ–‡ä»¶å¤§å°tree-shaking ç­‰ 7. thread-loader parallel-webpack happypack ç­‰å¤šè¿›ç¨‹æ‰“åŒ…8. åˆç†ä½¿ç”¨ sourceMap9. ç»“åˆ stats åˆ†ææ‰“åŒ…ç»“æœå€ŸåŠ©çº¿ä¸Šæˆ–è€…æœ¬åœ°æ‰“åŒ…åˆ†æå·¥å…· 10. å¼€å‘ç¯å¢ƒå†…å­˜ç¼–è¯‘å¼€å‘ç¯å¢ƒçš„æ—¶å€™ä¸ä¼šç”Ÿæˆ dist æ–‡ä»¶å¤¹ï¼Œä¼šç›´æ¥ä»å†…å­˜ä¸­è¯»å–ï¼Œå› ä¸ºå†…å­˜è¯»å–æ¯”ç¡¬ç›˜è¯»å–å¿« 11. å¼€å‘ç¯å¢ƒæ— ç”¨æ’ä»¶å‰”é™¤F","link":"/blog/2019/05/15/webpack4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"},{"title":"webpack4å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰","text":"å‰è¨€è¿™æ˜¯æˆ‘èŠ±äº†å‡ ä¸ªæ˜ŸæœŸå­¦ä¹  webpack4 çš„å­¦ä¹ ç¬”è®°ã€‚å†…å®¹ä¸å¤Ÿç»†ï¼Œå› ä¸ºä¸€äº›ç›¸å¯¹æ¯”è¾ƒç®€å•çš„ï¼Œå°±éšæ„å¸¦è¿‡äº†ã€‚å¸Œæœ›æ–‡ç« èƒ½ç»™å¤§å®¶å¸¦æ¥å¸®åŠ©ã€‚å¦‚æœ‰é”™è¯¯ï¼Œå¸Œæœ›åŠæ—¶æŒ‡å‡ºã€‚ä¾‹å­éƒ½åœ¨learn-webpackä»“åº“ä¸Šã€‚å¦‚æœä½ ä»ä¸­æœ‰æ‰€æ”¶è·çš„è¯ï¼Œå¸Œæœ›ä½ èƒ½ç»™æˆ‘çš„githubç‚¹ä¸ªstarã€‚ ç¼–å†™ loader12// index.jsconsole.log('hello, atie'); é…ç½®webpack.config.js 1234567891011// webpack.config.jsmodule: { rules: [ { test: /\\.js$/, include: /src/, loader: path.resolve(__dirname, './loaders/replaceLoader.js') } ]}, 12345// å‡½æ•°ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°module.exports = function(source) { console.log(source, 'source'); return source.replace('atie', 'world');}; loaderæ–‡ä»¶å…¶å®å°±æ˜¯å¯¼å‡ºä¸€ä¸ªå‡½æ•°ï¼Œsourceå°±æ˜¯webpackæ‰“åŒ…å‡ºçš„jså­—ç¬¦ä¸²ã€‚è¿™é‡Œçš„loaderå°±æ˜¯å°†ä¸Šé¢çš„console.log('hello, atie')æ›¿æ¢ä¸ºconsole.log('hello, world') æ‰“åŒ…ä¸‹ä»£ç ï¼Œä¸å‡ºæ‰€æ–™ã€‚æ§åˆ¶å°å°±ä¼šæ‰“å°å‡ºhello, world å½“ä½ æƒ³è¦ç»™ loader ä¼ å‚æ—¶ï¼Œå¯é…ç½®å¦‚ä¸‹ 1234567891011121314module: { rules: [ { test: /\\.js$/, include: /src/, use: [{ loader: path.resolve(__dirname, './loaders/replaceLoader.js'), options: { name: 'haha' } }] } ]}, é€šè¿‡ç»™loaderæ·»åŠ options è¿™æ ·loaderä¸­å°±å¯ä»¥é€šè¿‡this.queryè·å–è¯¥å‚æ•°äº† 12345module.exports = function(source) { // æ§åˆ¶å°è¾“å‡ºï¼šconsole.log('hello atie') { name: 'haha' } source console.log(source, this.query, 'source'); return source.replace('atie', 'world');}; å½“ç„¶å˜é‡ä¸ä¸€å®šéè¦é€šè¿‡this.queryæ¥è·å– å¯é€šè¿‡loader-utilsè¿™ä¸ªåŒ…æ¥è·å–ä¼ å…¥çš„å˜é‡ å®‰è£…: npm i loader-utils -D 123456789const loaderUtils = require('loader-utils');// å‡½æ•°ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°module.exports = function(source) { // console.log(source, this.query, 'source') const options = loaderUtils.getOptions(this); console.log(options, 'options'); // { name: 'haha' } 'options' return source.replace('atie', 'world');}; æ‰“å°å‡ºæ¥çš„ä¸ä¸Šé¢this.queryä¸€è‡´ ä¸Šé¢éƒ½æ˜¯ç›´æ¥é€šè¿‡returnè¿”å›çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•è¿”å›loaderç¿»è¯‘åçš„ä»£ç å‘¢ï¼Ÿ` è¿™é‡Œå°±ä¼šç”¨åˆ°callback 123456this.callback( err: Error | null, content: string | Buffer, sourceMap?: SourceMap, meta?: any); ä¸Šé¢çš„ä»£ç å°±å¯ä»¥æ”¹å†™æˆ 12345module.exports = function(source) { const options = loaderUtils.getOptions(this); const result = source.replace('atie', options.name); this.callback(null, result);}; callbackä¼˜åŠ¿åœ¨äºå®ƒå¯ä»¥ä¼ é€’å¤šä½™çš„å‚æ•° 12345module.exports = function(source) { setTimeout(() =&gt; { return source.replace('atie', 'world'); }, 1000);}; å½“æˆ‘ä»¬æŠŠreturnåŒ…åˆ°å¼‚æ­¥æ–¹æ³•é‡Œï¼Œæ‰“åŒ…çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°this.async() 123456module.exports = function(source) { const callback = this.async(); setTimeout(() =&gt; { callback(null, source.replace('atie', 'world')); }, 2000);}; é€šè¿‡è°ƒç”¨this.async()è¿”å›çš„callbackæ–¹æ³•æ¥è¿”å›ç»“æœ use ä¸­çš„ loader æ‰§è¡Œé¡ºåºï¼Œå…ˆå³åå·¦ï¼Œå…ˆä¸‹åä¸Š ç¼–å†™ pluginåœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºpluginsæ–‡ä»¶å¤¹ï¼Œå¹¶æ–°å»ºcopyright-webpack-plugin.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š 1234567class Copyright { constructor() { console.log('this is plugin'); } apply(compiler) {}}module.exports = Copyright; æ³¨æ„ï¼šapply è¿™ä¸ªæ–¹æ³•å¿…é¡»å­˜åœ¨ï¼Œä¸ç„¶æ’ä»¶è¢«æ‰§è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ã€‚ é…ç½®webpack.config.js,å¦‚ä¸‹ï¼š 1234567const Copyrgiht = require('./plugins/copyright-webpack-plugin.js')...plugins: [ new Copyrgiht()] æ‰§è¡Œä¸‹æ‰“åŒ…å‘½ä»¤å 12345678this is pluginHash: 479baeba2207182096f8Version: webpack 4.30.0Time: 615msBuilt at: 2019-05-08 23:05:08 Asset Size Chunks Chunk Names bundle.js 3.77 KiB main [emitted] mainindex.html 182 bytes [emitted] æ§åˆ¶å°æ‰“å°å‡ºäº†this is plugin æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­æ¢ç´¢æ’ä»¶çš„å¥¥ç§˜ åœ¨ä½¿ç”¨æ’ä»¶çš„æ—¶å€™è¿˜å¯ä»¥ä¼ å‚ 123456// webpack.config.jsplugins: [ new Copyrgiht({ name: 'atie' })]; 123456789class Copyright { constructor(options) { // console.log(options, 'this is plugin') this.options = options; } apply(compiler) { console.log(this.options); }} æ‰§è¡Œä¸‹æ‰“åŒ…å‘½ä»¤ï¼š 12345678{ name: 'atie' }Hash: 479baeba2207182096f8Version: webpack 4.30.0Time: 742msBuilt at: 2019-05-08 23:24:10 Asset Size Chunks Chunk Names bundle.js 3.77 KiB main [emitted] mainindex.html 182 bytes [emitted] æ§åˆ¶å°±ä¼šè¾“å‡º {name: 'atie'} webpackåœ¨è°ƒç”¨applyä¼šä¼ é€’ä¸€ä¸ªcompilerå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå…·ä½“å¯ä»¥å‚è€ƒwebpackå®˜ç½‘ è¿™é‡Œä»‹ç»ä¸‹é’©å­ 123456789101112131415161718class Copyright { apply(compiler) { compiler.hooks.emit.tapAsync('Copyright', (compilation, callback) =&gt; { console.log(compilation.assets, 'ä»¥å…·æœ‰å»¶è¿Ÿçš„å¼‚æ­¥æ–¹å¼è§¦åŠ run é’©å­ã€‚'); compilation.assets['copyright.txt'] = { source: function() { return 'copyright by atie'; }, size: function() { return 17; } }; callback(); }); }}module.exports = Copyright; è¯¥é’©å­æ˜¯åœ¨æ–‡ä»¶ç”Ÿæˆå‰è§¦å‘çš„ã€‚æˆ‘ä»¬åœ¨æ–‡ä»¶ç”Ÿæˆå‰ï¼Œåœ¨assetå¯¹è±¡ä¸Šåœ¨åŠ ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ æ‰“åŒ…ä¹‹å 1234.â”œâ”€â”€ bundle.jsâ”œâ”€â”€ copyright.txtâ””â”€â”€ index.html å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€ä¸ªcopyright.txtï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„æ–‡ä»¶ã€‚ç‚¹å¼€è¯¥æ–‡ä»¶è¿˜ä¼šçœ‹åˆ°é‡Œé¢çš„å†…å®¹æ­£æ˜¯copyright by atie","link":"/blog/2019/05/15/webpack4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/"},{"title":"dockerä»å…¥é—¨åˆ°å®æˆ˜-åŸºç¡€ç¯‡","text":"å‰è¨€æœ¬æ–‡æ˜¯æˆ‘é€šè¿‡ä¸‰ä¸ªæ˜ŸæœŸä¸šä½™æ—¶é—´å­¦ä¹ åè€Œå†™çš„æ–‡ç« ï¼Œå¯¹ docker çš„äº†è§£è¿˜å¤„äºå…¥é—¨é˜¶æ®µã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®å¿™ä¸€äº›æƒ³å­¦ä¹  docker çš„æœ‹å‹å¿«é€Ÿå…¥é—¨ã€‚ç»ƒä¹ åŠå®æˆ˜ä»£ç éƒ½åœ¨ github ä»“åº“ä¸­ã€‚å¦‚æœæˆ‘çš„æ–‡ç« èƒ½å¸®åŠ©åˆ°ä½ çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘çš„docker é¡¹ç›®ç‚¹ä¸ªèµå“¦ ä»‹ç»docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå¼€å‘è€…å¯ä»¥æ‰“åŒ…è‡ªå·±çš„åº”ç”¨åˆ°å®¹å™¨é‡Œé¢ï¼Œç„¶åè¿ç§»åˆ°å…¶ä»–æœºå™¨çš„ docker åº”ç”¨ä¸­ï¼Œå¯ä»¥å®ç°å¿«é€Ÿéƒ¨ç½²ã€‚å¦‚æœå‡ºç°çš„æ•…éšœï¼Œå¯ä»¥é€šè¿‡é•œåƒï¼Œå¿«é€Ÿæ¢å¤æœåŠ¡ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå…¬å¸ä¸€èˆ¬éƒ½ä¼šæœ‰å¤šå¥—ç¯å¢ƒï¼Œé‚£ä¹ˆå¦‚ä½•ä¿æŒå¤šå¥—çš„è¿è¡Œç¯å¢ƒä¸€è‡´ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨åˆ° dockerã€‚ä¸”å½“è¦æ±‚å¢åŠ ä¸€å¥—ç¯å¢ƒçš„æ—¶å€™ï¼Œä½ æ— éœ€åœ¨ä¸€ä¸ªæ–°æœåŠ¡å™¨ä¸Šä¸€ä¸ªä¸ªç¯å¢ƒå®‰è£…ã€é…ç½®ã€‚åªéœ€è¦è¿è¡Œä¸‹ dockerã€‚åŒæ—¶å®˜æ–¹è¿˜æä¾›äº†Docker Hubï¼Œæ‹¥æœ‰å¤§é‡çš„é«˜è´¨é‡çš„å®˜æ–¹é•œåƒã€‚ä½ å¯ä»¥å°†è‡ªå·±çš„é•œåƒä¸Šä¼ ä¸Šå»ã€‚æœ‰ç‚¹ç±»ä¼¼äºgithubã€‚ å®‰è£…å®˜æ–¹æä¾›äº†å®‰è£…æ•™ç¨‹ï¼ŒæŒºè¯¦ç»†çš„ã€‚å®˜æ–¹å®‰è£…æ•™ç¨‹ docker èµ·æ­¥ç¬¬ä¸€æ­¥ï¼šæ‰§è¡Œä¸‹docker -vç¡®è®¤ä¸‹æ˜¯å¦æˆåŠŸå®‰è£…äº† docker å¦‚æœæˆåŠŸå®‰è£…äº†ï¼Œå‘½ä»¤è¡Œå°†ä¼šè¾“å‡ºå…¥ docker çš„ç‰ˆæœ¬å·ã€‚å¦‚ä¸‹ï¼šDocker version 18.09.2, build 6247962 docker çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå¤§è‡´å¯åˆ†ä¸ºï¼š é•œåƒ å®¹å™¨ ä»“åº“ è¿™é‡Œä»¥ubuntué•œåƒä¸ºä¾‹ï¼Œä»‹ç»ä¸‹é•œåƒ åœ¨ä¸‹è½½ubuntué•œåƒä¹‹å‰è¿è¡Œä¸‹docker images(æŸ¥çœ‹é•œåƒå‘½ä»¤)æŸ¥çœ‹ä¸‹æœ¬åœ°çš„é•œåƒã€‚å¦‚æœä½ è¿˜æ²¡ä¸‹è½½è¿‡é•œåƒçš„è¯ï¼Œå½“ç„¶ä¼šå‡ºç°ç©ºã€‚è¿™é‡Œè´´ä¸‹æˆ‘æœ¬åœ°çš„é•œåƒ 12345678âœ study-docker git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEtodolist_static latest de5e325037e9 2 hours ago 1.05GBtodolist_nodejs latest 53efd80e03e1 2 hours ago 898MBubuntu 18.04 7698f282e524 4 weeks ago 69.9MBmysql latest 990386cbd5c0 5 weeks ago 443MBnode 8 a5c31320f223 6 weeks ago 895MBmysql 5.6 73829d7b6139 6 weeks ago 256MB ä½¿ç”¨æ‹‰å–é•œåƒå‘½ä»¤docker pull æ‹‰å–ubuntué•œåƒï¼šdocker pull ubuntuã€‚å½“ä½ ä¸æŒ‡å®šç‰ˆæœ¬æ—¶ï¼Œé»˜è®¤æ‹‰å– latest ç‰ˆæœ¬ã€‚ 123456789101112âœ study-docker git:(master) âœ— docker pull ubuntuUsing default tag: latestlatest: Pulling from library/ubuntu5b7339215d1d: Pull complete14ca88e9f672: Pull completea31c3b1caad4: Pull completeb054a26005b7: Pull completeDigest: sha256:9b1702dcfe32c873a770a32cfd306dd7fc1c4fd134adfb783db68defc8894b3cStatus: Downloaded newer image for ubuntu:latestâœ study-docker git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEubuntu latest 4c108a37151f 12 hours ago 64.2MB ä¹Ÿå¯å®‰è£…æŒ‡å®šç‰ˆæœ¬é•œåƒï¼šdocker pull ubuntu:18.04 æ¥ä¸‹æ¥åŸºäºubuntué•œåƒå¯åŠ¨ä¸€ä¸ªå®¹å™¨ docker run --name first -it ubuntu bash â€“name ç”¨äºæŒ‡å®šå®¹å™¨å it ç”¨äºäº¤äº’å¼å‘½ä»¤è¡Œæ“ä½œï¼Œå¦‚ä¸‹é¢ä¾‹å­è¿è¡Œåï¼Œä¼šæ‰“å¼€å®¹å™¨çš„å‘½ä»¤è¡Œ ä¸Šé¢çš„ ubuntu æŒ‡çš„é•œåƒï¼Œé»˜è®¤åŸºäº latestã€‚é™¤éæŒ‡å®šç‰ˆæœ¬ å¦‚ ubuntu:18.04 è¿è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œå‘½ä»¤è¡Œå·¥å…·å°±ä¼šè‡ªåŠ¨è¿›å…¥å®¹å™¨çš„å‘½ä»¤è¡Œã€‚å¦‚æœæƒ³è¦é€€å‡ºè¯¥å‘½ä»¤è¡Œç•Œé¢ï¼Œå¯è¾“å…¥exitä»¥é€€å‡ºã€‚ 12âœ study-docker git:(master) âœ— docker run --name first -it ubuntu bashroot@b7862a018c2c:/# å¦‚æœæƒ³è®©è¯¥å®¹å™¨åœ¨åå°è¿è¡Œå¯ä»¥é€šè¿‡åŠ -dé…ç½®æ¥è®©è¯¥å®¹å™¨åœ¨åå°è¿è¡Œã€‚åå°è¿è¡Œï¼Œå‘½ä»¤è¡Œå·¥å…·ä¸ä¼šè¿›å…¥è¯¥å®¹å™¨ã€‚ ä½¿ç”¨docker psæŸ¥çœ‹å½“å‰è¿è¡Œä¸­çš„å®¹å™¨ã€‚ 123âœ study-docker git:(master) âœ— docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMEScf8375f48225 ubuntu \"bash\" 15 seconds ago Up 14 seconds first ä½¿ç”¨-dæ¥è®©å®¹å™¨åœ¨åå°è¿è¡Œ 12âœ study-docker git:(master) âœ— docker run --name first -itd ubuntu bash6df29a09d1f1bb0041b7eb59b5288162471ed8a663007f88c6a30e3fd1f4fbe2 å‘½ä»¤è¡Œä¼šè¿”å›å®¹å™¨ id ä½¿ç”¨docker container ls æŸ¥çœ‹æ‰€æœ‰å®¹å™¨åˆ—è¡¨ï¼ˆä¸åŒ…æ‹¬åœæ­¢è¿è¡Œçš„å®¹å™¨ï¼‰ 123âœ study-docker git:(master) âœ— docker container ls -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMEScf8375f48225 ubuntu \"bash\" About a minute ago Up About a minute first ä½¿ç”¨docker stop &lt;å®¹å™¨idæˆ–å®¹å™¨åç§°&gt;åœæ­¢å®¹å™¨çš„è¿è¡Œã€‚ 12âœ study-docker git:(master) âœ— docker stop 6df29a09d1f16df29a09d1f1 æ‰§è¡Œå‘½ä»¤åï¼Œä¼šè¿”å›ä½ åˆšè¾“å…¥å®¹å™¨çš„ idã€‚ä¸Šé¢çš„å®¹å™¨ id ä¸éœ€è¦å¡«å…¨ã€‚å°±æƒ³ git çš„ commit id ä¸€æ ·ã€‚ è¿™ä¸ªæ—¶å€™é€šè¿‡docker container lsæ˜¯æŸ¥ä¸åˆ°å®¹å™¨ä¿¡æ¯çš„ã€‚éœ€è¦ç”¨docker container ls -aæ¥æŸ¥çœ‹ã€‚ 123âœ study-docker git:(master) âœ— docker container ls -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES6df29a09d1f1 ubuntu \"bash\" 5 minutes ago Exited (0) 4 minutes ago å¯ä»¥çœ‹åˆ° STATUS ä¸€æ å¤„ï¼Œè¯¥å®¹å™¨æ˜¯å¤„äºåœæ­¢çŠ¶æ€çš„ã€‚ ä½¿ç”¨docker rm &lt;å®¹å™¨id æˆ–è€… å®¹å™¨æ˜µç§°&gt; 123âœ node git:(master) docker container ls -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESa217eea7188f ubuntu \"/bin/bash\" 11 seconds ago Exited (0) 10 seconds ago dreamy_ishizaka æ‰§è¡Œdocker rm a21 (id å¯ä»¥ä¸è¾“å…¨) 12âœ node git:(master) docker rm a21a21 æ‰§è¡Œå®Œä¹‹åï¼Œå‘½ä»¤è¡Œä¼šè¿”å›ä¹‹å‰è¾“å…¥çš„å®¹å™¨ id ä½¿ç”¨docker container pruneï¼Œæ¥æ¸…ç©ºåœç”¨çŠ¶æ€çš„å®¹å™¨ã€‚ ä½¿ç”¨docker execå‘½ä»¤è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨ å¦‚æƒ³è¿›å…¥åˆšæ‰åå°è¿è¡Œçš„å®¹å™¨çš„äº¤äº’å¼ç•Œé¢:docker exec -it &lt;å®¹å™¨åç§° æˆ–è€… å®¹å™¨id&gt; bash 12âœ study-docker git:(master) âœ— docker exec -it first bashroot@2a87b2f62a6e:/# æƒ³æŸ¥çœ‹æ›´å¤šå…³äº docker çš„å‘½ä»¤ï¼Œç‚¹å‡»è¿™é‡Œ Dockerfileä¸¾ä¸ªnodeé•œåƒçš„ä¾‹å­ æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ æˆ‘è¿™é‡Œå°±æ–°å»ºä¸€ä¸ªåä¸º node çš„æ–‡ä»¶å¤¹ï¼Œå…·ä½“æ–‡ä»¶å¯å‚ç…§æˆ‘çš„ github é¡¹ç›®çš„node ç›®å½• 1234567// index.jsconst express = require('express');const app = express();app.get('/', (req, res) =&gt; { res.end('success');});app.listen(6001); 123456// DockerfileFROM node:8WORKDIR /home/nodeCOPY ../ ../RUN npm installCMD npm start æŒ‡ä»¤ä»‹ç» FROM æˆ‘è¿™ä¸ª node ä¾‹å­æ˜¯åŸºäº node8 é•œåƒ WORKDIR æŒ‡å®šå·¥ä½œåŒºã€‚ COPY å°†æœ¬åœ°ç›®å½•æ–‡ä»¶æ‹·è´åˆ° docker ä¸­ RUN è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œæ¯ä¸ª RUN éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå®¹å™¨ CMD æ‰§è¡Œå‘½ä»¤ï¼Œä¸ RUN ç›¸ä¼¼ æ³¨æ„ æœ‰å¿…è¦æ·»åŠ .dockerignore æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­å¯ä»¥å¡«å†™ä½ ä¸æƒ³æ‰“åŒ…è¿›å®¹å™¨çš„æ–‡ä»¶ã€‚ç±»ä¼¼äº.gitignore 123// .dockerignore/node_modulespackage-lock.json è¯¦ç»†è§£é‡Šï¼Œè¯¦è§dockerfile docker build å‘½ä»¤ç”¨äºä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒ æ‰§è¡Œï¼šdocker build -t mynode .; -t: é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚tag ä¸å†™é»˜è®¤ä¸º latest ç‰ˆæœ¬è¦æ³¨æ„åé¢çš„. è¿™ä¸ªè¡¨ç¤º Dockerfile æ–‡ä»¶åœ¨å½“å‰ç›®å½•ã€‚æ„å»ºé•œåƒæˆåŠŸä¹‹åï¼š 123âœ node git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEmynode latest 3cd10521f802 10 hours ago 898MB æ¥ä¸‹æ¥å°±åŸºäºè¯¥é•œåƒè¿è¡Œä¸€ä¸ª node å®¹å™¨: docker run --name mynode -p 4001:6001 mynode â€“name: è¡¨ç¤ºè¯¥å®¹å™¨çš„åŒ¿å -p: è¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œå› ä¸ºä¸»æœºçš„ ip è·Ÿå®¹å™¨çš„ ip æ˜¯ä¸åŒçš„ï¼Œéœ€è¦æŠŠå®¹å™¨çš„æœåŠ¡æ˜ å°„åˆ° 0.0.0.0:è‡ªå·±è®¾ç½®çš„ä¸»æœºç«¯å£ï¼Œhost ä¸å¡«é»˜è®¤ä¸º 0.0.0.0ã€‚ &lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ä¸­ç«¯å£&gt;ï¼› 123âœ node git:(master) âœ— docker run --name mynode -p 4001:6001 mynode&gt; example2@1.0.0 start /home/node&gt; node index.js æµè§ˆå™¨è®¿é—®localhost:4001,é¡µé¢ä¼šå±•ç¤ºå‡º node å“åº”çš„successå­—ç¬¦ä¸²äº†ã€‚ æ„å»ºå®Œé•œåƒåï¼Œä½ è§‰å¾—ä¸éœ€è¦è¯¥é•œåƒï¼Œæƒ³åˆ é™¤æ€ä¹ˆåŠå‘¢ï¼Ÿ é¦–å…ˆæ‰§è¡Œï¼šdocker imagesåˆ—å‡ºé•œåƒåˆ—è¡¨ 123âœ node git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEmynode latest 3cd10521f802 10 hours ago 898MB ä½¿ç”¨docker rmi &lt;image id&gt;æ¥åˆ é™¤é•œåƒï¼šdocker rmi 3cd10521f802,å¦‚æœæé†’è¯¥é•œåƒè¢«å®¹å™¨å ç”¨ç€ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦å…ˆåˆ é™¤è¯¥å®¹å™¨(å‚è€ƒä¸Šé¢ä»‹ç»çš„å‘½ä»¤)ã€‚","link":"/blog/2019/07/07/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/"},{"title":"dockerä»å…¥é—¨åˆ°å®æˆ˜-å®æˆ˜ç¯‡","text":"å‰è¨€æœ¬æ–‡æ˜¯æˆ‘é€šè¿‡ä¸‰ä¸ªæ˜ŸæœŸä¸šä½™æ—¶é—´å­¦ä¹ åè€Œå†™çš„æ–‡ç« ï¼Œå¯¹ docker çš„äº†è§£è¿˜å¤„äºå…¥é—¨é˜¶æ®µã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®å¿™ä¸€äº›æƒ³å­¦ä¹  docker çš„æœ‹å‹å¿«é€Ÿå…¥é—¨ã€‚ç»ƒä¹ åŠå®æˆ˜ä»£ç éƒ½åœ¨ github ä»“åº“ä¸­ã€‚å¦‚æœæˆ‘çš„æ–‡ç« èƒ½å¸®åŠ©åˆ°ä½ çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘çš„docker é¡¹ç›®ç‚¹ä¸ªèµå“¦ docker å®æˆ˜æœ¬æ¬¡å®æˆ˜æ¡ˆä¾‹æ˜¯ todolistã€‚æŠ€æœ¯æ ˆä¸º vueã€nodeã€mysqlã€‚å…·ä½“ä»£ç è§é¡¹ç›®ç›®å½•todolist,ä¸‹é¢å°±ä¸ä¸€ä¸€è´´ä»£ç äº†ã€‚å°±è®²ä¸‹é‡ç‚¹ã€‚ ä¸‹é¢æˆ‘å°±é¡ºç€ä¾èµ–å…³ç³»æ¥è®²ï¼Œæ‰€ä»¥å…ˆä» mysql å¼€å§‹è®²èµ· æ„å»º mysqlæ‰§è¡Œï¼šdocker run --name mymysql -d -p 3308:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql â€“name ç»™ mysql å®¹å™¨è®¾ç½®åŒ¿å -d è¡¨ç¤ºåå°è¿è¡Œ -p è¡¨ç¤ºå°†å®¹å™¨çš„ 3306 ç«¯å£çš„æ˜ å°„åˆ°æœ¬åœ°çš„ 3308 ç«¯å£ï¼Œå¦‚æœä¸è®¾ç½®çš„è¯ï¼Œæœ¬åœ°æ˜¯æ— æ³•è®¿é—®è¯¥ MySQL æœåŠ¡çš„ã€‚ -e MYSQL_ROOT_PASSWORD è®¾ç½® root çš„è´¦å·å¯†ç ã€‚ mysql åé¢ä¸æŒ‡å®šç‰ˆæœ¬è¯ï¼Œé»˜è®¤ä¼š latest ç‰ˆæœ¬ åœ¨æ‰§è¡Œè¯¥è¯­å¥ä¹‹å‰ï¼Œå‡å¦‚ä½ ä¹‹å‰æ²¡æœ‰ pull è¿‡ mysql é•œåƒã€‚docker åœ¨æœ¬åœ°æ‰¾ä¸åˆ°ä½ è¦çš„é•œåƒå°±ä¼šå¸®ä½ ä» docker ä»“åº“æ‹‰å– mysql:latest é•œåƒã€‚ è¿™ä¸ªæ—¶å€™å®¹å™¨å°±å¯åŠ¨æˆåŠŸäº†ã€‚ å°è¯•ä¸‹ç”¨ navicat è¿æ¥ä¸‹è¯•è¯• é¼ æ ‡æ”¾å…¥é»„è‰²å°ä¸‰è§’å‡ºç°å¦‚ä¸‹æŠ¥é”™ã€‚ 12013 - Lost connection to MySQL server at 'reading initial communication packet', system error: 0 \"Internal error/check (Not system error)\" è¿™æ˜¯å› ä¸º mysql8 ä»¥ä¸Šï¼Œéƒ½ä¼šä½¿ç”¨æ–°çš„éªŒè¯æ–¹å¼ã€‚ ä¸å¦¨æŸ¥ä¸‹ä¿¡æ¯: select host,user,plugin,authentication_string from mysql.user; 12345678910mysql&gt; select host,user,plugin,authentication_string from mysql.user;+-----------+------------------+-----------------------+------------------------------------------------------------------------+| host | user | plugin | authentication_string |+-----------+------------------+-----------------------+------------------------------------------------------------------------+| % | root | caching_sha2_password | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 || localhost | mysql.infoschema | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED || localhost | mysql.session | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED || localhost | mysql.sys | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |)7k44VulAglQJgGpvgSG.ylA/rdbkqWjiqQJiq3DGsug5HIy3 |ord | $A$005$0pU+sGm[on+-----------+------------------+-----------------------+------------------------------------------------------------------------+ plugin ä¸€æ å¯çœ‹åˆ°éƒ½æ˜¯ caching_sha2_passwordã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å°†å…¶æ”¹æˆå¯è¿æ¥çš„å‘¢ï¼Ÿåªéœ€è¦å°†å…¶ plugin æ”¹æˆ mysql_native_password å°±å¯ä»¥è®¿é—®äº†ã€‚ ALTER user 'root'@'%' IDENTIFIED WITH mysql_native_password BY '123456'; ä½ å¯ä»¥å…ˆç”¨ä¸Šé¢æŸ¥è¯¢è´¦æˆ·ä¿¡æ¯æŸ¥ä¸‹æ˜¯å¦ä¿®æ”¹æˆåŠŸäº†ã€‚ ä¿®æ”¹æˆåŠŸåï¼Œå¯ä»¥å°è¯•ä¸‹ç”¨ navicat è¿æ¥ä¸‹ mysqlã€‚ä¸å‡ºæ„å¤–çš„è¯å°±èƒ½æˆåŠŸè¿æ¥ä¸Šäº†ã€‚ å½“ç„¶æˆ‘ä¸‹é¢çš„ä¾‹å­ç”¨ mysql:5.6ï¼Œæ–¹ä¾¿æ“ä½œï¼Œä¸éœ€è¦ä¿®æ”¹ pluginã€‚ æ‰§è¡Œå‘½ä»¤ï¼šdocker run --name mymysql -d -e MYSQL_ROOT_PASSWORD=123456 -p 3308:3306 mysql:5.6 å¯åŠ¨å®¹å™¨åå¯ä»¥æ‰§è¡Œï¼šdocker exec -it mymysql bashè¿›å…¥å®¹å™¨ æ‰§è¡Œï¼šmysql -uroot -p123456è¿›å…¥ mysql æ§åˆ¶å° æ‰§è¡Œï¼šshow databases;æŸ¥çœ‹ mysql æ•°æ®åº“ 123456789mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema |+--------------------+3 rows in set (0.00 sec) æ‰§è¡Œï¼šcreate database todolist;åˆ›å»º todolist åº”ç”¨çš„æ•°æ®åº“ æ‰§è¡Œï¼šshow databases;æŸ¥çœ‹åˆšåˆšåˆ›å»ºçš„ todolist æ•°æ®åº“ 12345678910mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || todolist |+--------------------+4 rows in set (0.00 sec) å¯ä»¥çœ‹åˆ°æ•°æ®åº“ä¸­å¤šäº†ä¸ª todolist æ•°æ®åº“ æ¥ä¸‹æ¥é€‰æ‹©è¯¥ todolist æ•°æ®åº“ æ‰§è¡Œï¼šuse todolist;é€‰ä¸­è¯¥æ•°æ®åº“ åˆ›å»ºè¡¨: 12345CREATE TABLE list ( id INT(11) AUTO_INCREMENT PRIMARY KEY, text VARCHAR(255), checked INT(11) DEFAULT 0 ); æ‰§è¡Œï¼šshow tables;æŸ¥çœ‹ todolist æ•°æ®åº“ä¸‹çš„è¡¨ 1234567mysql&gt; show tables;+--------------------+| Tables_in_todolist |+--------------------+| list |+--------------------+1 row in set (0.00 sec) æ‰§è¡Œï¼šdescribe list;æŸ¥çœ‹è¡¨ 123456789mysql&gt; describe list;+---------+--------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+---------+--------------+------+-----+---------+----------------+| id | int(11) | NO | PRI | NULL | auto_increment || text | varchar(255) | YES | | NULL | || checked | int(11) | YES | | 0 | |+---------+--------------+------+-----+---------+----------------+3 rows in set (0.01 sec) æ‰§è¡Œï¼šinsert into list set checked = 0, text = 'haha'; å¾€è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼› æ‰§è¡Œï¼šselect * from list; 1234567mysql&gt; select * from list;+----+------+---------+| id | text | checked |+----+------+---------+| 1 | haha | 0 |+----+------+---------+1 row in set (0.01 sec) ä¸€åˆ‡æ­£å¸¸ æ„å»º nodemysql æœåŠ¡å¯åŠ¨å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯åŠ¨ node æœåŠ¡ï¼Œå¹¶è¿æ¥åˆšå¯åŠ¨çš„ mysql æœåŠ¡äº†ã€‚ è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼Œè§£é‡Šçœ‹æ³¨é‡Š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// index.jsconst mysql = require('mysql'); // mysqlåŒ…const express = require('express');const app = express();const bodyParser = require('body-parser'); // postè¯·æ±‚éœ€è¦å¼•å…¥çš„åŒ…app.use(bodyParser.json());// mysqlé…ç½®ï¼ˆç”¨äºè¿æ¥åˆšå¯åŠ¨çš„mysqlæœåŠ¡ï¼‰const opt = { host: 'localhost', user: 'root', port: '3308', password: '123456', database: 'todolist'};const connection = mysql.createConnection(opt);const sqlFn = sql =&gt; { return new Promise((resolve, reject) =&gt; { connection.query(sql, (err, results, filelds) =&gt; { if (err) throw err; resolve(results); }); });};connection.connect(async err =&gt; { if (err) throw err; console.log('mysql connncted success!');});// todolist åˆ—è¡¨æŸ¥è¯¢app.get('/getList', async (req, res) =&gt; { const sql = `SELECT * FROM list`; const data = await sqlFn(sql); res.json({ code: 0, data, message: 'success' });});// todolist æ’å…¥æ•°æ®app.post('/insert', async (req, res) =&gt; { const sql = `INSERT INTO list SET checked = ${req.body.checked}, text = '${req.body.text}'`; const data = await sqlFn(sql); res.json({ code: 0, data, message: 'success' });});app.listen(3000); æ‰§è¡Œ: node index.jsåï¼Œæ§åˆ¶å°è¾“å…¥ 12âœ server git:(master) âœ— node index.jsmysql connncted success! è¡¨ç¤º node æœåŠ¡è¿æ¥ mysql æœåŠ¡æˆåŠŸï¼› æµè§ˆå™¨å¯ä»¥è®¿é—®ä¸‹localhost:3000/getList 1{\"code\":0,\"data\":[{\"id\":1,\"text\":\"haha\",\"checked\":0}],\"message\":\"success\"} é¡µé¢å°†ä¼šå‡ºç°åˆšæ‰æˆ‘ä»¬ sql æ’å…¥åˆ°æ•°æ®åº“çš„æ•°æ® æ—¢ç„¶ä»£ç æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±æŠŠä»–æ„å»ºæˆé•œåƒã€‚ æ„å»ºä¹‹å‰éœ€è¦æŠŠä»£ç ä¸­ opt çš„ host localhost æ”¹ä¸ºè‡ªå·±ä¸»æœºçš„ ipã€‚å› ä¸ºå®¹å™¨å¯åŠ¨çš„è¯ï¼Œè¿æ¥ mysql éœ€è¦é€šè¿‡ä¸»æœºçš„ 3308 ç«¯å£è®¿é—®ã€‚ åœ¨å½“å‰æ–‡ä»¶å¤¹æ–°å»ºåä¸º Dockerfile çš„æ–‡ä»¶ 12345678910# åŸºäºæœ€æ–°çš„ node é•œåƒFROM node:8# å¤åˆ¶å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åˆ°ç›®æ ‡é•œåƒ /app/ ç›®å½•ä¸‹COPY . /todolist/server# ä¿®æ”¹å·¥ä½œç›®å½•WORKDIR /todolist/server# å®‰è£…ä¾èµ–RUN [\"npm\", \"install\"]# å¯åŠ¨ node serverENTRYPOINT [\"node\", \"index.js\"] æ‰§è¡Œï¼šdocker build -t mynode .ï¼Œç”Ÿæˆ node é•œåƒ -t:è¡¨ç¤ºç»™è¯¥é•œåƒæ·»åŠ ç‰ˆæœ¬ï¼Œè¿™é‡Œä¸å†™é»˜è®¤ä¸º latest å¯é€šè¿‡docker imagesæŸ¥çœ‹æœ¬åœ°çš„é•œåƒã€‚ 123âœ server git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEmynode latest 3e8de2825063 4 seconds ago 898MB å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªé•œåƒå°±æ˜¯æˆ‘ä»¬åˆšåˆšæ„å»ºçš„é•œåƒ 123âœ server git:(master) âœ— docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEmynode latest 3e8de2825063 4 seconds ago 898MB æ¥ä¸‹æ¥è¿è¡ŒåŸºäºè¿™ä¸ªé•œåƒçš„å®¹å™¨ æ‰§è¡Œï¼šdocker run --name mynode -d -p 4000:3000 mynode â€“name ç»™ node å®¹å™¨èµ·ä¸€ä¸ªå®¹å™¨åŒ¿å -d è¡¨ç¤ºåå°è¿è¡Œ -p 4000:3000 è¡¨ç¤ºè®¿é—®æœ¬åœ° 4000 ä»£ç†å®¹å™¨å†…çš„ 3000 ç«¯å£æœåŠ¡ mynode æ˜¯ä¸Šé¢æˆ‘ä»¬ build æ„å»ºçš„é•œåƒ å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®ä¸‹localhost:4000/getList 1{\"code\":0,\"data\":[{\"id\":1,\"text\":\"haha\",\"checked\":0}],\"message\":\"success\"} å¯ä»¥çœ‹åˆ°é¡µé¢è¾“å‡ºæˆ‘ä»¬ä¸Šé¢æ‰§è¡Œ sql è¯­å¥æ’å…¥çš„æ•°æ® ä¸Šé¢è´´çš„ä»£ç åªæ˜¯åŸºç¡€çš„æŸ¥çœ‹åˆ—è¡¨ä¸æ’å…¥æ•°æ®ä¸¤ä¸ªæ–¹æ³•ï¼Œå…¶ä»–çš„è¯·å‚è€ƒserver æ„å»º vuetodolist çš„é™æ€é¡µé¢ï¼Œæˆ‘æ˜¯é€šè¿‡ vue-cli3 æ­å»ºçš„ã€‚æ‰§è¡Œvue create app åˆ›å»ºé¡¹ç›®ã€‚ è¿›å…¥é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œnpm run serveé¡µé¢æ˜¯å¦æ­£å¸¸æ‰§è¡Œã€‚ ç„¶åç¼–å†™ç®€æ˜“çš„å…·æœ‰å¢åˆ æ”¹æŸ¥çš„ todolist åº”ç”¨ã€‚å…·ä½“ä»£ç è§todolistã€‚ æ³¨æ„ vue.config.js ä¸­çš„ devServer é…ç½®çš„ target: â€˜http://127.0.0.1:4000'ä»£ç†åˆ°æˆ‘ä»¬åˆšå¯åŠ¨çš„nodeå®¹å™¨ é¡µé¢å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®localhost:8080 å¯ä»¥çœ‹åˆ°é¡µé¢åŠ è½½æˆåŠŸï¼Œåˆ—è¡¨ä¹ŸæˆåŠŸæ¸²æŸ“å‡ºä¸Šé¢æ„å»º mysql æ—¶ï¼Œsql æ’å…¥çš„æ•°æ®ã€‚ æœ¬åœ°å¯åŠ¨é™æ€å¹¶è¯·æ±‚æœåŠ¡ç«¯æˆåŠŸåï¼Œæ¥ä¸‹æ¥ä¹Ÿå°†é™æ€é¡µé¢æ‰“åŒ…æˆé•œåƒï¼Œç„¶åå¯åŠ¨é™æ€é¡µé¢å®¹å™¨ åœ¨æ‰“åŒ…é•œåƒå®¹å™¨ä¹‹å‰ï¼Œè®°å¾—å…ˆå°† vue.config.js ä¸­çš„ devServer é…ç½®çš„ target: â€˜http://&lt;ä¸»æœº ip åœ°å€&gt;:4000â€™ä»£ç†åˆ°æˆ‘ä»¬åˆšå¯åŠ¨çš„ node å®¹å™¨ ç¼–å†™ Dockerfile 12345678910# åŸºäºæœ€æ–°çš„ node é•œåƒFROM node:8# å¤åˆ¶å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åˆ°ç›®æ ‡é•œåƒ /app/ ç›®å½•ä¸‹COPY . /todolist/app# ä¿®æ”¹å·¥ä½œç›®å½•WORKDIR /todolist/appRUN npm config set registry https://registry.npm.taobao.org &amp;&amp; npm install# RUN [\"npm\", \"install\"]# å¯åŠ¨ node serverENTRYPOINT [\"npm\", \"run\", \"serve\"] cd åˆ°é™æ€é¡µé¢çš„æ ¹ç›®å½•æ‰§è¡Œ: docker build -t static . æ‰§è¡Œï¼šdocker run --name static -d -p 9000:8080 staticå¯åŠ¨é™æ€å®¹å™¨ æ‰“å¼€æµè§ˆå™¨è®¿é—®localhost:9000,å¯ä»¥çœ‹åˆ°é¡µé¢æˆåŠŸæ¸²æŸ“å‡ºåˆ—è¡¨é¡µã€‚ è‡³æ­¤ï¼Œmysqlã€nodeã€vue å®¹å™¨å‡å·²äº’é€šã€‚ä»£ç éœ€è¦å®Œå–„çš„åœ°æ–¹è¯¦è§todolist docker-composeæˆ‘ä»¬ä¸å¯èƒ½æ¯æ¬¡éƒ¨ç½²ä¸€ä¸ªåº”ç”¨ï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨å¥½å‡ ä¸ªæœåŠ¡ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨docker-compose å…³äºå‘½ä»¤å°±ä¸ä»‹ç»äº†ï¼Œè¿™é‡Œè´´ä¸‹é“¾æ¥docker-compose å‘½ä»¤ åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºdocker-compose.ymlé…ç½®æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233version: '2'services: static: build: ./app/ container_name: static ports: - 7001:8080 depends_on: - nodejs - db nodejs: build: context: ./server/ dockerfile: sleep-dockerfile container_name: nodejs ports: - 4000:3000 environment: - IS_START_BY_COMPOSE=1 command: sh ./sleep.sh depends_on: - db db: image: mysql:5.6 container_name: db environment: MYSQL_ROOT_PASSWORD: \"123456\" command: --default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 å…·ä½“é…ç½®ï¼Œè¯¦è§ä¸Šé¢è´´çš„é“¾æ¥ã€‚ä¸‹é¢æˆ‘ä»‹ç»ä¸‹æˆ‘æ‰€å†™çš„é…ç½® version: docker-compose çš„ç‰ˆæœ¬ services: ä»£è¡¨ä½ ç”¨ docker-compose å¯åŠ¨çš„å‡ ä¸ªæœåŠ¡ build: æŒ‡å®š Dockerfile æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ–è€…ç›¸å¯¹ docker-compose.yml æ–‡ä»¶çš„è·¯å¾„ï¼‰ã€‚ Compose å°†ä¼šåˆ©ç”¨å®ƒè‡ªåŠ¨æ„å»ºè¿™ä¸ªé•œåƒï¼Œç„¶åä½¿ç”¨è¿™ä¸ªé•œåƒã€‚ container_name: æŒ‡å®šå®¹å™¨åç§°ã€‚ ports: ç›¸å½“äº docker run å¯åŠ¨å®¹å™¨çš„-pï¼Œ&lt;ä¸»æœº ip:å®¹å™¨ ip&gt;ï¼Œè¿™æ ·ä¸»æœºé€šè¿‡è¿™ä¸ªç«¯å£å»è®¿é—®å®¹å™¨ä¸­çš„æœåŠ¡ã€‚ environment: åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨è·å–è¿è¡Œ Compose ä¸»æœºä¸Šå¯¹åº”å˜é‡çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ®ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯åœ¨å®¹å™¨å†…å¯ä»¥è·å–ç»™çš„ç¯å¢ƒå˜é‡ã€‚ depends_on: è§£å†³å®¹å™¨çš„ä¾èµ–ã€å¯åŠ¨å…ˆåçš„é—®é¢˜ã€‚ï¼ˆä½†æ˜¯å®ƒæœ‰ä¸ªé—®é¢˜å°±æ˜¯åªæ˜¯ç­‰æ‰€ä¾èµ–çš„æœåŠ¡å¼€å¯å¯åŠ¨ï¼Œå¹¶ä¸æ˜¯ç­‰ä¾èµ–çš„æœåŠ¡å¯åŠ¨æˆåŠŸååœ¨æ„å»ºå½“å‰çš„æœåŠ¡ã€‚ command: è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ æ¥ä¸‹æ¥è§£é‡Šä¸‹ä¸Šé¢ç”¨ compose å¯åŠ¨çš„æœåŠ¡ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œmysql çš„ Dockerfile ä¸­åšäº†åˆ›å»ºæ•°æ®åº“ä¸è¡¨çš„æ“ä½œã€‚ä¼šæ¶‰åŠåˆ°å…³é—­æ•°æ®åº“å¯†ç ç™»å½•åŠŸèƒ½ã€‚å› ä¸ºå…³é—­ä¹‹åï¼Œæ“ä½œæ•°æ®åº“å°±ä¸éœ€è¦è¾“å…¥å¯†ç äº†ã€‚ç­‰è¡¨å»ºå®Œä¹‹ååœ¨æ¢å¤å¯†ç ã€‚nodejs ä¸­çš„ sleep.sh è„šæœ¬æ˜¯å› ä¸º depends_on è¿™ä¸ªä¾èµ–åªæ˜¯å•çº¯çš„ç­‰å¾…å…¶ä»–æœåŠ¡å¼€å§‹å¯åŠ¨ï¼Œå¹¶ä¸æ˜¯ç­‰å¾…ä¾èµ–çš„æœåŠ¡å¯åŠ¨å®Œæˆä¹‹åæ‰å¼€å§‹æ„å»ºè‡ªèº«çš„æœåŠ¡ã€‚è¿™ä¸ªæ—¶å€™ node åˆå§‹åŒ–ä¼šåœ¨ mysql å¯åŠ¨å®Œæˆä¹‹å‰å¯åŠ¨ã€‚è¿™æ ·çš„è¯ï¼Œnode å¯åŠ¨çš„æ—¶å€™è¿æ¥ mysql å°±ä¼šæŠ¥é”™ï¼Œå¯¼è‡´ node æœåŠ¡æŒ‚æ‰ã€‚æ‰€ä»¥å¼•ç”¨äº† sleep.shï¼Œè®© node å»¶è¿Ÿä¸€æ®µæ—¶é—´å¯åŠ¨ã€‚ æœ€ååœ¨docker-composeæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ‰§è¡Œdocker-compose build å†æ‰§è¡Œï¼šdocker-compose upå°±å¯ä»¥å¯åŠ¨ todolist è¿™ä¸ªåº”ç”¨çš„æ‰€æœ‰æœåŠ¡äº†ã€‚","link":"/blog/2019/07/07/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%AE%9E%E6%88%98-%E5%AE%9E%E6%88%98%E7%AF%87/"},{"title":"å‰ç«¯å¿…é¡»çŸ¥é“çš„nginxçŸ¥è¯†","text":"å‰ç«¯å¼€å‘è€…è¿›é˜¶ä¹‹è·¯ä¸å¾—ä¸å­¦ nginxã€‚ æœ¬æ–‡å†…å®¹æ¶‰åŠ nginx å‘½ä»¤ é…ç½®æ–‡ä»¶ã€é…ç½®è§£é‡Š å˜é‡ æ—¥å¿— è·¨åŸŸ ä»£ç†è¯·æ±‚ location æ‹¦æˆªè¯¦è§£ gzip é˜²ç›—é“¾ åå‘ä»£ç†ã€æ­£å‘ä»£ç† è´Ÿè½½å‡è¡¡ ç¼“å­˜ rewrite æ­£æ–‡å‘½ä»¤ nginx -T æŸ¥çœ‹å½“å‰ nginx æœ€ç»ˆçš„é…ç½® nginx -t æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ nginx -s reload å‘ä¸»è¿›ç¨‹å‘é€ä¿¡å·ï¼Œé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ nginx -s stop å¿«é€Ÿå…³é—­ nginx -s quit ç­‰å¾…å·¥ä½œè¿›ç¨‹å¤„ç†å®Œæˆåå…³é—­ é…ç½®æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556user nginx; # å®šä¹‰ Nginx è¿è¡Œçš„ç”¨æˆ·worker_processes 1; # è®¾ç½®å·¥ä½œè¿›ç¨‹çš„æ•°é‡error_log /var/log/nginx/error.log warn; #nginx é”™è¯¯æ—¥å¿—pid /var/run/nginx.pid; # nginx.pidå­˜æ”¾çš„æ˜¯nginxçš„masterè¿›ç¨‹çš„è¿›ç¨‹å·# eventsæ¨¡å—ä¸­åŒ…å«nginxä¸­æ‰€æœ‰å¤„ç†è¿æ¥çš„è®¾ç½®events { #å·¥ä½œè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°é‡ ç†è®ºä¸Šæ¯å°nginxæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°ä¸ºworker_processes*worker_connections worker_processesä¸ºæˆ‘ä»¬å†mainä¸­å¼€å¯çš„è¿›ç¨‹æ•° worker_connections 1024;}# æä¾›httpæœåŠ¡ç›¸å…³çš„ä¸€äº›é…ç½®å‚æ•°http { # include æ˜¯ä¸ªä¸»æ¨¡å—æŒ‡ä»¤ï¼Œå¯ä»¥å°†é…ç½®æ–‡ä»¶æ‹†åˆ†å¹¶å¼•ç”¨ï¼Œå¯ä»¥å‡å°‘ä¸»é…ç½®æ–‡ä»¶çš„å¤æ‚åº¦, è¿™é‡Œæ˜¯åŠ è½½ä¸€äº›æ–‡ä»¶ç±»å‹ include /etc/nginx/mime.types; # default_type å±äºHTTPæ ¸å¿ƒæ¨¡å—æŒ‡ä»¤ï¼Œè¿™é‡Œè®¾å®šé»˜è®¤ç±»å‹ä¸ºäºŒè¿›åˆ¶æµï¼Œä¹Ÿå°±æ˜¯å½“æ–‡ä»¶ç±»å‹æœªå®šä¹‰æ—¶ä½¿ç”¨è¿™ç§æ–¹å¼ default_type application/octet-stream; # å®šä¹‰æ—¥å¿—æ ¼å¼ log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"'; # å®šä¹‰æœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿— access_log /var/log/nginx/access.log main; sendfile on; #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹ æˆoff sendfile on; tcp_nopush on; keepalive_timeout 65; #gzipæ¨¡å—è®¾ç½® gzip on; #å¼€å¯gzipå‹ç¼©è¾“å‡º gzip_min_length 1k; #æœ€å°å‹ç¼©æ–‡ä»¶å¤§å° gzip_buffers 4 16k; #å‹ç¼©ç¼“å†²åŒº gzip_http_version 1.0; #å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰ gzip_comp_level 2; #å‹ç¼©ç­‰çº§ limit_zone crawler $binary_remote_addr 10m; #å¼€å¯é™åˆ¶IPè¿æ¥æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨ server { listen 80; # è¡¨ç¤ºhttpç›‘å¬çš„ç«¯å£ server_name localhost; # åŸŸåå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€ å½“å‡ºç°å¤šä¸ªserverç›‘å¬çš„ç«¯å£ä¸€æ ·æ—¶ï¼Œå¯é€šè¿‡server_name åšåŒºåˆ† # æœ‰äº›æŒ‡ä»¤å¯ä»¥æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ location / { # ç”¨äºåŒ¹é…URIï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ç”¨æ­£åˆ™çš„æ–¹å¼åŒ¹é… ~ è¡¨ç¤ºå¤§å°å†™æ•æ„Ÿ ~*è¡¨ç¤ºå¤§å°å†™ä¸æ•æ„Ÿ root html; # æŒ‡å®šäº†é™æ€æ–‡ä»¶çš„æ ¹ç›®å½• index index.html index.htm; } error_page 500 502 503 504 /50x.html; # è¡¨ç¤ºå½“åœ¨500 502 503 504 é”™è¯¯ç çš„æ—¶å€™é‡å®šå‘åˆ° /50x.html location = /50x.html { root html; } } include /etc/nginx/conf.d/*.conf; # ç”¨äºåŠ è½½å…¶ä»–é…ç½®æ–‡ä»¶è¿›æ¥} å˜é‡ å­—æ®µ è¯´æ˜ $arg_PARAMETER è¿™ä¸ªå˜é‡å€¼ä¸ºï¼šGET è¯·æ±‚ä¸­å˜é‡å PARAMETER å‚æ•°çš„å€¼ã€‚ $args è¿™ä¸ªå˜é‡ç­‰äº GET è¯·æ±‚ä¸­çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œfoo=123&amp;bar=blahblah;è¿™ä¸ªå˜é‡åªå¯ä»¥è¢«ä¿®æ”¹ $binary_remote_addr äºŒè¿›åˆ¶ç å½¢å¼çš„å®¢æˆ·ç«¯åœ°å€ã€‚ $body_bytes_sent ä¼ é€é¡µé¢çš„å­—èŠ‚æ•° $content_length è¯·æ±‚å¤´ä¸­çš„ Content-length å­—æ®µã€‚ $content_type è¯·æ±‚å¤´ä¸­çš„ Content-Type å­—æ®µã€‚ $cookie_COOKIE cookie COOKIE çš„å€¼ã€‚ $document_root å½“å‰è¯·æ±‚åœ¨ root æŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼ã€‚ $document_uri ä¸ $uri ç›¸åŒã€‚ $host è¯·æ±‚ä¸­çš„ä¸»æœºå¤´(Host)å­—æ®µï¼Œå¦‚æœè¯·æ±‚ä¸­çš„ä¸»æœºå¤´ä¸å¯ç”¨æˆ–è€…ç©ºï¼Œåˆ™ä¸ºå¤„ç†è¯·æ±‚çš„ server åç§°(å¤„ç†è¯·æ±‚çš„ server çš„ server_name æŒ‡ä»¤çš„å€¼)ã€‚å€¼ä¸ºå°å†™ï¼Œä¸åŒ…å«ç«¯å£ã€‚ $hostname æœºå™¨åä½¿ç”¨ gethostname ç³»ç»Ÿè°ƒç”¨çš„å€¼ $http_HEADER HTTPè¯·æ±‚å¤´ä¸­çš„å†…å®¹ï¼ŒHEADER ä¸º HTTP è¯·æ±‚ä¸­çš„å†…å®¹è½¬ä¸ºå°å†™ï¼Œ-å˜ä¸º_(ç ´æŠ˜å·å˜ä¸ºä¸‹åˆ’çº¿)ï¼Œä¾‹å¦‚ï¼š$http_user_agent(Uaer-Agent çš„å€¼), $http_refererâ€¦; $sent_http_HEADER HTTPå“åº”å¤´ä¸­çš„å†…å®¹ï¼ŒHEADERä¸ºHTTPå“åº”ä¸­çš„å†…å®¹è½¬ä¸ºå°å†™ï¼Œ-å˜ä¸º_(ç ´æŠ˜å·å˜ä¸ºä¸‹åˆ’çº¿)ï¼Œ ä¾‹å¦‚ï¼š$sent_http_cache_control, $sent_http_content_typeâ€¦; $is_args å¦‚æœ$args è®¾ç½®ï¼Œå€¼ä¸ºâ€?â€ï¼Œå¦åˆ™ä¸ºâ€â€ã€‚ $limit_rate è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡ã€‚ $nginx_version å½“å‰è¿è¡Œçš„ nginx ç‰ˆæœ¬å·ã€‚ $query_string ä¸$args ç›¸åŒã€‚ $remote_addr å®¢æˆ·ç«¯çš„ IP åœ°å€ã€‚ $remote_port å®¢æˆ·ç«¯çš„ç«¯å£ã€‚ $remote_user å·²ç»ç»è¿‡ Auth Basic Module éªŒè¯çš„ç”¨æˆ·åã€‚ $request_filename å½“å‰è¿æ¥è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”± root æˆ– alias æŒ‡ä»¤ä¸ URI è¯·æ±‚ç”Ÿæˆã€‚ $request_body è¿™ä¸ªå˜é‡ï¼ˆ0.7.58+ï¼‰åŒ…å«è¯·æ±‚çš„ä¸»è¦ä¿¡æ¯ã€‚åœ¨ä½¿ç”¨ proxy_pass æˆ– fastcgi_pass æŒ‡ä»¤çš„ location ä¸­æ¯”è¾ƒæœ‰æ„ä¹‰ã€‚ $request_body_file å®¢æˆ·ç«¯è¯·æ±‚ä¸»ä½“ä¿¡æ¯çš„ä¸´æ—¶æ–‡ä»¶åã€‚ $request_completion å¦‚æœè¯·æ±‚æˆåŠŸï¼Œè®¾ä¸ºâ€OKâ€ï¼›å¦‚æœè¯·æ±‚æœªå®Œæˆæˆ–è€…ä¸æ˜¯ä¸€ç³»åˆ—è¯·æ±‚ä¸­æœ€åä¸€éƒ¨åˆ†åˆ™è®¾ä¸ºç©ºã€‚ $request_method è¿™ä¸ªå˜é‡æ˜¯å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸º GET æˆ– POSTã€‚åŒ…æ‹¬ 0.8.20 åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªå˜é‡æ€»ä¸º main request ä¸­çš„åŠ¨ä½œï¼Œå¦‚æœå½“å‰è¯·æ±‚æ˜¯ä¸€ä¸ªå­è¯·æ±‚ï¼Œå¹¶ä¸ä½¿ç”¨è¿™ä¸ªå½“å‰è¯·æ±‚çš„åŠ¨ä½œã€‚ $request_uri è¿™ä¸ªå˜é‡ç­‰äºåŒ…å«ä¸€äº›å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°çš„åŸå§‹ URIï¼Œå®ƒæ— æ³•ä¿®æ”¹ï¼Œè¯·æŸ¥çœ‹$uri æ›´æ”¹æˆ–é‡å†™ URIã€‚ $scheme æ‰€ç”¨çš„åè®®ï¼Œæ¯”å¦‚httpæˆ–è€…æ˜¯httpsï¼Œæ¯”å¦‚rewrite ^(.+)$ $scheme://example.com$1 redirect; $server_addr æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼ï¼Œå¦‚æœè¦ç»•å¼€ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™å¿…é¡»åœ¨ listen ä¸­æŒ‡å®šåœ°å€å¹¶ä¸”ä½¿ç”¨ bind å‚æ•°ã€‚ $server_name æœåŠ¡å™¨åç§°ã€‚ $server_port è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·ã€‚ $server_protocol è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯ HTTP/1.0 æˆ– HTTP/1.1ã€‚ æ—¥å¿—error_logè¡¨ç¤ºé”™è¯¯æ—¥å¿—ã€‚error_log /var/log/nginx/error.log warn; ã€‚é”™è¯¯æ—¥å¿—è®°å½•äº†è®¿é—®å‡ºé”™çš„ä¿¡æ¯ã€‚æœ‰åˆ©äºæˆ‘ä»¬æ’æŸ¥é”™è¯¯ã€‚ access_logè¡¨ç¤ºè®¿é—®æ—¥å¿—ã€‚éœ€è¦æŒ‡å®šæ—¥å¿—æ ¼å¼ log_formatã€‚é€šè¿‡è®¿é—®æ—¥å¿—æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç”¨æˆ·çš„ IP åœ°å€ã€æµè§ˆå™¨çš„ä¿¡æ¯ï¼Œè¯·æ±‚çš„å¤„ç†æ—¶é—´ç­‰ä¿¡æ¯ log_formatæ—¥å¿—æ ¼å¼å¯ä»¥ç»“åˆä¸Šé¢çš„å˜é‡ï¼Œæ¥æŒ‡å®šè®¿é—®æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ã€‚ å¦‚ï¼š 123456789log_format main '$host $document_uri $server_addr $remote_addr $remote_port';server { listen 5002; access_log /usr/local/etc/nginx/servers/access.log main; location / { root /usr/local/etc/nginx/servers; index index.html; }} å®šä¹‰äº†ä¸ªæ—¥å¿—æ ¼å¼ main ç„¶ååœ¨å°†access_logç»‘å®šæ—¥å¿—main è¾“å‡ºï¼š 1localhost /index.html 127.0.0.1 127.0.0.1 61517 å¯ä»¥çœ‹åˆ°ï¼Œaccess_log æŒ‰ç…§æˆ‘çš„ main æ—¥å¿—æ ¼å¼è¾“å‡ºäº†ã€‚ è·¨åŸŸç›¸ä¿¡ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œä½ è‚¯å®šçŸ¥é“ CORSã€‚ Access-Control-Allow-Origin | *;å…¶ä¸­ï¼Œorigin å‚æ•°çš„å€¼æŒ‡å®šäº†å…è®¸è®¿é—®è¯¥èµ„æºçš„å¤–åŸŸ URIã€‚å¯¹äºä¸éœ€è¦æºå¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æŒ‡å®šè¯¥å­—æ®µçš„å€¼ä¸ºé€šé…ç¬¦ï¼Œè¡¨ç¤ºå…è®¸æ¥è‡ªæ‰€æœ‰åŸŸçš„è¯·æ±‚ã€‚ Access-Control-Expose-Headers: X-My-Custom-Header, X-Another-Custom-Header åœ¨è·¨åŸŸè®¿é—®æ—¶ï¼ŒXMLHttpRequest å¯¹è±¡çš„ getResponseHeader()æ–¹æ³•åªèƒ½æ‹¿åˆ°ä¸€äº›æœ€åŸºæœ¬çš„å“åº”å¤´ï¼ŒCache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragmaï¼Œå¦‚æœè¦è®¿é—®å…¶ä»–å¤´ï¼Œåˆ™éœ€è¦æœåŠ¡å™¨è®¾ç½®æœ¬å“åº”å¤´ã€‚ Access-Control-Max-AgeAccess-Control-Max-Age å¤´æŒ‡å®šäº† preflight è¯·æ±‚çš„ç»“æœèƒ½å¤Ÿè¢«ç¼“å­˜å¤šä¹…;Access-Control-Max-Age: 86400 Access-Control-Allow-Credentials æŒ‡å®šäº†å½“æµè§ˆå™¨çš„ credentials è®¾ç½®ä¸º true æ—¶æ˜¯å¦å…è®¸æµè§ˆå™¨è¯»å– response çš„å†…å®¹ã€‚å½“ç”¨åœ¨å¯¹ preflight é¢„æ£€æµ‹è¯·æ±‚çš„å“åº”ä¸­æ—¶ï¼Œå®ƒæŒ‡å®šäº†å®é™…çš„è¯·æ±‚æ˜¯å¦å¯ä»¥ä½¿ç”¨ credentialsã€‚è¯·æ³¨æ„ï¼šç®€å• GET è¯·æ±‚ä¸ä¼šè¢«é¢„æ£€ï¼›å¦‚æœå¯¹æ­¤ç±»è¯·æ±‚çš„å“åº”ä¸­ä¸åŒ…å«è¯¥å­—æ®µï¼Œè¿™ä¸ªå“åº”å°†è¢«å¿½ç•¥æ‰ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹Ÿä¸ä¼šå°†ç›¸åº”å†…å®¹è¿”å›ç»™ç½‘é¡µ è¯ä¸å¤šå°‘ï¼Œä¸‹é¢å°±ç›´æ¥è´´ä»£ç ï¼š 1234567// index.jsimport axios from 'axios';axios.get('http://127.0.0.1:5556/api/abc').then(res =&gt; { console.log(res, 'res'); document.write(res);}); 1234567server { listen 5556; location /api { proxy_pass http://localhost:5000; add_header Access-Control-Allow-Origin *; }} å°† 5556 ç«¯å£çš„è¯·æ±‚è·¯å¾„ /api å¼€å¤´çš„ è½¬å‘åˆ° 5000 ç«¯å£çš„ node æœåŠ¡ä¸Šã€‚æ·»åŠ ä¸ŠAccess-Control-Allow-Origin *å°±å¯è§£å†³è·¨åŸŸé—®é¢˜ã€‚ ä»£ç†è¯·æ±‚ä»£ç†è¯·æ±‚å¯ä»¥çœ‹ä¸‹ä¸Šé¢çš„è·¨åŸŸã€‚æŠŠ 5556 ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ° 5000 ç«¯å£çš„æœåŠ¡ä¸Šã€‚ location æ‹¦æˆªè¯¦è§£ä¿®é¥°ç¬¦ =: ç²¾ç¡®åŒ¹é…è·¯å¾„ ~: è¡¨ç¤ºç”¨è¯¥ç¬¦å·åé¢çš„æ­£åˆ™å»åŒ¹é…è·¯å¾„ï¼ŒåŒºåˆ†å¤§å°å†™ ~*: è¡¨ç¤ºç”¨è¯¥ç¬¦å·åé¢çš„æ­£åˆ™å»åŒ¹é…è·¯å¾„ï¼Œä¸åŒºåˆ†å¤§å°å†™ ^~: è¡¨ç¤ºå¦‚æœè¯¥ç¬¦å·åé¢çš„å­—ç¬¦æ˜¯æœ€ä½³åŒ¹é…ï¼Œé‡‡ç”¨è¯¥è§„åˆ™ï¼Œä¸å†è¿›è¡Œåç»­çš„æŸ¥æ‰¾ã€‚ 12345678910111213141516171819location = / { [ configuration A ]}location / { [ configuration B ]}location /api/ { [ configuration C ]}location ^~ /static/ { [ configuration D ]}location ~* \\.(gif|jpg|jpeg)$ { [ configuration E ]} è¯·æ±‚/ç²¾å‡†åŒ¹é… Aï¼Œä¸å†å¾€ä¸‹æŸ¥æ‰¾ã€‚ è¯·æ±‚/index.html åŒ¹é… Bã€‚é¦–å…ˆæŸ¥æ‰¾åŒ¹é…çš„å‰ç¼€å­—ç¬¦ï¼Œæ‰¾åˆ°æœ€é•¿åŒ¹é…æ˜¯é…ç½® Bï¼Œæ¥ç€åˆæŒ‰ç…§é¡ºåºæŸ¥æ‰¾åŒ¹é…çš„æ­£åˆ™ã€‚ç»“æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå› æ­¤ä½¿ç”¨å…ˆå‰æ ‡è®°çš„æœ€é•¿åŒ¹é…ï¼Œå³é…ç½® Bã€‚ è¯·æ±‚/api/list åŒ¹é… Cã€‚é¦–å…ˆæ‰¾åˆ°æœ€é•¿åŒ¹é… Cï¼Œç”±äºåé¢æ²¡æœ‰åŒ¹é…çš„æ­£åˆ™ï¼Œæ‰€ä»¥ä½¿ç”¨æœ€é•¿åŒ¹é… Cã€‚ è¯·æ±‚/user/1.jpg åŒ¹é… Eã€‚é¦–å…ˆè¿›è¡Œå‰ç¼€å­—ç¬¦çš„æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æœ€é•¿åŒ¹é…é¡¹ Cï¼Œç»§ç»­è¿›è¡Œæ­£åˆ™æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åŒ¹é…é¡¹ Eã€‚å› æ­¤ä½¿ç”¨ Eã€‚ è¯·æ±‚/static/img.jpg åŒ¹é… Dã€‚é¦–å…ˆè¿›è¡Œå‰ç¼€å­—ç¬¦çš„æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æœ€é•¿åŒ¹é… Dã€‚ä½†æ˜¯ï¼Œç‰¹æ®Šçš„æ˜¯å®ƒä½¿ç”¨äº†^~ä¿®é¥°ç¬¦ï¼Œä¸å†è¿›è¡Œæ¥ä¸‹æ¥çš„æ­£åˆ™çš„åŒ¹é…æŸ¥æ‰¾ï¼Œå› æ­¤ä½¿ç”¨ Dã€‚è¿™é‡Œï¼Œå¦‚æœæ²¡æœ‰å‰é¢çš„ä¿®é¥°ç¬¦ï¼Œå…¶å®æœ€ç»ˆçš„åŒ¹é…æ˜¯ Eã€‚ è¯·æ±‚/router/pageA åŒ¹é… Bã€‚å› ä¸º B è¡¨ç¤ºä»»ä½•ä»¥/å¼€å¤´çš„ URL éƒ½åŒ¹é…ã€‚åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œåªæœ‰ B èƒ½æ»¡è¶³ï¼Œæ‰€ä»¥åŒ¹é… Bã€‚ gzipé…ç½®è¯´æ˜1234567891011121314151617# gzip é»˜è®¤off é»˜è®¤å…³é—­gzipgzip on;# gzip_min_length é»˜è®¤0# ä½œç”¨åŸŸ: http, server, location# è®¾ç½®å…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»headerå¤´ä¸­çš„Content-Lengthä¸­è¿›è¡Œè·å–ã€‚# é»˜è®¤å€¼æ˜¯0ï¼Œä¸ç®¡é¡µé¢å¤šå¤§éƒ½å‹ç¼©ã€‚# å»ºè®®è®¾ç½®æˆå¤§äº1kçš„å­—èŠ‚æ•°ï¼Œå°äº1kå¯èƒ½ä¼šè¶Šå‹è¶Šå¤§ã€‚ å³: gzip_min_length 1024gzip_min_length 1k;# gzip_comp_level é»˜è®¤ 1 èŒƒå›´ 1 ~ 9# ä½œç”¨åŸŸ: http, server, location# gzipå‹ç¼©æ¯”ï¼Œ1 å‹ç¼©æ¯”æœ€å°å¤„ç†é€Ÿåº¦æœ€å¿«ï¼Œ9 å‹ç¼©æ¯”æœ€å¤§ä½†å¤„ç†æœ€æ…¢ï¼ˆä¼ è¾“å¿«ä½†æ¯”è¾ƒæ¶ˆè€—cpuï¼‰ã€‚gzip_comp_level 6;# é»˜è®¤å€¼: gzip_types text/html# ä½œç”¨åŸŸ: http, server, location# åŒ¹é…MIMEç±»å‹è¿›è¡Œå‹ç¼©ï¼Œï¼ˆæ— è®ºæ˜¯å¦æŒ‡å®šï¼‰\"text/html\"ç±»å‹æ€»æ˜¯ä¼šè¢«å‹ç¼©çš„ã€‚# æ³¨æ„ï¼šå¦‚æœä½œä¸ºhttp serveræ¥ä½¿ç”¨ï¼Œä¸»é…ç½®æ–‡ä»¶ä¸­è¦åŒ…å«æ–‡ä»¶ç±»å‹é…ç½®æ–‡ä»¶gzip_types text/plain application/x-javascript text/css application/xml application/javascript application/json; ä»£ç æ¼”ç¤º12345678server { listen 9002; #gzip on; location / { root /usr/local/etc/nginx/servers/; index gzip.html; }} æˆ‘ä»¬å…ˆè®°å½•ä¸‹æœªå¼€å¯ gzip æ—¶åŠ è½½çš„æ–‡ä»¶å¤§å° size æ˜¾ç¤ºçš„æ˜¯ 1.3kb ç„¶åæˆ‘ä»¬å°† gzip æ³¨é‡Šå»æ‰çš„ç»“æœå¦‚ä¸‹ å¯ä»¥çœ‹åˆ°åªæœ‰ 300B äº†ï¼Œå½“ç„¶ä½ è¿˜å¯ä»¥æ ¹æ®å…¶ä»–é…ç½®ï¼Œæ¯”å¦‚æ¥æ§åˆ¶å‹ç¼©ç­‰çº§æ¥æ§åˆ¶è¾“å‡ºçš„å¤§å°ã€‚æˆ‘ä»¬å‰ç«¯é¡¹ç›®æ‰“åŒ…çš„æ—¶å€™å¯ä»¥å¼€å¯ gzipï¼Œè¿™æ · nginx å°±ä¸ç”¨åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œ gzip å‹ç¼©äº†ã€‚ é˜²ç›—é“¾1234567location ~ .*\\.(jpg|png|gif)$ { valid_referers none blocked 47.104.184.134; if ($invalid_referer) { return 403; } root /data/images;} valid_referers none | blocked | server_names | string â€¦.;none æ£€æµ‹ Referer å¤´åŸŸä¸å­˜åœ¨çš„è¯·æ±‚blocked æ£€æµ‹ Referer å¤´åŸŸçš„å€¼è¢«é˜²ç«å¢™æˆ–è€…ä»£ç†æœåŠ¡å™¨åˆ é™¤æˆ–ä¼ªè£…çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å¤´åŸŸçš„å€¼ä¸ä»¥â€œhttp://â€æˆ–è€…â€œhttpsï¼š//â€å¼€å¤´server_names è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª URL,æ£€æµ‹ Referer å¤´åŸŸçš„å€¼æ˜¯å¦æ˜¯è¿™äº› URL ä¸­çš„æŸä¸ªã€‚ä» nginx 0.5.33 ä»¥åæ”¯æŒä½¿ç”¨é€šé…ç¬¦â€œ*â€ã€‚ valid_referers ç”¨äºæ”¯æŒè®¿é—®è¯¥èµ„æºçš„ referers $invalid_referer è¿™ä¸ªå˜é‡ä¸º true è¡¨ç¤ºä¸ç¬¦åˆä¸Šé¢å®šä¹‰çš„è§„åˆ™ã€‚å°± return 403 åå‘ä»£ç†ã€æ­£å‘ä»£ç†æ­£å‘ä»£ç†123location / { proxy_pass http://$http_host$request_uri;} æ­£å‘ä»£ç†ä½ å¯ä»¥ç†è§£ä¸ºä»£ç†å®¢æˆ·ç«¯ï¼Œæ¯”å¦‚ VPNã€‚å› ä¸ºå›½å†…æ— æ³•è®¿é—®å›½å¤–çš„ç½‘ç«™ï¼Œæ‰€ä»¥é€šè¿‡å°†è¯·æ±‚è½¬å‘åˆ° VPN æœåŠ¡å™¨ï¼ŒVPN å°†ä½ çš„è¯·æ±‚åŸå°ä¸åŠ¨çš„è½¬å‘åˆ°å›½å¤–ç½‘å€ã€‚æ­£å‘ä»£ç†ï¼Œå®¢æˆ·ç«¯çŸ¥é“æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¸çŸ¥é“å®¢æˆ·ç«¯ã€‚ åå‘ä»£ç†æ¯”å¦‚è¯´ä¸‹é¢å°†ä¼šè®²åˆ°çš„è´Ÿè½½å‡è¡¡ã€‚æ‰€æœ‰è¯·æ±‚ç»Ÿä¸€èµ°åˆ°ä¸€ä¸ª nginx æœåŠ¡ä¸Šï¼Œç”±è¿™ä¸ª nginx æœåŠ¡è®²è¯·æ±‚åˆ†é…åˆ°å¤šå°æœåŠ¡å™¨ä¸Šã€‚ è´Ÿè½½å‡è¡¡ä»£ç æ¼”ç¤º12345.â”œâ”€â”€ 9004.htmlâ”œâ”€â”€ 9005.htmlâ”œâ”€â”€ 9006.htmlâ””â”€â”€ upstream.conf 12345678910111213141516171819202122232425262728293031323334server { listen 9004; location / { root /usr/local/etc/nginx/servers/; index 9004.html; }}server { listen 9005; location / { root /usr/local/etc/nginx/servers/; index 9005.html; }}server { listen 9006; location / { root /usr/local/etc/nginx/servers/; index 9006.html; }}upstream atie { server localhost:9004; server localhost:9005; server localhost:9006;}server { listen 9003; location / { proxy_pass http://atie; }} é€šè¿‡ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°æˆ‘é€šè¿‡è®¿é—® 9003 ç«¯å£ï¼Œå‡è¡¡åˆ°å…¶ä»–ç«¯å£ã€‚ æ‰“å¼€æµè§ˆå™¨è®¿é—® localhost:9003 å¯ä»¥çœ‹åˆ°é¡µé¢ä¼šåˆ†åˆ«åŠ è½½ 9004 ~ 9006.html é¡µé¢ é…ç½®ä»‹ç» çŠ¶æ€ æè¿° down ä¸å‚ä¸è´Ÿè½½å‡è¡¡ backup å¤‡ä»½çš„æœåŠ¡å™¨ max_fails å…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•° fail_timeout ç»è¿‡ max_fails å¤±è´¥åï¼ŒæœåŠ¡æš‚åœçš„æ—¶é—´ max_conns é™åˆ¶æœ€å¤§çš„æ¥æ”¶çš„è¿æ¥æ•° weight æƒé‡æ¯” 12345upstream atie { server localhost:9004 down; # è¿™é‡Œå¦‚æœåŠ äº†down è¡¨ç¤ºè´Ÿè½½å‡è¡¡çš„æ—¶å€™å°±ä¸ä¼šè½¬åˆ°è¿™ä¸ªæœåŠ¡ server localhost:9005 backup; # è¡¨ç¤ºå¤‡ä»½ åªæœ‰å½“æœåŠ¡æŒ‚äº†ï¼Œæ‰ä¼šèµ°åˆ°è¿™ä¸ªå¤‡ä»½æœåŠ¡ä¸Š server localhost:9006 max_fails=1 fail_timeout=10s; # è¶…è¿‡æœ€å¤§æ¬¡æ•°åï¼Œåœ¨fail_timeoutæ—¶é—´å†…ï¼Œæ–°çš„è¯·æ±‚å°†ä¸ä¼šåˆ†é…ç»™è¿™å°æœºå™¨ã€‚} 12345upstream atie { server localhost:9004 weight=1; server localhost:9005 weight=2; server localhost:9006 weight=3;} å½“ä½ è®¿é—® 6 æ¬¡æ—¶ï¼Œä¸€æ¬¡èµ°åˆ° 9004 2 æ¬¡èµ°åˆ° 9005 3 æ¬¡èµ°åˆ° 9006 ç¼“å­˜é€šè¿‡æ·»åŠ ç¼“å­˜è¯·æ±‚å¤´è®¾ç½®è¿‡æœŸæ—¶é—´ç­‰ 123location ~ .*\\.(gif|jpg|png|css|js)(.*) { expires 90d; # è®¾ç½®æœ‰æ•ˆ90å¤©} rewriterewrite åŠŸèƒ½å°±æ˜¯ï¼Œä½¿ç”¨ nginx æä¾›çš„å…¨å±€å˜é‡æˆ–è‡ªå·±è®¾ç½®çš„å˜é‡ï¼Œç»“åˆæ­£åˆ™è¡¨è¾¾å¼å’Œæ ‡å¿—ä½å®ç° url é‡å†™ä»¥åŠé‡å®šå‘ã€‚rewrite åªèƒ½æ”¾åœ¨ server{},location{},if{}ä¸­ï¼Œå¹¶ä¸”åªèƒ½å¯¹åŸŸååè¾¹çš„é™¤å»ä¼ é€’çš„å‚æ•°å¤–çš„å­—ç¬¦ä¸²èµ·ä½œç”¨ 1234567location / { rewrite /rewrite/(.*) http://www.$1.com; return 200 \"ok\";}# åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ 127.0.0.1:8080/rewrite/google# åˆ™ä¸´æ—¶é‡å®šå‘åˆ° www.google.com# åé¢çš„ return æŒ‡ä»¤å°†æ²¡æœ‰æœºä¼šæ‰§è¡Œäº†","link":"/blog/2019/09/01/%E5%89%8D%E7%AB%AF%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84nginx%E7%9F%A5%E8%AF%86/"},{"title":"æ‰‹å†™Promise","text":"ğŸ˜† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168class TPromise { static PENDING = 'PENDING'; static RESOLVED = 'RESOLVED'; static REJECTED = 'REJECTED'; constructor(handler) { // ä¸‹é¢é˜Ÿåˆ—ç”¨äºå­˜å‚¨æ–¹æ³• this.resolveQueues = []; this.rejectQueues = []; this.finallyQueues = []; this.state = TPromise.PENDING; handler(this._resolve.bind(this), this._reject.bind(this)); } _resolve(val) { // å› ä¸ºpromiseæ˜¯å¾®ä»»åŠ¡ï¼Œè¿™é‡Œä½¿ç”¨MutationObserveræ¥æ¨¡æ‹Ÿå¾®ä»»åŠ¡ let observer = new MutationObserver(() =&gt; { // ä¸€æ—¦çŠ¶æ€æœºä¿®æ”¹è¿‡çŠ¶æ€ï¼Œé‚£ä¹ˆå°±æ— æ³•å†æ”¹å˜çŠ¶æ€ if (this.state !== TPromise.PENDING) return; this.state = TPromise.RESOLVED; this.value = val; let handler; while ((handler = this.resolveQueues.shift())) { handler(this.value); } while ((handler = this.finallyQueues.shift())) { handler(); } }); observer.observe(document.body, { attributes: true }); document.body.setAttribute('_promise', Date.now()); } _reject(val) { // å› ä¸ºpromiseæ˜¯å¾®ä»»åŠ¡ï¼Œè¿™é‡Œä½¿ç”¨MutationObserveræ¥æ¨¡æ‹Ÿå¾®ä»»åŠ¡ let observer = new MutationObserver(() =&gt; { // ä¸€æ—¦çŠ¶æ€æœºä¿®æ”¹è¿‡çŠ¶æ€ï¼Œé‚£ä¹ˆå°±æ— æ³•å†æ”¹å˜çŠ¶æ€ if (this.state !== TPromise.PENDING) return; this.state = TPromise.REJECTED; this.value = val; let handler; while ((handler = this.rejectQueues.shift())) { handler(this.value); } while ((handler = this.finallyQueues.shift())) { handler(); } }); observer.observe(document.body, { attributes: true }); document.body.setAttribute('_promise', Date.now()); } then(resolveHandler, rejectHandler) { // æ¯ä¸€ä¸ªthenéƒ½æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„promise return new TPromise((resolve, reject) =&gt; { if (typeof resolveHandler === 'function') { const newResolveHandler = val =&gt; { let result = resolveHandler(val); if (result instanceof TPromise) { // å¦‚æœè¿”å›çš„ç»“æœæ˜¯ä¸ªpromiseå®ä¾‹çš„è¯ï¼Œè°ƒç”¨ä¸‹é¢æ–¹æ³• result.then(resolve, reject); } else { resolve(result); } }; // promiseæ¯æ¬¡resolveçš„æ—¶å€™ï¼Œéƒ½ä¼šå»æ‰§è¡ŒresolveQueuesé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ–¹æ³• this.resolveQueues.push(newResolveHandler); } else { // promiseæ¯æ¬¡resolveçš„æ—¶å€™ï¼Œéƒ½ä¼šå»æ‰§è¡ŒresolveQueuesé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ–¹æ³• this.resolveQueues.push(resolve); } if (typeof rejectHandler === 'function') { const newRejectHandler = val =&gt; { let result = rejectHandler(val); if (result instanceof TPromise) { result.then(resolve, reject); } else { resolve(result); } }; this.rejectQueues.push(newRejectHandler); } else { this.rejectQueues.push(reject); } }); } catch(rejectHandler) { // catch å®è´¨ä¸Šæ˜¯thençš„ä¸€ç§ç®€å†™ return this.then(undefined, rejectHandler); } finally(finallyHandler) { return new TPromise((resolve, reject) =&gt; { if (typeof finallyHandler === 'function') { const newFinallyHandler = () =&gt; { const result = finallyHandler(); if (result instanceof TPromise) { result.finally(() =&gt; { if (this.state === TPromise.RESOLVED) resolve(this.value); else if (this.state === TPromise.REJECTED) reject(this.value); }); } else { if (this.state === TPromise.RESOLVED) resolve(this.value); else if (this.state === TPromise.REJECTED) reject(this.value); } }; this.finallyQueues.push(newFinallyHandler); } }); } // all åªæœ‰å½“æ‰€æœ‰promiseéƒ½æˆåŠŸè¿”å›æ—¶ï¼Œæ‰resolve static all(arr) { let i = 0; const resArr = []; return new TPromise((resolve, reject) =&gt; { arr.forEach((it, index) =&gt; { it.then(res =&gt; { i++; resArr[index] = res; if (i &gt;= arr.length) { resolve(resArr); } }).catch(err =&gt; { reject(err); }); }); }); } // race è¿”å›ç¬¬ä¸€ä¸ªæœ‰ç»“æœçš„promise static race(arr) { return new TPromise((resolve, reject) =&gt; { arr.forEach((it, index) =&gt; { it.then(res =&gt; { resolve(res); }).catch(err =&gt; { reject(err); }); }); }); } static resolve(val) { return new TPromise((resolve, reject) =&gt; { if (val instanceof TPromise) { val.then(resolve, reject); } else { resolve(val); } }); } // æ³¨æ„reject ä¼šåŸå°ä¸åŠ¨çš„å°†å‚æ•°è¿”å› static reject(val) { return new TPromise((resolve, reject) =&gt; { reject(val); }); }}","link":"/blog/2019/09/12/%E6%89%8B%E5%86%99Promise/"},{"title":"å‘½ä»¤è¡Œç¿»è¯‘æ’ä»¶","text":"@zhouatie/fanyi è¯´æ˜å¹³æ—¶å¼€å‘çš„æ—¶å€™ï¼Œé‡åˆ°ä¸ä¼šçš„å•è¯ï¼Œæ€»è¦æ‰“å¼€ ä¸€ä¸ªç¿»è¯‘è½¯ä»¶ï¼Œæˆ–è€…æµè§ˆå™¨ç¿»è¯‘æ’ä»¶å»æŸ¥ã€‚æ‰€ä»¥å°±æƒ³å¼€å‘ä¸€ä¸ªå‘½ä»¤è¡Œç¿»è¯‘æ’ä»¶ï¼Œå¹¶å‘å¸ƒåˆ° npm åº“ä¸Šä¾›å¤§å®¶ä½¿ç”¨ã€‚å¦‚æœæœ‰å¸®åŠ©åˆ°ä½ çš„è¯ï¼Œå¯ä»¥ç»™æˆ‘ä»“åº“æ¥ä¸ª starğŸ˜† å®‰è£…npm i @zhouatie/fanyi -g ä½¿ç”¨ç¿»è¯‘è‹±æ–‡12345678# ç¿»è¯‘å•è¯appleçš„æ„æ€fanyi apple----------------------è‹± [ËˆÃ¦pl] ç¾ [ËˆÃ¦pl]n. è‹¹æœï¼Œè‹¹æœæ ‘ï¼Œè‹¹æœä¼¼çš„ä¸œè¥¿ï¼›[ç¾ä¿š]ç‚¸å¼¹ï¼Œæ‰‹æ¦´å¼¹ï¼Œï¼ˆæ£’çƒçš„ï¼‰çƒï¼›[ç¾ä¿š]äººï¼Œå®¶ä¼™ã€‚ 123456# ç¿»è¯‘å¥å­fanyi my name is bob---------------æˆ‘å«é²å‹ƒ ç¿»è¯‘ä¸­æ–‡1234567fanyi è‹¹æœ----------è‹¹æœ [pÃ­ng guÇ’][å›­è‰º] apple 12345fanyi æˆ‘æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆ-----------I'm a front end engineer TODO æ”¯æŒå¥å­ç¿»è¯‘ åŠ å…¥ commonader æ”¯æŒé€‰æ‹©å¤šä¸ªç¿»è¯‘å¹³å°","link":"/blog/2019/11/25/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BF%BB%E8%AF%91%E6%8F%92%E4%BB%B6/"}],"tags":[{"name":"plugin","slug":"plugin","link":"/blog/tags/plugin/"},{"name":"image-preview","slug":"image-preview","link":"/blog/tags/image-preview/"},{"name":"node","slug":"node","link":"/blog/tags/node/"},{"name":"formdata","slug":"formdata","link":"/blog/tags/formdata/"},{"name":"react","slug":"react","link":"/blog/tags/react/"},{"name":"socket.io","slug":"socket-io","link":"/blog/tags/socket-io/"},{"name":"js","slug":"js","link":"/blog/tags/js/"},{"name":"webpack","slug":"webpack","link":"/blog/tags/webpack/"},{"name":"docker","slug":"docker","link":"/blog/tags/docker/"},{"name":"vue","slug":"vue","link":"/blog/tags/vue/"},{"name":"nginx","slug":"nginx","link":"/blog/tags/nginx/"},{"name":"promise","slug":"promise","link":"/blog/tags/promise/"},{"name":"fanyi","slug":"fanyi","link":"/blog/tags/fanyi/"},{"name":"http","slug":"http","link":"/blog/tags/http/"},{"name":"cache","slug":"cache","link":"/blog/tags/cache/"}],"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","link":"/blog/categories/%E5%89%8D%E7%AB%AF/"},{"name":"å·¥å…·","slug":"å·¥å…·","link":"/blog/categories/%E5%B7%A5%E5%85%B7/"}]}